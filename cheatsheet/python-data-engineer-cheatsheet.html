<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Python Cheatsheet — Developer & Data Engineer</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=Newsreader:ital,wght@0,400;0,600;1,400&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--bg:#111214;--bg2:#18191d;--surface:#1e2025;--surface2:#252830;--border:#2e3039;--border2:#3a3d48;--text:#b8bcc8;--text-dim:#6c7086;--heading:#e8eaf0;--white:#f4f5f7;--amber:#f5a623;--amber-dim:rgba(245,166,35,0.12);--green:#50d890;--green-dim:rgba(80,216,144,0.10);--blue:#5b9cf5;--blue-dim:rgba(91,156,245,0.10);--pink:#e878a0;--pink-dim:rgba(232,120,160,0.10);--cyan:#56d4c8;--cyan-dim:rgba(86,212,200,0.10);--red:#f06868;--red-dim:rgba(240,104,104,0.12);--purple:#a78bfa;--purple-dim:rgba(167,139,250,0.10);--code-bg:#14151a;--radius:10px;--radius-lg:14px}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
.header{padding:48px 32px 32px;text-align:center;position:relative;border-bottom:1px solid var(--border)}.header::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 50% 70% at 50% 0%,rgba(245,166,35,0.06),transparent),radial-gradient(ellipse 30% 50% at 75% 10%,rgba(80,216,144,0.04),transparent);pointer-events:none}.header h1{font-family:'Newsreader',serif;font-size:clamp(2.2rem,4.5vw,3.6rem);color:var(--heading);letter-spacing:-0.03em;position:relative}.header h1 em{font-style:italic;color:var(--amber);font-weight:400}.header p{font-size:0.95rem;color:var(--text-dim);margin-top:6px;position:relative}.header .jupyter-badge{display:inline-block;background:var(--green-dim);color:var(--green);font-size:0.75rem;font-weight:700;padding:4px 12px;border-radius:999px;margin-top:10px;letter-spacing:0.05em}
.search-wrap{max-width:480px;margin:20px auto 0;position:relative}.search-wrap input{width:100%;padding:10px 16px 10px 40px;background:var(--surface);border:1px solid var(--border);border-radius:999px;color:var(--heading);font-family:'Outfit',sans-serif;font-size:0.88rem;outline:none;transition:border-color .2s}.search-wrap input:focus{border-color:var(--amber)}.search-wrap input::placeholder{color:var(--text-dim)}.search-wrap svg{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:var(--text-dim);width:16px;height:16px}
.nav{display:flex;justify-content:center;flex-wrap:wrap;gap:6px;padding:16px 24px;position:sticky;top:0;z-index:100;background:rgba(17,18,20,0.88);backdrop-filter:blur(14px);border-bottom:1px solid var(--border)}.nav a{font-size:0.72rem;font-weight:600;text-transform:uppercase;letter-spacing:0.07em;padding:5px 12px;border-radius:999px;text-decoration:none;color:var(--text-dim);border:1px solid transparent;transition:all .2s;white-space:nowrap}.nav a:hover,.nav a.active{color:var(--amber);border-color:rgba(245,166,35,0.3);background:var(--amber-dim)}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(420px,1fr));gap:18px;padding:28px 24px 80px;max-width:1520px;margin:0 auto}
.section-divider{grid-column:1/-1;display:flex;align-items:center;gap:14px;padding:24px 0 4px}.section-divider h2{font-family:'Newsreader',serif;font-size:1.6rem;color:var(--heading);white-space:nowrap;font-weight:600;letter-spacing:-0.02em}.section-divider .line{flex:1;height:1px;background:linear-gradient(90deg,var(--border),transparent)}.section-divider .badge{font-size:0.62rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;padding:3px 10px;border-radius:6px;white-space:nowrap}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;transition:border-color .25s,transform .2s,box-shadow .25s;animation:cardIn .45s ease both}.card:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,0.25)}@keyframes cardIn{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}.card.wide{grid-column:span 2}
.card-head{display:flex;align-items:center;gap:10px;padding:16px 18px 10px}.card-icon{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-family:'IBM Plex Mono',monospace;font-size:0.7rem;font-weight:600;flex-shrink:0}.card-head h3{font-family:'Outfit',sans-serif;font-size:0.9rem;font-weight:700;color:var(--heading);letter-spacing:-0.01em}.card-tag{margin-left:auto;font-size:0.6rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;padding:3px 8px;border-radius:5px;background:var(--green-dim);color:var(--green)}.card-body{padding:0 18px 18px}
.card-text{font-size:0.82rem;color:var(--text-dim);margin:4px 0;line-height:1.5}
.card-text strong{color:var(--heading)}
.card-text code.inline{background:var(--code-bg);padding:1px 5px;border-radius:4px;font-family:'IBM Plex Mono',monospace;font-size:0.78rem;color:var(--pink);border:1px solid var(--border)}
pre{background:var(--code-bg);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px;overflow-x:auto;margin:6px 0;font-size:0.76rem;line-height:1.75}code{font-family:'IBM Plex Mono',monospace;font-size:inherit}pre code{color:var(--text)}
.kw{color:var(--purple)}.fn{color:var(--green)}.st{color:var(--amber)}.cm{color:var(--text-dim);font-style:italic}.nb{color:var(--cyan)}.op{color:var(--pink)}.num{color:var(--blue)}.dc{color:var(--pink)}
table{width:100%;border-collapse:collapse;margin:8px 0;font-size:0.78rem}th{background:var(--surface2);color:var(--heading);padding:8px 10px;text-align:left;border:1px solid var(--border);font-weight:600}td{padding:6px 10px;border:1px solid var(--border)}tbody tr:nth-child(even){background:var(--bg2)}tbody tr:hover{background:var(--surface2)}
@media(max-width:880px){.grid{grid-template-columns:1fr;padding:18px 12px 60px}.card.wide{grid-column:span 1}.header{padding:32px 16px 24px}.nav{gap:4px;padding:12px 10px}}
.card.hidden{display:none}.section-divider.hidden{display:none}
@media print{body{background:#fff;color:#222}pre{background:#f5f5f5;border-color:#ddd;color:#222}.header::before{display:none}.nav,.search-wrap{display:none}.card{break-inside:avoid;border-color:#ddd}.section-divider h2{color:#111}th{background:#eee;color:#111}.kw,.fn,.st,.cm,.nb,.op,.num,.dc{color:#333}}
</style>
</head>
<body>
<div class="header">
  <h1>Python <em>Cheatsheet</em></h1>
  <p>Essential reference for Python developers & data engineers</p>
  <div class="jupyter-badge">JUPYTER-READY — Every cell runs standalone</div>
  <div class="search-wrap">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
    <input type="text" id="search" placeholder="Search topics..." autocomplete="off">
  </div>
</div>
<nav class="nav" id="nav">
<a href="#core-python">Core Python</a>
<a href="#strings">Strings</a>
<a href="#data-structures">Data Structures</a>
<a href="#functions">Functions</a>
<a href="#comprehensions">Comprehensions</a>
<a href="#object-oriented-programming">Object-Oriented Programming</a>
<a href="#file-io-serialization">File I/O & Serialization</a>
<a href="#error-handling-logging">Error Handling & Logging</a>
<a href="#sql-databases">SQL & Databases</a>
<a href="#pandas-for-data-engineering">Pandas for Data Engineering</a>
<a href="#etl-patterns">ETL Patterns</a>
<a href="#cloud-object-storage-simulated">Cloud & Object Storage (Simulated)</a>
<a href="#api-interaction-simulated">API Interaction (Simulated)</a>
<a href="#concurrency-parallelism">Concurrency & Parallelism</a>
<a href="#data-validation-quality">Data Validation & Quality</a>
<a href="#environment-configuration">Environment & Configuration</a>
<a href="#pro-tips-patterns">Pro Tips & Patterns</a>
<a href="#dunder-magic-methods">Dunder (Magic) Methods</a>
<a href="#common-python-interview-questions-data-engineering">Common Python Interview Questions (Data Engineering)</a>
<a href="#quick-reference-table">Quick Reference Table</a>
</nav>
<div class="grid" id="grid">
<div class="section-divider" id="core-python" data-section="core-python">
  <h2>Core Python</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Fundamentals</span>
</div>

<div class="card" data-tags="variables &amp; data types">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Va</div>
    <h3>Variables &amp; Data Types</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># Dynamic typing</span>
x <span class="op">=</span> <span class="num">10</span>              <span class="cm"># int</span>
pi <span class="op">=</span> <span class="num">3.14</span>           <span class="cm"># float</span>
name <span class="op">=</span> <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>      <span class="cm"># str</span>
active <span class="op">=</span> <span class="kw">True</span>       <span class="cm"># bool</span>
nothing <span class="op">=</span> <span class="kw">None</span>      <span class="cm"># NoneType</span>
raw <span class="op">=</span> <span class="st">b</span><span class="st">&quot;</span><span class="st">bytes</span><span class="st">&quot;</span>      <span class="cm"># bytes</span>

<span class="cm"># Type checking &amp; conversion</span>
<span class="nb">print</span>(<span class="nb">type</span>(x))              <span class="cm"># &lt;class &#x27;int&#x27;&gt;</span>
<span class="nb">print</span>(<span class="nb">isinstance</span>(x, <span class="nb">int</span>))   <span class="cm"># True</span>
<span class="nb">print</span>(<span class="nb">int</span>(<span class="st">&quot;</span><span class="st">42</span><span class="st">&quot;</span>))             <span class="cm"># 42</span>
<span class="nb">print</span>(<span class="nb">str</span>(<span class="num">3.14</span>))             <span class="cm"># &quot;3.14&quot;</span>
<span class="nb">print</span>(<span class="nb">float</span>(<span class="st">&quot;</span><span class="st">2.7</span><span class="st">&quot;</span>))          <span class="cm"># 2.7</span>

<span class="cm"># Multiple assignment &amp; swap</span>
a, b, c <span class="op">=</span> <span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>
a, b <span class="op">=</span> b, a
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">a=</span><span class="st">{</span>a<span class="st">}</span><span class="st">, b=</span><span class="st">{</span>b<span class="st">}</span><span class="st">, c=</span><span class="st">{</span>c<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="card wide" data-tags="control flow">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Co</div>
    <h3>Control Flow</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code>x <span class="op">=</span> <span class="num">10</span>
d <span class="op">=</span> {<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>: <span class="num">30</span>, <span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>}

<span class="cm"># Conditionals</span>
<span class="kw">if</span> x <span class="op">&gt;</span> <span class="num">0</span>:
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">positive</span><span class="st">&quot;</span>)
<span class="kw">elif</span> x <span class="op">==</span> <span class="num">0</span>:
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">zero</span><span class="st">&quot;</span>)
<span class="kw">else</span>:
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">negative</span><span class="st">&quot;</span>)

<span class="cm"># Ternary</span>
label <span class="op">=</span> <span class="st">&quot;</span><span class="st">even</span><span class="st">&quot;</span> <span class="kw">if</span> x <span class="op">%</span> <span class="num">2</span> <span class="op">==</span> <span class="num">0</span> <span class="kw">else</span> <span class="st">&quot;</span><span class="st">odd</span><span class="st">&quot;</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">x=</span><span class="st">{</span>x<span class="st">}</span><span class="st"> is </span><span class="st">{</span>label<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Loops</span>
<span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(<span class="num">5</span>):
    <span class="nb">print</span>(i, end<span class="op">=</span><span class="st">&quot;</span><span class="st"> </span><span class="st">&quot;</span>)
<span class="nb">print</span>()

<span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(<span class="num">2</span>, <span class="num">10</span>, <span class="num">2</span>):
    <span class="nb">print</span>(i, end<span class="op">=</span><span class="st">&quot;</span><span class="st"> </span><span class="st">&quot;</span>)
<span class="nb">print</span>()

<span class="kw">for</span> k, v <span class="kw">in</span> d<span class="op">.</span>items():
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>k<span class="st">}</span><span class="st">: </span><span class="st">{</span>v<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Match statement (3.10+)</span>
status_code <span class="op">=</span> <span class="num">200</span>
<span class="kw">match</span> status_code:
    <span class="kw">case</span> <span class="num">200</span>:
        <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">OK</span><span class="st">&quot;</span>)
    <span class="kw">case</span> <span class="num">404</span>:
        <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">Not Found</span><span class="st">&quot;</span>)
    <span class="kw">case</span> <span class="kw">_</span>:
        <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">Other</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="strings" data-section="strings">
  <h2>Strings</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--green-dim);color:var(--green)">Text Processing</span>
</div>

<div class="card" data-tags="strings">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">St</div>
    <h3>Strings</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code>s <span class="op">=</span> <span class="st">&quot;</span><span class="st">Hello, World!</span><span class="st">&quot;</span>

<span class="cm"># Slicing</span>
<span class="nb">print</span>(s[<span class="num">0</span>:<span class="num">5</span>])         <span class="cm"># &quot;Hello&quot;</span>
<span class="nb">print</span>(s[::<span class="op">-</span><span class="num">1</span>])        <span class="cm"># reversed</span>

<span class="cm"># Key methods</span>
<span class="nb">print</span>(s<span class="op">.</span>lower())
<span class="nb">print</span>(s<span class="op">.</span>upper())
<span class="nb">print</span>(s<span class="op">.</span>strip())
<span class="nb">print</span>(s<span class="op">.</span>split(<span class="st">&quot;</span><span class="st">,</span><span class="st">&quot;</span>))           <span class="cm"># [&quot;Hello&quot;, &quot; World!&quot;]</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">-</span><span class="st">&quot;</span><span class="op">.</span>join([<span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>]))    <span class="cm"># &quot;a-b&quot;</span>
<span class="nb">print</span>(s<span class="op">.</span>replace(<span class="st">&quot;</span><span class="st">World</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Python</span><span class="st">&quot;</span>))
<span class="nb">print</span>(s<span class="op">.</span>startswith(<span class="st">&quot;</span><span class="st">He</span><span class="st">&quot;</span>))     <span class="cm"># True</span>
<span class="nb">print</span>(s<span class="op">.</span>find(<span class="st">&quot;</span><span class="st">World</span><span class="st">&quot;</span>))        <span class="cm"># 7</span>
<span class="nb">print</span>(s<span class="op">.</span>count(<span class="st">&quot;</span><span class="st">l</span><span class="st">&quot;</span>))           <span class="cm"># 3</span>
<span class="nb">print</span>(s<span class="op">.</span>encode(<span class="st">&quot;</span><span class="st">utf-8</span><span class="st">&quot;</span>))      <span class="cm"># bytes — important for pipelines</span>

<span class="cm"># f-strings (3.6+)</span>
name, age <span class="op">=</span> <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="num">30</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>name<span class="st">}</span><span class="st"> is </span><span class="st">{</span>age<span class="st">}</span><span class="st"> years old</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span><span class="num">3.14159</span><span class="st">:</span><span class="st">.2f</span><span class="st">}</span><span class="st">&quot;</span>)       <span class="cm"># &quot;3.14&quot;</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span><span class="num">1000000</span><span class="st">:</span><span class="st">,</span><span class="st">}</span><span class="st">&quot;</span>)         <span class="cm"># &quot;1,000,000&quot;</span>
x <span class="op">=</span> <span class="num">42</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>x <span class="st">= }</span><span class="st">&quot;</span>)              <span class="cm"># &quot;x = 42&quot; (3.8+)</span>

<span class="cm"># Raw strings (regex &amp; Windows paths)</span>
path <span class="op">=</span> <span class="st">r</span><span class="st">&quot;</span><span class="st">C:</span><span class="st">\</span><span class="st">data</span><span class="st">\</span><span class="st">files</span><span class="st">\</span><span class="st">output</span><span class="st">&quot;</span>
pattern <span class="op">=</span> <span class="st">r</span><span class="st">&quot;</span><span class="st">\</span><span class="st">d</span><span class="st">{4}</span><span class="st">-</span><span class="st">\</span><span class="st">d</span><span class="st">{2}</span><span class="st">-</span><span class="st">\</span><span class="st">d</span><span class="st">{2}</span><span class="st">&quot;</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">path: </span><span class="st">{</span>path<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">pattern: </span><span class="st">{</span>pattern<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="data-structures" data-section="data-structures">
  <h2>Data Structures</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--blue-dim);color:var(--blue)">Collections</span>
</div>

<div class="card" data-tags="lists">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Li</div>
    <h3>Lists</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code>lst <span class="op">=</span> [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>]

<span class="cm"># CRUD</span>
lst<span class="op">.</span>append(<span class="num">6</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">append:</span><span class="st">&quot;</span>, lst)
lst<span class="op">.</span>insert(<span class="num">0</span>, <span class="num">0</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">insert:</span><span class="st">&quot;</span>, lst)
lst<span class="op">.</span>extend([<span class="num">7</span>, <span class="num">8</span>])
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">extend:</span><span class="st">&quot;</span>, lst)

popped <span class="op">=</span> lst<span class="op">.</span>pop()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">pop: </span><span class="st">{</span>popped<span class="st">}</span><span class="st">, list: </span><span class="st">{</span>lst<span class="st">}</span><span class="st">&quot;</span>)
lst<span class="op">.</span>remove(<span class="num">3</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">remove 3:</span><span class="st">&quot;</span>, lst)

<span class="cm"># Searching &amp; Sorting</span>
<span class="nb">print</span>(<span class="num">4</span> <span class="kw">in</span> lst)
lst<span class="op">.</span>sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="op">-</span>x)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">desc sorted:</span><span class="st">&quot;</span>, lst)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">sorted copy:</span><span class="st">&quot;</span>, <span class="nb">sorted</span>(lst))

<span class="cm"># Slicing</span>
lst <span class="op">=</span> [<span class="num">10</span>, <span class="num">20</span>, <span class="num">30</span>, <span class="num">40</span>, <span class="num">50</span>]
<span class="nb">print</span>(lst[<span class="num">1</span>:<span class="num">4</span>])     <span class="cm"># [20,30,40]</span>
<span class="nb">print</span>(lst[::<span class="num">2</span>])     <span class="cm"># every 2nd</span>
<span class="nb">print</span>(lst[::<span class="op">-</span><span class="num">1</span>])    <span class="cm"># reversed</span>

<span class="cm"># Unpacking</span>
first, <span class="op">*</span>rest <span class="op">=</span> lst
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">first=</span><span class="st">{</span>first<span class="st">}</span><span class="st">, rest=</span><span class="st">{</span>rest<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="card" data-tags="dictionaries, sets &amp; tuples">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Di</div>
    <h3>Dictionaries, Sets &amp; Tuples</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># Dictionary</span>
d <span class="op">=</span> {<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>: <span class="num">30</span>}
<span class="nb">print</span>(d[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>])
<span class="nb">print</span>(d<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">email</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">N/A</span><span class="st">&quot;</span>))   <span class="cm"># safe access</span>

d[<span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>
d<span class="op">.</span>update({<span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>: <span class="num">31</span>})
merged <span class="op">=</span> d <span class="op">|</span> {<span class="st">&quot;</span><span class="st">x</span><span class="st">&quot;</span>: <span class="num">1</span>}          <span class="cm"># merge (3.9+)</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">merged:</span><span class="st">&quot;</span>, merged)

d<span class="op">.</span>setdefault(<span class="st">&quot;</span><span class="st">tags</span><span class="st">&quot;</span>, [])
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">setdefault:</span><span class="st">&quot;</span>, d)

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">keys:</span><span class="st">&quot;</span>, <span class="nb">list</span>(d<span class="op">.</span>keys()))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">values:</span><span class="st">&quot;</span>, <span class="nb">list</span>(d<span class="op">.</span>values()))

<span class="cm"># defaultdict — no KeyError</span>
<span class="kw">from</span> collections <span class="kw">import</span> defaultdict, OrderedDict
dd <span class="op">=</span> defaultdict(<span class="nb">list</span>)
dd[<span class="st">&quot;</span><span class="st">fruits</span><span class="st">&quot;</span>]<span class="op">.</span>append(<span class="st">&quot;</span><span class="st">apple</span><span class="st">&quot;</span>)
dd[<span class="st">&quot;</span><span class="st">fruits</span><span class="st">&quot;</span>]<span class="op">.</span>append(<span class="st">&quot;</span><span class="st">banana</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">defaultdict:</span><span class="st">&quot;</span>, <span class="nb">dict</span>(dd))

<span class="cm"># Sets — deduplication &amp; lookups</span>
s1 <span class="op">=</span> {<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>}
s2 <span class="op">=</span> {<span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>, <span class="num">6</span>}
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">intersection:</span><span class="st">&quot;</span>, s1 <span class="op">&amp;</span> s2)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">union:</span><span class="st">&quot;</span>, s1 <span class="op">|</span> s2)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">difference:</span><span class="st">&quot;</span>, s1 <span class="op">-</span> s2)

<span class="cm"># Tuples &amp; Named tuples</span>
t <span class="op">=</span> (<span class="num">1</span>, <span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>, <span class="num">3.14</span>)
x, y, z <span class="op">=</span> t
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">unpacked: x=</span><span class="st">{</span>x<span class="st">}</span><span class="st">, y=</span><span class="st">{</span>y<span class="st">}</span><span class="st">, z=</span><span class="st">{</span>z<span class="st">}</span><span class="st">&quot;</span>)

<span class="kw">from</span> collections <span class="kw">import</span> namedtuple
Record <span class="op">=</span> namedtuple(<span class="st">&quot;</span><span class="st">Record</span><span class="st">&quot;</span>, [<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>])
r <span class="op">=</span> Record(<span class="num">1</span>, <span class="st">&quot;</span><span class="st">sensor_a</span><span class="st">&quot;</span>, <span class="num">42.5</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">namedtuple: </span><span class="st">{</span>r<span class="op">.</span>name<span class="st">}</span><span class="st"> = </span><span class="st">{</span>r<span class="op">.</span>value<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="card" data-tags="tuples — immutable sequences">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Tu</div>
    <h3>Tuples — Immutable Sequences</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># Creating tuples</span>
t <span class="op">=</span> (<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>)
single <span class="op">=</span> (<span class="num">42</span>,)            <span class="cm"># trailing comma required for single-element tuple</span>
empty <span class="op">=</span> ()
from_list <span class="op">=</span> <span class="nb">tuple</span>([<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>])

<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">tuple: </span><span class="st">{</span>t<span class="st">}</span><span class="st">, single: </span><span class="st">{</span>single<span class="st">}</span><span class="st">, empty: </span><span class="st">{</span>empty<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Indexing &amp; slicing (same as lists)</span>
<span class="nb">print</span>(t[<span class="num">0</span>])       <span class="cm"># 1</span>
<span class="nb">print</span>(t[<span class="op">-</span><span class="num">1</span>])      <span class="cm"># 5</span>
<span class="nb">print</span>(t[<span class="num">1</span>:<span class="num">4</span>])     <span class="cm"># (2, 3, 4)</span>
<span class="nb">print</span>(t[::<span class="op">-</span><span class="num">1</span>])    <span class="cm"># (5, 4, 3, 2, 1)</span>

<span class="cm"># Unpacking</span>
a, b, <span class="op">*</span>rest <span class="op">=</span> t
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">a=</span><span class="st">{</span>a<span class="st">}</span><span class="st">, b=</span><span class="st">{</span>b<span class="st">}</span><span class="st">, rest=</span><span class="st">{</span>rest<span class="st">}</span><span class="st">&quot;</span>)  <span class="cm"># a=1, b=2, rest=[3, 4, 5]</span>

<span class="cm"># Swap idiom uses tuples under the hood</span>
x, y <span class="op">=</span> <span class="num">10</span>, <span class="num">20</span>
x, y <span class="op">=</span> y, x
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">swapped: x=</span><span class="st">{</span>x<span class="st">}</span><span class="st">, y=</span><span class="st">{</span>y<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Tuple methods (only 2!)</span>
<span class="nb">print</span>(t<span class="op">.</span>count(<span class="num">3</span>))   <span class="cm"># 1</span>
<span class="nb">print</span>(t<span class="op">.</span>index(<span class="num">4</span>))   <span class="cm"># 3</span>

<span class="cm"># Tuples as dict keys (immutable = hashable)</span>
location_cache <span class="op">=</span> {(<span class="num">40.7</span>, <span class="op">-</span><span class="num">74.0</span>): <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, (<span class="num">34.1</span>, <span class="op">-</span><span class="num">118.2</span>): <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>}
<span class="nb">print</span>(location_cache[(<span class="num">40.7</span>, <span class="op">-</span><span class="num">74.0</span>)])  <span class="cm"># &quot;NYC&quot;</span>

<span class="cm"># Tuples as return values</span>
<span class="kw">def</span> <span class="fn">min_max</span>(data):
    <span class="kw">return</span> <span class="nb">min</span>(data), <span class="nb">max</span>(data)

lo, hi <span class="op">=</span> min_max([<span class="num">5</span>, <span class="num">2</span>, <span class="num">8</span>, <span class="num">1</span>, <span class="num">9</span>])
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">min=</span><span class="st">{</span>lo<span class="st">}</span><span class="st">, max=</span><span class="st">{</span>hi<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Tuple vs list: immutability</span>
<span class="kw">try</span>:
    t[<span class="num">0</span>] <span class="op">=</span> <span class="num">99</span>
<span class="kw">except</span> <span class="nb">TypeError</span> <span class="kw">as</span> e:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Can</span><span class="st">&#x27;</span><span class="st">t mutate tuple: </span><span class="st">{</span>e<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Nested tuples (inner mutables CAN change)</span>
nested <span class="op">=</span> ([<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>])
nested[<span class="num">0</span>]<span class="op">.</span>append(<span class="num">99</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">nested with mutated inner list: </span><span class="st">{</span>nested<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Named tuples — lightweight records</span>
<span class="kw">from</span> collections <span class="kw">import</span> namedtuple
Record <span class="op">=</span> namedtuple(<span class="st">&quot;</span><span class="st">Record</span><span class="st">&quot;</span>, [<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>])
r <span class="op">=</span> Record(<span class="num">1</span>, <span class="st">&quot;</span><span class="st">sensor_a</span><span class="st">&quot;</span>, <span class="num">42.5</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">namedtuple: </span><span class="st">{</span>r<span class="op">.</span>name<span class="st">}</span><span class="st"> = </span><span class="st">{</span>r<span class="op">.</span>value<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">as dict: </span><span class="st">{</span>r<span class="op">.</span>_asdict()<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">replace: </span><span class="st">{</span>r<span class="op">.</span>_replace(value<span class="op">=</span><span class="num">99.9</span>)<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># typing.NamedTuple (modern alternative)</span>
<span class="kw">from</span> typing <span class="kw">import</span> NamedTuple

<span class="kw">class</span> <span class="fn">PipelineResult</span>(NamedTuple):
    rows_processed: <span class="nb">int</span>
    errors: <span class="nb">int</span>
    duration_sec: <span class="nb">float</span>

result <span class="op">=</span> PipelineResult(<span class="num">1500</span>, <span class="num">3</span>, <span class="num">12.5</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">result: </span><span class="st">{</span>result<span class="st">}</span><span class="st">, rows=</span><span class="st">{</span>result<span class="op">.</span>rows_processed<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="functions" data-section="functions">
  <h2>Functions</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--pink-dim);color:var(--pink)">Functions</span>
</div>

<div class="card" data-tags="functions &amp; lambdas">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">Fn</div>
    <h3>Functions &amp; Lambdas</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># Standard function</span>
<span class="kw">def</span> <span class="fn">transform</span>(record, mapping<span class="op">=</span><span class="kw">None</span>):
    <span class="st">&quot;&quot;&quot;Transform a single record.&quot;&quot;&quot;</span>
    mapping <span class="op">=</span> mapping <span class="kw">or</span> {}
    <span class="kw">return</span> {mapping<span class="op">.</span>get(k, k): v <span class="kw">for</span> k, v <span class="kw">in</span> record<span class="op">.</span>items()}

raw <span class="op">=</span> {<span class="st">&quot;</span><span class="st">First Name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Last Name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Smith</span><span class="st">&quot;</span>}
mapping <span class="op">=</span> {<span class="st">&quot;</span><span class="st">First Name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">first_name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Last Name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">last_name</span><span class="st">&quot;</span>}
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">transformed:</span><span class="st">&quot;</span>, transform(raw, mapping))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">no mapping:</span><span class="st">&quot;</span>, transform(raw))

<span class="cm"># *args and **kwargs</span>
<span class="kw">def</span> <span class="fn">flexible</span>(<span class="op">*</span>args, <span class="op">*</span><span class="op">*</span>kwargs):
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">args:</span><span class="st">&quot;</span>, args)
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">kwargs:</span><span class="st">&quot;</span>, kwargs)

flexible(<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, x<span class="op">=</span><span class="num">10</span>, y<span class="op">=</span><span class="num">20</span>)

<span class="cm"># Lambda &amp; higher-order functions</span>
square <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">*</span><span class="op">*</span> <span class="num">2</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">square(5) = </span><span class="st">{</span>square(<span class="num">5</span>)<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">map:</span><span class="st">&quot;</span>, <span class="nb">list</span>(<span class="nb">map</span>(<span class="kw">lambda</span> x: x<span class="op">*</span><span class="num">2</span>, [<span class="num">1</span>,<span class="num">2</span>,<span class="num">3</span>])))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">filter:</span><span class="st">&quot;</span>, <span class="nb">list</span>(<span class="nb">filter</span>(<span class="kw">lambda</span> x: x<span class="op">&gt;</span><span class="num">2</span>, [<span class="num">1</span>,<span class="num">2</span>,<span class="num">3</span>,<span class="num">4</span>,<span class="num">5</span>])))

<span class="kw">from</span> functools <span class="kw">import</span> reduce
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">reduce:</span><span class="st">&quot;</span>, reduce(<span class="kw">lambda</span> a, b: a<span class="op">+</span>b, [<span class="num">1</span>,<span class="num">2</span>,<span class="num">3</span>,<span class="num">4</span>]))  <span class="cm"># 10</span>

<span class="cm"># Type hints</span>
<span class="kw">from</span> typing <span class="kw">import</span> Optional

<span class="kw">def</span> <span class="fn">process</span>(data: <span class="nb">list</span>[<span class="nb">dict</span>]) <span class="op">-</span><span class="op">&gt;</span> <span class="nb">list</span>[<span class="nb">dict</span>]:
    <span class="kw">return</span> [{<span class="st">&quot;</span><span class="st">key</span><span class="st">&quot;</span>: d<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">key</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">&quot;</span>)<span class="op">.</span>lower()} <span class="kw">for</span> d <span class="kw">in</span> data]

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">typed:</span><span class="st">&quot;</span>, process([{<span class="st">&quot;</span><span class="st">key</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">HELLO</span><span class="st">&quot;</span>}, {<span class="st">&quot;</span><span class="st">key</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">WORLD</span><span class="st">&quot;</span>}]))
</code></pre>
  </div>
</div>

<div class="card" data-tags="decorators &amp; generators">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">De</div>
    <h3>Decorators &amp; Generators</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> time
<span class="kw">from</span> functools <span class="kw">import</span> wraps

<span class="cm"># Retry decorator (common in pipelines)</span>
<span class="kw">def</span> <span class="fn">retry</span>(max_retries<span class="op">=</span><span class="num">3</span>, delay<span class="op">=</span><span class="num">0.01</span>):
    <span class="kw">def</span> <span class="fn">decorator</span>(func):
        <span class="dc">@wraps</span>(func)
        <span class="kw">def</span> <span class="fn">wrapper</span>(<span class="op">*</span>args, <span class="op">*</span><span class="op">*</span>kwargs):
            <span class="kw">for</span> attempt <span class="kw">in</span> <span class="nb">range</span>(max_retries):
                <span class="kw">try</span>:
                    <span class="kw">return</span> func(<span class="op">*</span>args, <span class="op">*</span><span class="op">*</span>kwargs)
                <span class="kw">except</span> <span class="nb">Exception</span> <span class="kw">as</span> e:
                    <span class="kw">if</span> attempt <span class="op">==</span> max_retries <span class="op">-</span> <span class="num">1</span>:
                        <span class="kw">raise</span>
                    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Retry </span><span class="st">{</span>attempt<span class="op">+</span><span class="num">1</span><span class="st">}</span><span class="st">/</span><span class="st">{</span>max_retries<span class="st">}</span><span class="st">: </span><span class="st">{</span>e<span class="st">}</span><span class="st">&quot;</span>)
                    time<span class="op">.</span>sleep(delay <span class="op">*</span> (<span class="num">2</span> <span class="op">*</span><span class="op">*</span> attempt))
        <span class="kw">return</span> wrapper
    <span class="kw">return</span> decorator

call_count <span class="op">=</span> <span class="num">0</span>

<span class="dc">@retry</span>(max_retries<span class="op">=</span><span class="num">3</span>, delay<span class="op">=</span><span class="num">0.01</span>)
<span class="kw">def</span> <span class="fn">flaky_function</span>():
    <span class="kw">global</span> call_count
    call_count <span class="op">+</span><span class="op">=</span> <span class="num">1</span>
    <span class="kw">if</span> call_count <span class="op">&lt;</span> <span class="num">3</span>:
        <span class="kw">raise</span> <span class="nb">ConnectionError</span>(<span class="st">&quot;</span><span class="st">Simulated failure</span><span class="st">&quot;</span>)
    <span class="kw">return</span> <span class="st">&quot;</span><span class="st">Success!</span><span class="st">&quot;</span>

call_count <span class="op">=</span> <span class="num">0</span>
<span class="nb">print</span>(flaky_function())

<span class="cm"># Generator — memory-efficient streaming</span>
<span class="kw">def</span> <span class="fn">read_in_chunks</span>(data, chunk_size<span class="op">=</span><span class="num">3</span>):
    <span class="st">&quot;&quot;&quot;Simulate reading data in chunks.&quot;&quot;&quot;</span>
    <span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(<span class="num">0</span>, <span class="nb">len</span>(data), chunk_size):
        <span class="kw">yield</span> data[i:i<span class="op">+</span>chunk_size]

big_data <span class="op">=</span> <span class="nb">list</span>(<span class="nb">range</span>(<span class="num">10</span>))
<span class="kw">for</span> chunk <span class="kw">in</span> read_in_chunks(big_data, chunk_size<span class="op">=</span><span class="num">3</span>):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Processing chunk: </span><span class="st">{</span>chunk<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Generator pipeline (lazy, composable)</span>
raw_lines <span class="op">=</span> [<span class="st">&quot;</span><span class="st">  Alice,30,NYC  </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">  Bob,25,LA  </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">  ,invalid,  </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">  Charlie,35,SF  </span><span class="st">&quot;</span>]
lines   <span class="op">=</span> (line<span class="op">.</span>strip() <span class="kw">for</span> line <span class="kw">in</span> raw_lines)
rows    <span class="op">=</span> (line<span class="op">.</span>split(<span class="st">&quot;</span><span class="st">,</span><span class="st">&quot;</span>) <span class="kw">for</span> line <span class="kw">in</span> lines)
cleaned <span class="op">=</span> [row <span class="kw">for</span> row <span class="kw">in</span> rows <span class="kw">if</span> <span class="nb">len</span>(row) <span class="op">==</span> <span class="num">3</span> <span class="kw">and</span> row[<span class="num">0</span>]]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">cleaned rows:</span><span class="st">&quot;</span>, cleaned)
</code></pre>
  </div>
</div>

<div class="section-divider" id="comprehensions" data-section="comprehensions">
  <h2>Comprehensions</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--cyan-dim);color:var(--cyan)">Pythonic</span>
</div>

<div class="card" data-tags="comprehensions">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">Cm</div>
    <h3>Comprehensions</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># List comprehension</span>
squares <span class="op">=</span> [x<span class="op">*</span><span class="op">*</span><span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="nb">range</span>(<span class="num">10</span>)]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">squares:</span><span class="st">&quot;</span>, squares)

evens <span class="op">=</span> [x <span class="kw">for</span> x <span class="kw">in</span> <span class="nb">range</span>(<span class="num">20</span>) <span class="kw">if</span> x <span class="op">%</span> <span class="num">2</span> <span class="op">==</span> <span class="num">0</span>]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">evens:</span><span class="st">&quot;</span>, evens)

<span class="cm"># Nested — flatten</span>
matrix <span class="op">=</span> [[<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>], [<span class="num">4</span>, <span class="num">5</span>, <span class="num">6</span>], [<span class="num">7</span>, <span class="num">8</span>, <span class="num">9</span>]]
flat <span class="op">=</span> [x <span class="kw">for</span> row <span class="kw">in</span> matrix <span class="kw">for</span> x <span class="kw">in</span> row]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">flat:</span><span class="st">&quot;</span>, flat)

<span class="cm"># Dict comprehension — column renaming</span>
raw_columns <span class="op">=</span> [<span class="st">&quot;</span><span class="st">First Name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Last Name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Phone Number</span><span class="st">&quot;</span>]
column_map <span class="op">=</span> {col: col<span class="op">.</span>lower()<span class="op">.</span>replace(<span class="st">&quot;</span><span class="st"> </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">_</span><span class="st">&quot;</span>) <span class="kw">for</span> col <span class="kw">in</span> raw_columns}
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">column_map:</span><span class="st">&quot;</span>, column_map)

<span class="cm"># Set comprehension</span>
data <span class="op">=</span> {<span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">hello</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">c</span><span class="st">&quot;</span>: <span class="num">3.14</span>, <span class="st">&quot;</span><span class="st">d</span><span class="st">&quot;</span>: <span class="kw">True</span>, <span class="st">&quot;</span><span class="st">e</span><span class="st">&quot;</span>: [<span class="num">1</span>,<span class="num">2</span>]}
unique_types <span class="op">=</span> {<span class="nb">type</span>(v)<span class="op">.</span>__name__ <span class="kw">for</span> v <span class="kw">in</span> data<span class="op">.</span>values()}
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">unique_types:</span><span class="st">&quot;</span>, unique_types)

<span class="cm"># Conditional expression</span>
records <span class="op">=</span> [<span class="num">10</span>, <span class="op">-</span><span class="num">5</span>, <span class="num">20</span>, <span class="op">-</span><span class="num">3</span>, <span class="num">15</span>]
labels <span class="op">=</span> [<span class="st">&quot;</span><span class="st">valid</span><span class="st">&quot;</span> <span class="kw">if</span> x <span class="op">&gt;</span><span class="op">=</span> <span class="num">0</span> <span class="kw">else</span> <span class="st">&quot;</span><span class="st">invalid</span><span class="st">&quot;</span> <span class="kw">for</span> x <span class="kw">in</span> records]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">labels:</span><span class="st">&quot;</span>, labels)

<span class="cm"># Walrus operator (3.8+)</span>
data <span class="op">=</span> [<span class="num">1</span>, <span class="op">-</span><span class="num">2</span>, <span class="num">3</span>, <span class="op">-</span><span class="num">4</span>, <span class="num">5</span>, <span class="num">0</span>]
<span class="kw">def</span> <span class="fn">clean</span>(x):
    <span class="kw">return</span> x <span class="op">*</span> <span class="num">10</span> <span class="kw">if</span> x <span class="op">&gt;</span> <span class="num">0</span> <span class="kw">else</span> <span class="kw">None</span>

results <span class="op">=</span> [cleaned <span class="kw">for</span> x <span class="kw">in</span> data <span class="kw">if</span> (cleaned <span class="op">:=</span> clean(x)) <span class="kw">is</span> <span class="kw">not</span> <span class="kw">None</span>]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">walrus results:</span><span class="st">&quot;</span>, results)
</code></pre>
  </div>
</div>

<div class="section-divider" id="object-oriented-programming" data-section="object-oriented-programming">
  <h2>Object-Oriented Programming</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--purple-dim);color:var(--purple)">OOP</span>
</div>

<div class="card" data-tags="object-oriented programming">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">Ob</div>
    <h3>Object-Oriented Programming</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass, field, asdict
<span class="kw">from</span> datetime <span class="kw">import</span> datetime
<span class="kw">from</span> abc <span class="kw">import</span> ABC, abstractmethod

<span class="cm"># Dataclass (3.7+) — great for data models</span>
<span class="dc">@dataclass</span>
<span class="kw">class</span> <span class="fn">PipelineConfig</span>:
    source: <span class="nb">str</span>
    destination: <span class="nb">str</span>
    batch_size: <span class="nb">int</span> <span class="op">=</span> <span class="num">1000</span>
    created_at: datetime <span class="op">=</span> field(default_factory<span class="op">=</span>datetime<span class="op">.</span>now)
    tags: <span class="nb">list</span> <span class="op">=</span> field(default_factory<span class="op">=</span><span class="nb">list</span>)

config <span class="op">=</span> PipelineConfig(<span class="st">&quot;</span><span class="st">s3://input</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">postgres://db</span><span class="st">&quot;</span>, tags<span class="op">=</span>[<span class="st">&quot;</span><span class="st">etl</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">daily</span><span class="st">&quot;</span>])
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">config:</span><span class="st">&quot;</span>, config)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">as dict:</span><span class="st">&quot;</span>, asdict(config))

<span class="cm"># Abstract base class — enforce interface</span>
<span class="kw">class</span> <span class="fn">BaseExtractor</span>(ABC):
    <span class="dc">@abstractmethod</span>
    <span class="kw">def</span> <span class="fn">extract</span>(<span class="nb">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="nb">list</span>[<span class="nb">dict</span>]:
        <span class="kw">pass</span>

<span class="kw">class</span> <span class="fn">CSVExtractor</span>(BaseExtractor):
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="nb">self</span>, data):
        <span class="nb">self</span><span class="op">.</span>data <span class="op">=</span> data

    <span class="kw">def</span> <span class="fn">extract</span>(<span class="nb">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="nb">list</span>[<span class="nb">dict</span>]:
        <span class="kw">return</span> <span class="nb">self</span><span class="op">.</span>data

extractor <span class="op">=</span> CSVExtractor([{<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">val</span><span class="st">&quot;</span>: <span class="num">10</span>}, {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">2</span>, <span class="st">&quot;</span><span class="st">val</span><span class="st">&quot;</span>: <span class="num">20</span>}])
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">extracted:</span><span class="st">&quot;</span>, extractor<span class="op">.</span>extract())

<span class="cm"># Verify abstract enforcement</span>
<span class="kw">try</span>:
    bad <span class="op">=</span> BaseExtractor()
<span class="kw">except</span> <span class="nb">TypeError</span> <span class="kw">as</span> e:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Cannot instantiate ABC: </span><span class="st">{</span>e<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="file-io-serialization" data-section="file-io-serialization">
  <h2>File I/O &amp; Serialization</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--red-dim);color:var(--red)">I/O</span>
</div>

<div class="card" data-tags="file i/o &amp; serialization">
  <div class="card-head">
    <div class="card-icon" style="background:var(--red-dim);color:var(--red)">Fi</div>
    <h3>File I/O &amp; Serialization</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> json
<span class="kw">import</span> csv
<span class="kw">import</span> os
<span class="kw">from</span> pathlib <span class="kw">import</span> Path

<span class="cm"># Write &amp; Read text</span>
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.txt</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">w</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    f<span class="op">.</span>write(<span class="st">&quot;</span><span class="st">Line 1</span><span class="st">\n</span><span class="st">Line 2</span><span class="st">\n</span><span class="st">Line 3</span><span class="st">\n</span><span class="st">&quot;</span>)
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.txt</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    content <span class="op">=</span> f<span class="op">.</span>read()
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">text:</span><span class="st">&quot;</span>, <span class="nb">repr</span>(content))

<span class="cm"># Large file — line-by-line (memory safe)</span>
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.txt</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    <span class="kw">for</span> line <span class="kw">in</span> f:
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  line: </span><span class="st">{</span>line<span class="op">.</span>strip()<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># JSON</span>
data <span class="op">=</span> {<span class="st">&quot;</span><span class="st">pipeline</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">etl</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">records</span><span class="st">&quot;</span>: <span class="num">1500</span>, <span class="st">&quot;</span><span class="st">success</span><span class="st">&quot;</span>: <span class="kw">True</span>}
json_str <span class="op">=</span> json<span class="op">.</span>dumps(data, indent<span class="op">=</span><span class="num">2</span>, default<span class="op">=</span><span class="nb">str</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">JSON:</span><span class="st">&quot;</span>, json_str)
parsed <span class="op">=</span> json<span class="op">.</span>loads(json_str)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">parsed:</span><span class="st">&quot;</span>, parsed)

<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.json</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">w</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    json<span class="op">.</span>dump(data, f, indent<span class="op">=</span><span class="num">2</span>)
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.json</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    loaded <span class="op">=</span> json<span class="op">.</span>load(f)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">loaded:</span><span class="st">&quot;</span>, loaded)

<span class="cm"># CSV</span>
rows <span class="op">=</span> [{<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: <span class="num">95</span>},
        {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">2</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: <span class="num">87</span>}]
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.csv</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">w</span><span class="st">&quot;</span>, newline<span class="op">=</span><span class="st">&quot;</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    writer <span class="op">=</span> csv<span class="op">.</span>DictWriter(f, fieldnames<span class="op">=</span>[<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>])
    writer<span class="op">.</span>writeheader()
    writer<span class="op">.</span>writerows(rows)
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">demo.csv</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    <span class="kw">for</span> row <span class="kw">in</span> csv<span class="op">.</span>DictReader(f):
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  csv: </span><span class="st">{</span>row<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># pathlib — modern paths</span>
p <span class="op">=</span> Path(<span class="st">&quot;</span><span class="st">demo.csv</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">exists: </span><span class="st">{</span>p<span class="op">.</span>exists()<span class="st">}</span><span class="st">, stem: </span><span class="st">{</span>p<span class="op">.</span>stem<span class="st">}</span><span class="st">, suffix: </span><span class="st">{</span>p<span class="op">.</span>suffix<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">glob:</span><span class="st">&quot;</span>, <span class="nb">list</span>(Path(<span class="st">&quot;</span><span class="st">.</span><span class="st">&quot;</span>)<span class="op">.</span>glob(<span class="st">&quot;</span><span class="st">demo*</span><span class="st">&quot;</span>)))

<span class="cm"># Cleanup</span>
<span class="kw">for</span> f <span class="kw">in</span> [<span class="st">&quot;</span><span class="st">demo.txt</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">demo.json</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">demo.csv</span><span class="st">&quot;</span>]:
    Path(f)<span class="op">.</span>unlink(missing_ok<span class="op">=</span><span class="kw">True</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="error-handling-logging" data-section="error-handling-logging">
  <h2>Error Handling &amp; Logging</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Error Handling</span>
</div>

<div class="card wide" data-tags="error handling &amp; logging">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Er</div>
    <h3>Error Handling &amp; Logging</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> json
<span class="kw">import</span> logging

<span class="cm"># === Exception Handling ===</span>
x <span class="op">=</span> <span class="num">2</span>
raw <span class="op">=</span> <span class="st">&#x27;</span><span class="st">{</span><span class="st">&quot;</span><span class="st">key</span><span class="st">&quot;</span><span class="st">: </span><span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span><span class="st">}</span><span class="st">&#x27;</span>

<span class="kw">try</span>:
    result <span class="op">=</span> <span class="num">10</span> <span class="op">/</span> x
    data <span class="op">=</span> json<span class="op">.</span>loads(raw)
<span class="kw">except</span> <span class="nb">ZeroDivisionError</span>:
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">Can</span><span class="st">&#x27;</span><span class="st">t divide by zero</span><span class="st">&quot;</span>)
<span class="kw">except</span> (<span class="nb">ValueError</span>, <span class="nb">KeyError</span>) <span class="kw">as</span> e:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Error: </span><span class="st">{</span>e<span class="st">}</span><span class="st">&quot;</span>)
<span class="kw">except</span> <span class="nb">Exception</span> <span class="kw">as</span> e:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Unexpected: </span><span class="st">{</span>e<span class="st">}</span><span class="st">&quot;</span>)
    <span class="kw">raise</span>
<span class="kw">else</span>:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Success! result=</span><span class="st">{</span>result<span class="st">}</span><span class="st">, data=</span><span class="st">{</span>data<span class="st">}</span><span class="st">&quot;</span>)
<span class="kw">finally</span>:
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">Finally always runs</span><span class="st">\n</span><span class="st">&quot;</span>)

<span class="cm"># Custom pipeline exceptions</span>
<span class="kw">class</span> <span class="fn">PipelineError</span>(<span class="nb">Exception</span>):
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="nb">self</span>, stage, message):
        <span class="nb">super</span>()<span class="op">.</span><span class="fn">__init__</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">[</span><span class="st">{</span>stage<span class="st">}</span><span class="st">] </span><span class="st">{</span>message<span class="st">}</span><span class="st">&quot;</span>)
        <span class="nb">self</span><span class="op">.</span>stage <span class="op">=</span> stage

<span class="kw">class</span> <span class="fn">ExtractionError</span>(PipelineError): <span class="kw">pass</span>
<span class="kw">class</span> <span class="fn">TransformError</span>(PipelineError): <span class="kw">pass</span>

<span class="kw">try</span>:
    <span class="kw">raise</span> ExtractionError(<span class="st">&quot;</span><span class="st">extract</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Connection refused</span><span class="st">&quot;</span>)
<span class="kw">except</span> PipelineError <span class="kw">as</span> e:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Caught: </span><span class="st">{</span>e<span class="st">}</span><span class="st">, stage=</span><span class="st">{</span>e<span class="op">.</span>stage<span class="st">}</span><span class="st">\n</span><span class="st">&quot;</span>)

<span class="cm"># Context manager</span>
<span class="kw">from</span> contextlib <span class="kw">import</span> contextmanager

<span class="dc">@contextmanager</span>
<span class="kw">def</span> <span class="fn">db_transaction</span>(name):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  BEGIN </span><span class="st">{</span>name<span class="st">}</span><span class="st">&quot;</span>)
    <span class="kw">try</span>:
        <span class="kw">yield</span> name
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  COMMIT </span><span class="st">{</span>name<span class="st">}</span><span class="st">&quot;</span>)
    <span class="kw">except</span> <span class="nb">Exception</span>:
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  ROLLBACK </span><span class="st">{</span>name<span class="st">}</span><span class="st">&quot;</span>)
        <span class="kw">raise</span>

<span class="kw">with</span> db_transaction(<span class="st">&quot;</span><span class="st">insert_users</span><span class="st">&quot;</span>) <span class="kw">as</span> tx:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Executing in </span><span class="st">{</span>tx<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># === Logging ===</span>
logging<span class="op">.</span>basicConfig(
    level<span class="op">=</span>logging<span class="op">.</span>INFO,
    <span class="nb">format</span><span class="op">=</span><span class="st">&quot;</span><span class="st">%(asctime)s</span><span class="st"> | </span><span class="st">%(levelname)-8s</span><span class="st"> | </span><span class="st">%(name)s</span><span class="st"> | </span><span class="st">%(message)s</span><span class="st">&quot;</span>,
    datefmt<span class="op">=</span><span class="st">&quot;</span><span class="st">%</span><span class="st">H:</span><span class="st">%</span><span class="st">M:</span><span class="st">%</span><span class="st">S</span><span class="st">&quot;</span>,
)
logger <span class="op">=</span> logging<span class="op">.</span>getLogger(<span class="st">&quot;</span><span class="st">etl.demo</span><span class="st">&quot;</span>)
logger<span class="op">.</span>info(<span class="st">&quot;</span><span class="st">Pipeline started, source=</span><span class="st">%s</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">s3://bucket</span><span class="st">&quot;</span>)
logger<span class="op">.</span>warning(<span class="st">&quot;</span><span class="st">Skipped </span><span class="st">%d</span><span class="st"> malformed records</span><span class="st">&quot;</span>, <span class="num">42</span>)
logger<span class="op">.</span>info(<span class="st">&quot;</span><span class="st">Pipeline complete</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="sql-databases" data-section="sql-databases">
  <h2>SQL &amp; Databases</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--green-dim);color:var(--green)">Database</span>
</div>

<div class="card" data-tags="sqlite (built-in)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Sq</div>
    <h3>SQLite (Built-in)</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> sqlite3

<span class="cm"># Create in-memory database</span>
conn <span class="op">=</span> sqlite3<span class="op">.</span>connect(<span class="st">&quot;</span><span class="st">:memory:</span><span class="st">&quot;</span>)
conn<span class="op">.</span>row_factory <span class="op">=</span> sqlite3<span class="op">.</span>Row
cur <span class="op">=</span> conn<span class="op">.</span>cursor()

<span class="cm"># Create table</span>
cur<span class="op">.</span>execute(<span class="st">&quot;&quot;&quot;</span><span class="st">
</span><span class="st">    CREATE TABLE events (</span><span class="st">
</span><span class="st">        id INTEGER PRIMARY KEY AUTOINCREMENT,</span><span class="st">
</span><span class="st">        name TEXT NOT NULL,</span><span class="st">
</span><span class="st">        value REAL,</span><span class="st">
</span><span class="st">        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP</span><span class="st">
</span><span class="st">    )</span><span class="st">
</span><span class="st">&quot;&quot;&quot;</span>)

<span class="cm"># Parameterized inserts (NEVER use f-strings for SQL!)</span>
cur<span class="op">.</span>execute(<span class="st">&quot;</span><span class="st">INSERT INTO events (name, value) VALUES (?, ?)</span><span class="st">&quot;</span>, (<span class="st">&quot;</span><span class="st">temperature</span><span class="st">&quot;</span>, <span class="num">23.5</span>))
cur<span class="op">.</span>execute(<span class="st">&quot;</span><span class="st">INSERT INTO events (name, value) VALUES (?, ?)</span><span class="st">&quot;</span>, (<span class="st">&quot;</span><span class="st">humidity</span><span class="st">&quot;</span>, <span class="num">65.2</span>))

<span class="cm"># Bulk insert</span>
batch <span class="op">=</span> [(<span class="st">&quot;</span><span class="st">pressure</span><span class="st">&quot;</span>, <span class="num">1013.25</span>), (<span class="st">&quot;</span><span class="st">wind_speed</span><span class="st">&quot;</span>, <span class="num">12.3</span>), (<span class="st">&quot;</span><span class="st">temperature</span><span class="st">&quot;</span>, <span class="num">24.1</span>)]
cur<span class="op">.</span>executemany(<span class="st">&quot;</span><span class="st">INSERT INTO events (name, value) VALUES (?, ?)</span><span class="st">&quot;</span>, batch)
conn<span class="op">.</span>commit()

<span class="cm"># Query</span>
rows <span class="op">=</span> cur<span class="op">.</span>execute(<span class="st">&quot;</span><span class="st">SELECT * FROM events WHERE value &gt; ?</span><span class="st">&quot;</span>, (<span class="num">20</span>,))<span class="op">.</span>fetchall()
<span class="kw">for</span> row <span class="kw">in</span> rows:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  id=</span><span class="st">{</span>row[<span class="st">&#x27;</span><span class="st">id</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">, name=</span><span class="st">{</span>row[<span class="st">&#x27;</span><span class="st">name</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">, value=</span><span class="st">{</span>row[<span class="st">&#x27;</span><span class="st">value</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">&quot;</span>)

<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Total rows: </span><span class="st">{</span>cur<span class="op">.</span>execute(<span class="st">&#x27;</span><span class="st">SELECT COUNT(*) FROM events</span><span class="st">&#x27;</span>)<span class="op">.</span>fetchone()[<span class="num">0</span>]<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Aggregation</span>
<span class="kw">for</span> row <span class="kw">in</span> cur<span class="op">.</span>execute(<span class="st">&quot;</span><span class="st">SELECT name, AVG(value) as avg_val FROM events GROUP BY name</span><span class="st">&quot;</span>):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  </span><span class="st">{</span>row[<span class="st">&#x27;</span><span class="st">name</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">: avg=</span><span class="st">{</span>row[<span class="st">&#x27;</span><span class="st">avg_val</span><span class="st">&#x27;</span>]<span class="st">:</span><span class="st">.2f</span><span class="st">}</span><span class="st">&quot;</span>)

conn<span class="op">.</span>close()
</code></pre>
  </div>
</div>

<div class="card" data-tags="sqlite + pandas">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Sq</div>
    <h3>SQLite + Pandas</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> sqlite3
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># Create demo database</span>
conn <span class="op">=</span> sqlite3<span class="op">.</span>connect(<span class="st">&quot;</span><span class="st">:memory:</span><span class="st">&quot;</span>)
np<span class="op">.</span>random<span class="op">.</span>seed(<span class="num">42</span>)

<span class="cm"># Create and populate tables</span>
df_users <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">user_id</span><span class="st">&quot;</span>: <span class="nb">range</span>(<span class="num">1</span>, <span class="num">6</span>),
    <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Diana</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eve</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Chicago</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>],
})
df_orders <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">order_id</span><span class="st">&quot;</span>: <span class="nb">range</span>(<span class="num">1</span>, <span class="num">11</span>),
    <span class="st">&quot;</span><span class="st">user_id</span><span class="st">&quot;</span>: np<span class="op">.</span>random<span class="op">.</span>choice(<span class="nb">range</span>(<span class="num">1</span>, <span class="num">6</span>), <span class="num">10</span>),
    <span class="st">&quot;</span><span class="st">amount</span><span class="st">&quot;</span>: np<span class="op">.</span>random<span class="op">.</span>uniform(<span class="num">10</span>, <span class="num">500</span>, <span class="num">10</span>)<span class="op">.</span>round(<span class="num">2</span>),
    <span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>: pd<span class="op">.</span>date_range(<span class="st">&quot;</span><span class="st">2024-01-01</span><span class="st">&quot;</span>, periods<span class="op">=</span><span class="num">10</span>)<span class="op">.</span>astype(<span class="nb">str</span>),
})

df_users<span class="op">.</span>to_sql(<span class="st">&quot;</span><span class="st">users</span><span class="st">&quot;</span>, conn, index<span class="op">=</span><span class="kw">False</span>)
df_orders<span class="op">.</span>to_sql(<span class="st">&quot;</span><span class="st">orders</span><span class="st">&quot;</span>, conn, index<span class="op">=</span><span class="kw">False</span>)

<span class="cm"># Read with Pandas</span>
result <span class="op">=</span> pd<span class="op">.</span>read_sql(<span class="st">&quot;&quot;&quot;</span><span class="st">
</span><span class="st">    SELECT u.name, u.city, COUNT(o.order_id) as order_count, SUM(o.amount) as total</span><span class="st">
</span><span class="st">    FROM users u</span><span class="st">
</span><span class="st">    LEFT JOIN orders o ON u.user_id = o.user_id</span><span class="st">
</span><span class="st">    GROUP BY u.name, u.city</span><span class="st">
</span><span class="st">    ORDER BY total DESC</span><span class="st">
</span><span class="st">&quot;&quot;&quot;</span>, conn)
<span class="nb">print</span>(result)

<span class="cm"># Write processed data back to SQL</span>
result<span class="op">.</span>to_sql(<span class="st">&quot;</span><span class="st">user_summary</span><span class="st">&quot;</span>, conn, index<span class="op">=</span><span class="kw">False</span>, if_exists<span class="op">=</span><span class="st">&quot;</span><span class="st">replace</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Saved summary back to DB:</span><span class="st">&quot;</span>)
<span class="nb">print</span>(pd<span class="op">.</span>read_sql(<span class="st">&quot;</span><span class="st">SELECT * FROM user_summary</span><span class="st">&quot;</span>, conn))

conn<span class="op">.</span>close()
</code></pre>
  </div>
</div>

<div class="section-divider" id="pandas-for-data-engineering" data-section="pandas-for-data-engineering">
  <h2>Pandas for Data Engineering</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--blue-dim);color:var(--blue)">Pandas</span>
</div>

<div class="card" data-tags="dataframes — create &amp; inspect">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Df</div>
    <h3>DataFrames — Create &amp; Inspect</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

np<span class="op">.</span>random<span class="op">.</span>seed(<span class="num">42</span>)
df <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="nb">range</span>(<span class="num">1</span>, <span class="num">8</span>),
    <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Diana</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eve</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Frank</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Grace</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>: [<span class="num">30</span>, <span class="num">25</span>, <span class="num">35</span>, <span class="num">28</span>, <span class="num">32</span>, <span class="num">22</span>, <span class="num">45</span>],
    <span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Chicago</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Chicago</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">revenue</span><span class="st">&quot;</span>: np<span class="op">.</span>random<span class="op">.</span>uniform(<span class="num">500</span>, <span class="num">3000</span>, <span class="num">7</span>)<span class="op">.</span>round(<span class="num">2</span>),
    <span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">active</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">active</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">inactive</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">active</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">pending</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">active</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">active</span><span class="st">&quot;</span>],
})

<span class="nb">print</span>(df)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Shape: </span><span class="st">{</span>df<span class="op">.</span>shape<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Dtypes:</span><span class="st">\n</span><span class="st">{</span>df<span class="op">.</span>dtypes<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Info:</span><span class="st">&quot;</span>)
df<span class="op">.</span>info()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Describe:</span><span class="st">\n</span><span class="st">{</span>df<span class="op">.</span>describe()<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Memory usage:</span><span class="st">\n</span><span class="st">{</span>df<span class="op">.</span>memory_usage(deep<span class="op">=</span><span class="kw">True</span>)<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Null counts:</span><span class="st">\n</span><span class="st">{</span>df<span class="op">.</span>isnull()<span class="op">.</span>sum()<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Unique counts:</span><span class="st">\n</span><span class="st">{</span>df<span class="op">.</span>nunique()<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="card wide" data-tags="select, filter &amp; transform">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Se</div>
    <h3>Select, Filter &amp; Transform</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

np<span class="op">.</span>random<span class="op">.</span>seed(<span class="num">42</span>)
df <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Diana</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eve</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Frank</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>: [<span class="num">30</span>, <span class="num">25</span>, <span class="num">35</span>, <span class="num">28</span>, <span class="num">32</span>, <span class="num">22</span>],
    <span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Chicago</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: [<span class="num">85.5</span>, <span class="num">92.3</span>, <span class="num">78.1</span>, <span class="num">95.0</span>, <span class="num">88.7</span>, <span class="num">70.2</span>],
    <span class="st">&quot;</span><span class="st">date_str</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">2024-01-15</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">2024-02-20</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">2024-03-10</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">2024-04-05</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">2024-05-12</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">2024-06-01</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">raw_cat</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">A</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">B</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">A</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">C</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">B</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">A</span><span class="st">&quot;</span>],
})

<span class="cm"># Selecting</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">Single column:</span><span class="st">\n</span><span class="st">&quot;</span>, df[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>]<span class="op">.</span>head(<span class="num">3</span>)<span class="op">.</span>to_list())
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">Multi column:</span><span class="st">\n</span><span class="st">&quot;</span>, df[[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>]]<span class="op">.</span>head(<span class="num">3</span>))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">loc:</span><span class="st">\n</span><span class="st">&quot;</span>, df<span class="op">.</span>loc[<span class="num">0</span>:<span class="num">2</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>])
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">iloc:</span><span class="st">\n</span><span class="st">&quot;</span>, df<span class="op">.</span>iloc[<span class="num">0</span>:<span class="num">3</span>, <span class="num">0</span>:<span class="num">2</span>])

<span class="cm"># Filtering</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">age &gt; 28:</span><span class="st">\n</span><span class="st">&quot;</span>, df[df[<span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>] <span class="op">&gt;</span> <span class="num">28</span>][<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>]<span class="op">.</span>to_list())
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">isin:</span><span class="st">\n</span><span class="st">&quot;</span>, df[df[<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span> <span class="kw">if</span> <span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span> <span class="kw">in</span> df<span class="op">.</span>columns <span class="kw">else</span> <span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>]<span class="op">.</span>isin([<span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>])][<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>]<span class="op">.</span>to_list())
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">query:</span><span class="st">\n</span><span class="st">&quot;</span>, df<span class="op">.</span>query(<span class="st">&quot;</span><span class="st">age &gt; 25 and city == </span><span class="st">&#x27;</span><span class="st">NYC</span><span class="st">&#x27;</span><span class="st">&quot;</span>)[[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>]])

<span class="cm"># Sorting</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">sorted by score desc:</span><span class="st">&quot;</span>)
<span class="nb">print</span>(df<span class="op">.</span>sort_values(<span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>, ascending<span class="op">=</span><span class="kw">False</span>)[[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>]])
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">top 3 scores:</span><span class="st">&quot;</span>)
<span class="nb">print</span>(df<span class="op">.</span>nlargest(<span class="num">3</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>)[[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>]])

<span class="cm"># New columns &amp; transforms</span>
df[<span class="st">&quot;</span><span class="st">name_lower</span><span class="st">&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>]<span class="op">.</span>str<span class="op">.</span>lower()<span class="op">.</span>str<span class="op">.</span>strip()
df[<span class="st">&quot;</span><span class="st">flag</span><span class="st">&quot;</span>] <span class="op">=</span> np<span class="op">.</span>where(df[<span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>] <span class="op">&gt;</span> <span class="num">85</span>, <span class="num">1</span>, <span class="num">0</span>)
df[<span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>] <span class="op">=</span> pd<span class="op">.</span>to_datetime(df[<span class="st">&quot;</span><span class="st">date_str</span><span class="st">&quot;</span>])
df[<span class="st">&quot;</span><span class="st">year</span><span class="st">&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>]<span class="op">.</span>dt<span class="op">.</span>year
df[<span class="st">&quot;</span><span class="st">month</span><span class="st">&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>]<span class="op">.</span>dt<span class="op">.</span>month
df[<span class="st">&quot;</span><span class="st">category</span><span class="st">&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;</span><span class="st">raw_cat</span><span class="st">&quot;</span>]<span class="op">.</span>map({<span class="st">&quot;</span><span class="st">A</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">alpha</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">B</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">beta</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">C</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">gamma</span><span class="st">&quot;</span>})

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Transformed:</span><span class="st">&quot;</span>)
<span class="nb">print</span>(df[[<span class="st">&quot;</span><span class="st">name_lower</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">flag</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">year</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">category</span><span class="st">&quot;</span>]])
</code></pre>
  </div>
</div>

<div class="card wide" data-tags="groupby, merge, clean &amp; export">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Gr</div>
    <h3>GroupBy, Merge, Clean &amp; Export</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

np<span class="op">.</span>random<span class="op">.</span>seed(<span class="num">42</span>)
df <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Diana</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eve</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Frank</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Chicago</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">LA</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">dept</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Eng</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Mkt</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eng</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Sales</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Mkt</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eng</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">revenue</span><span class="st">&quot;</span>: [<span class="num">1200</span>, <span class="num">1800</span>, <span class="num">950</span>, <span class="num">2100</span>, <span class="num">1600</span>, <span class="num">1100</span>],
    <span class="st">&quot;</span><span class="st">salary</span><span class="st">&quot;</span>: [<span class="num">90000</span>, <span class="num">75000</span>, <span class="num">95000</span>, <span class="num">80000</span>, <span class="num">72000</span>, <span class="num">88000</span>],
    <span class="st">&quot;</span><span class="st">region</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">East</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">West</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">East</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Central</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">West</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">East</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">quarter</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Q1</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Q1</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Q2</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Q2</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Q1</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Q2</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">sales</span><span class="st">&quot;</span>: [<span class="num">100</span>, <span class="num">150</span>, <span class="num">120</span>, <span class="num">200</span>, <span class="num">130</span>, <span class="num">110</span>],
})

<span class="cm"># GroupBy</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">=== GroupBy ===</span><span class="st">&quot;</span>)
<span class="nb">print</span>(df<span class="op">.</span>groupby(<span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>)[<span class="st">&quot;</span><span class="st">revenue</span><span class="st">&quot;</span>]<span class="op">.</span>agg([<span class="st">&quot;</span><span class="st">sum</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">mean</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">count</span><span class="st">&quot;</span>]))

<span class="cm"># Transform (broadcast back)</span>
df[<span class="st">&quot;</span><span class="st">dept_avg_salary</span><span class="st">&quot;</span>] <span class="op">=</span> df<span class="op">.</span>groupby(<span class="st">&quot;</span><span class="st">dept</span><span class="st">&quot;</span>)[<span class="st">&quot;</span><span class="st">salary</span><span class="st">&quot;</span>]<span class="op">.</span>transform(<span class="st">&quot;</span><span class="st">mean</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Transform:</span><span class="st">\n</span><span class="st">&quot;</span>, df[[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">dept</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">salary</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">dept_avg_salary</span><span class="st">&quot;</span>]])

<span class="cm"># Pivot table</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Pivot Table ===</span><span class="st">&quot;</span>)
<span class="nb">print</span>(pd<span class="op">.</span>pivot_table(df, values<span class="op">=</span><span class="st">&quot;</span><span class="st">sales</span><span class="st">&quot;</span>, index<span class="op">=</span><span class="st">&quot;</span><span class="st">region</span><span class="st">&quot;</span>, columns<span class="op">=</span><span class="st">&quot;</span><span class="st">quarter</span><span class="st">&quot;</span>, aggfunc<span class="op">=</span><span class="st">&quot;</span><span class="st">sum</span><span class="st">&quot;</span>))

<span class="cm"># Merge / Join</span>
df1 <span class="op">=</span> pd<span class="op">.</span>DataFrame({<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>], <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>]})
df2 <span class="op">=</span> pd<span class="op">.</span>DataFrame({<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: [<span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>], <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: [<span class="num">85</span>, <span class="num">92</span>, <span class="num">78</span>]})
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Merge (left) ===</span><span class="st">&quot;</span>)
<span class="nb">print</span>(pd<span class="op">.</span>merge(df1, df2, on<span class="op">=</span><span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>, how<span class="op">=</span><span class="st">&quot;</span><span class="st">left</span><span class="st">&quot;</span>))

<span class="cm"># Concat</span>
df_a <span class="op">=</span> pd<span class="op">.</span>DataFrame({<span class="st">&quot;</span><span class="st">x</span><span class="st">&quot;</span>: [<span class="num">1</span>, <span class="num">2</span>], <span class="st">&quot;</span><span class="st">y</span><span class="st">&quot;</span>: [<span class="num">3</span>, <span class="num">4</span>]})
df_b <span class="op">=</span> pd<span class="op">.</span>DataFrame({<span class="st">&quot;</span><span class="st">x</span><span class="st">&quot;</span>: [<span class="num">5</span>, <span class="num">6</span>], <span class="st">&quot;</span><span class="st">y</span><span class="st">&quot;</span>: [<span class="num">7</span>, <span class="num">8</span>]})
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Concat ===</span><span class="st">&quot;</span>)
<span class="nb">print</span>(pd<span class="op">.</span>concat([df_a, df_b], ignore_index<span class="op">=</span><span class="kw">True</span>))

<span class="cm"># Cleaning</span>
dirty <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">1</span>, <span class="num">4</span>],
    <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="kw">None</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Eve</span><span class="st">&quot;</span>],
    <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: [<span class="num">85</span>, <span class="num">92</span>, <span class="kw">None</span>, <span class="num">85</span>, <span class="num">78</span>],
})
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Cleaning ===</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">dropna:</span><span class="st">&quot;</span>, dirty<span class="op">.</span>dropna(subset<span class="op">=</span>[<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>])<span class="op">.</span>shape)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">fillna:</span><span class="st">\n</span><span class="st">&quot;</span>, dirty<span class="op">.</span>fillna({<span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: <span class="num">0</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">unknown</span><span class="st">&quot;</span>}))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">dedup:</span><span class="st">\n</span><span class="st">&quot;</span>, dirty<span class="op">.</span>drop_duplicates(subset<span class="op">=</span>[<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>], keep<span class="op">=</span><span class="st">&quot;</span><span class="st">last</span><span class="st">&quot;</span>))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">rename:</span><span class="st">\n</span><span class="st">&quot;</span>, dirty<span class="op">.</span>rename(columns<span class="op">=</span>{<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">user_id</span><span class="st">&quot;</span>})<span class="op">.</span>columns<span class="op">.</span>tolist())

<span class="cm"># Chunked reading demo</span>
df<span class="op">.</span>to_csv(<span class="st">&quot;</span><span class="st">demo_big.csv</span><span class="st">&quot;</span>, index<span class="op">=</span><span class="kw">False</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Chunked Reading ===</span><span class="st">&quot;</span>)
<span class="kw">for</span> i, chunk <span class="kw">in</span> <span class="nb">enumerate</span>(pd<span class="op">.</span>read_csv(<span class="st">&quot;</span><span class="st">demo_big.csv</span><span class="st">&quot;</span>, chunksize<span class="op">=</span><span class="num">3</span>)):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Chunk </span><span class="st">{</span>i<span class="st">}</span><span class="st">: </span><span class="st">{</span><span class="nb">len</span>(chunk)<span class="st">}</span><span class="st"> rows — </span><span class="st">{</span>chunk[<span class="st">&#x27;</span><span class="st">name</span><span class="st">&#x27;</span>]<span class="op">.</span>tolist()<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Export formats</span>
df<span class="op">.</span>to_csv(<span class="st">&quot;</span><span class="st">demo_out.csv</span><span class="st">&quot;</span>, index<span class="op">=</span><span class="kw">False</span>)
df<span class="op">.</span>to_json(<span class="st">&quot;</span><span class="st">demo_out.jsonl</span><span class="st">&quot;</span>, orient<span class="op">=</span><span class="st">&quot;</span><span class="st">records</span><span class="st">&quot;</span>, lines<span class="op">=</span><span class="kw">True</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Exported CSV and JSONL</span><span class="st">&quot;</span>)

<span class="kw">import</span> os
<span class="kw">for</span> f <span class="kw">in</span> [<span class="st">&quot;</span><span class="st">demo_big.csv</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">demo_out.csv</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">demo_out.jsonl</span><span class="st">&quot;</span>]:
    os<span class="op">.</span>remove(f)
</code></pre>
  </div>
</div>

<div class="section-divider" id="etl-patterns" data-section="etl-patterns">
  <h2>ETL Patterns</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--pink-dim);color:var(--pink)">ETL</span>
</div>

<div class="card wide" data-tags="etl pipeline class">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">Cl</div>
    <h3>ETL Pipeline Class</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> logging
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

logging<span class="op">.</span>basicConfig(level<span class="op">=</span>logging<span class="op">.</span>INFO, <span class="nb">format</span><span class="op">=</span><span class="st">&quot;</span><span class="st">%(asctime)s</span><span class="st"> | </span><span class="st">%(message)s</span><span class="st">&quot;</span>, datefmt<span class="op">=</span><span class="st">&quot;</span><span class="st">%</span><span class="st">H:</span><span class="st">%</span><span class="st">M:</span><span class="st">%</span><span class="st">S</span><span class="st">&quot;</span>)
logger <span class="op">=</span> logging<span class="op">.</span>getLogger(<span class="st">&quot;</span><span class="st">etl</span><span class="st">&quot;</span>)

<span class="cm"># Sample source data</span>
SOURCE_DATA <span class="op">=</span> [
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">  Alice </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">100</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">2</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">invalid</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">3</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st"> Charlie</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">200</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">4</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">150</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">5</span>, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Eve</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">300</span><span class="st">&quot;</span>},
]

LOADED_DATA <span class="op">=</span> []  <span class="cm"># simulated destination</span>

<span class="kw">class</span> <span class="fn">ETLPipeline</span>:
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="nb">self</span>, config: <span class="nb">dict</span>):
        <span class="nb">self</span><span class="op">.</span>config <span class="op">=</span> config
        <span class="nb">self</span><span class="op">.</span>stats <span class="op">=</span> {<span class="st">&quot;</span><span class="st">extracted</span><span class="st">&quot;</span>: <span class="num">0</span>, <span class="st">&quot;</span><span class="st">transformed</span><span class="st">&quot;</span>: <span class="num">0</span>, <span class="st">&quot;</span><span class="st">loaded</span><span class="st">&quot;</span>: <span class="num">0</span>, <span class="st">&quot;</span><span class="st">errors</span><span class="st">&quot;</span>: <span class="num">0</span>}

    <span class="kw">def</span> <span class="fn">extract</span>(<span class="nb">self</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="nb">list</span>[<span class="nb">dict</span>]:
        logger<span class="op">.</span>info(<span class="st">&quot;</span><span class="st">Extracting from </span><span class="st">%s</span><span class="st">&quot;</span>, <span class="nb">self</span><span class="op">.</span>config[<span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>])
        raw <span class="op">=</span> <span class="nb">self</span><span class="op">.</span>config<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">_data</span><span class="st">&quot;</span>, [])  <span class="cm"># use injected data for demo</span>
        <span class="nb">self</span><span class="op">.</span>stats[<span class="st">&quot;</span><span class="st">extracted</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="nb">len</span>(raw)
        <span class="kw">return</span> raw

    <span class="kw">def</span> <span class="fn">transform</span>(<span class="nb">self</span>, raw: <span class="nb">list</span>[<span class="nb">dict</span>]) <span class="op">-</span><span class="op">&gt;</span> <span class="nb">list</span>[<span class="nb">dict</span>]:
        cleaned <span class="op">=</span> []
        <span class="kw">for</span> record <span class="kw">in</span> raw:
            <span class="kw">try</span>:
                name <span class="op">=</span> record<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">&quot;</span>)<span class="op">.</span>strip()
                <span class="kw">if</span> <span class="kw">not</span> name:
                    <span class="kw">raise</span> <span class="nb">ValueError</span>(<span class="st">&quot;</span><span class="st">Empty name</span><span class="st">&quot;</span>)
                cleaned<span class="op">.</span>append({
                    <span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: record[<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>],
                    <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: name<span class="op">.</span>lower(),
                    <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="nb">float</span>(record<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>, <span class="num">0</span>)),
                    <span class="st">&quot;</span><span class="st">processed_at</span><span class="st">&quot;</span>: datetime<span class="op">.</span>utcnow()<span class="op">.</span>isoformat(),
                })
            <span class="kw">except</span> (<span class="nb">KeyError</span>, <span class="nb">ValueError</span>) <span class="kw">as</span> e:
                <span class="nb">self</span><span class="op">.</span>stats[<span class="st">&quot;</span><span class="st">errors</span><span class="st">&quot;</span>] <span class="op">+</span><span class="op">=</span> <span class="num">1</span>
                logger<span class="op">.</span>warning(<span class="st">&quot;</span><span class="st">Bad record id=</span><span class="st">%s</span><span class="st">: </span><span class="st">%s</span><span class="st">&quot;</span>, record<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>), e)
        <span class="nb">self</span><span class="op">.</span>stats[<span class="st">&quot;</span><span class="st">transformed</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="nb">len</span>(cleaned)
        <span class="kw">return</span> cleaned

    <span class="kw">def</span> <span class="fn">load</span>(<span class="nb">self</span>, data: <span class="nb">list</span>[<span class="nb">dict</span>]):
        logger<span class="op">.</span>info(<span class="st">&quot;</span><span class="st">Loading </span><span class="st">%d</span><span class="st"> records to </span><span class="st">%s</span><span class="st">&quot;</span>, <span class="nb">len</span>(data), <span class="nb">self</span><span class="op">.</span>config[<span class="st">&quot;</span><span class="st">destination</span><span class="st">&quot;</span>])
        LOADED_DATA<span class="op">.</span>extend(data)  <span class="cm"># simulated bulk insert</span>
        <span class="nb">self</span><span class="op">.</span>stats[<span class="st">&quot;</span><span class="st">loaded</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="nb">len</span>(data)

    <span class="kw">def</span> <span class="fn">run</span>(<span class="nb">self</span>):
        raw <span class="op">=</span> <span class="nb">self</span><span class="op">.</span>extract()
        clean <span class="op">=</span> <span class="nb">self</span><span class="op">.</span>transform(raw)
        <span class="nb">self</span><span class="op">.</span>load(clean)
        logger<span class="op">.</span>info(<span class="st">&quot;</span><span class="st">Pipeline complete: </span><span class="st">%s</span><span class="st">&quot;</span>, <span class="nb">self</span><span class="op">.</span>stats)
        <span class="kw">return</span> <span class="nb">self</span><span class="op">.</span>stats

<span class="cm"># Run it!</span>
config <span class="op">=</span> {
    <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">api://demo</span><span class="st">&quot;</span>,
    <span class="st">&quot;</span><span class="st">destination</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">postgres://warehouse</span><span class="st">&quot;</span>,
    <span class="st">&quot;</span><span class="st">_data</span><span class="st">&quot;</span>: SOURCE_DATA,
}
pipeline <span class="op">=</span> ETLPipeline(config)
stats <span class="op">=</span> pipeline<span class="op">.</span>run()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Results: </span><span class="st">{</span>stats<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Loaded records: </span><span class="st">{</span>LOADED_DATA<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="card wide" data-tags="batching &amp; dead letter queue">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">Ba</div>
    <h3>Batching &amp; Dead Letter Queue</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> json
<span class="kw">from</span> itertools <span class="kw">import</span> islice
<span class="kw">from</span> pathlib <span class="kw">import</span> Path

<span class="kw">def</span> <span class="fn">batched</span>(iterable, n):
    <span class="st">&quot;&quot;&quot;Yield successive batches from iterable.&quot;&quot;&quot;</span>
    it <span class="op">=</span> <span class="nb">iter</span>(iterable)
    <span class="kw">while</span> <span class="kw">True</span>:
        batch <span class="op">=</span> <span class="nb">list</span>(islice(it, n))
        <span class="kw">if</span> <span class="kw">not</span> batch:
            <span class="kw">break</span>
        <span class="kw">yield</span> batch

<span class="cm"># Demo: process records in batches</span>
records <span class="op">=</span> <span class="nb">list</span>(<span class="nb">range</span>(<span class="num">1</span>, <span class="num">14</span>))
<span class="kw">for</span> i, batch <span class="kw">in</span> <span class="nb">enumerate</span>(batched(records, batch_size <span class="op">:=</span> <span class="num">5</span>)):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Batch </span><span class="st">{</span>i<span class="st">}</span><span class="st">: </span><span class="st">{</span>batch<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Dead Letter Queue pattern</span>
<span class="kw">def</span> <span class="fn">process_with_dlq</span>(records, processor, dlq_path<span class="op">=</span><span class="st">&quot;</span><span class="st">dlq_demo.jsonl</span><span class="st">&quot;</span>):
    <span class="st">&quot;&quot;&quot;Process records; write failures to dead letter queue.&quot;&quot;&quot;</span>
    success, failed <span class="op">=</span> <span class="num">0</span>, <span class="num">0</span>
    <span class="kw">with</span> <span class="nb">open</span>(dlq_path, <span class="st">&quot;</span><span class="st">w</span><span class="st">&quot;</span>) <span class="kw">as</span> dlq:
        <span class="kw">for</span> record <span class="kw">in</span> records:
            <span class="kw">try</span>:
                processor(record)
                success <span class="op">+</span><span class="op">=</span> <span class="num">1</span>
            <span class="kw">except</span> <span class="nb">Exception</span> <span class="kw">as</span> e:
                failed <span class="op">+</span><span class="op">=</span> <span class="num">1</span>
                dlq<span class="op">.</span>write(json<span class="op">.</span>dumps({
                    <span class="st">&quot;</span><span class="st">record</span><span class="st">&quot;</span>: record,
                    <span class="st">&quot;</span><span class="st">error</span><span class="st">&quot;</span>: <span class="nb">str</span>(e),
                }) <span class="op">+</span> <span class="st">&quot;</span><span class="st">\n</span><span class="st">&quot;</span>)
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Processed: </span><span class="st">{</span>success<span class="st">}</span><span class="st"> success, </span><span class="st">{</span>failed<span class="st">}</span><span class="st"> failed</span><span class="st">&quot;</span>)
    <span class="kw">return</span> success, failed

<span class="cm"># Simulated processor that fails on negative values</span>
<span class="kw">def</span> <span class="fn">transform_record</span>(record):
    <span class="kw">if</span> record[<span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>] <span class="op">&lt;</span> <span class="num">0</span>:
        <span class="kw">raise</span> <span class="nb">ValueError</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Negative value: </span><span class="st">{</span>record[<span class="st">&#x27;</span><span class="st">value</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">&quot;</span>)
    <span class="kw">return</span> record

sample_records <span class="op">=</span> [
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">100</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">2</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="op">-</span><span class="num">50</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">3</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">200</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">4</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="op">-</span><span class="num">10</span>},
    {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">5</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">300</span>},
]

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">=== Dead Letter Queue ===</span><span class="st">&quot;</span>)
process_with_dlq(sample_records, transform_record)

<span class="cm"># Show DLQ contents</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">DLQ contents:</span><span class="st">&quot;</span>)
<span class="kw">with</span> <span class="nb">open</span>(<span class="st">&quot;</span><span class="st">dlq_demo.jsonl</span><span class="st">&quot;</span>) <span class="kw">as</span> f:
    <span class="kw">for</span> line <span class="kw">in</span> f:
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  </span><span class="st">{</span>json<span class="op">.</span>loads(line)<span class="st">}</span><span class="st">&quot;</span>)

Path(<span class="st">&quot;</span><span class="st">dlq_demo.jsonl</span><span class="st">&quot;</span>)<span class="op">.</span>unlink()
</code></pre>
  </div>
</div>

<div class="section-divider" id="cloud-object-storage-simulated" data-section="cloud-object-storage-simulated">
  <h2>Cloud &amp; Object Storage (Simulated)</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--cyan-dim);color:var(--cyan)">Cloud</span>
</div>

<div class="card wide" data-tags="cloud &amp; object storage (simulated)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">Cl</div>
    <h3>Cloud &amp; Object Storage (Simulated)</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="st">&quot;&quot;&quot;
Simulated AWS S3 / GCS operations.
Install real libraries with: pip install boto3 / google-cloud-storage

Below is the real code pattern — runs as documentation/reference.
Uncomment and configure to use with real credentials.
&quot;&quot;&quot;</span>

<span class="kw">import</span> io
<span class="kw">import</span> json
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># === Simulated S3-like operations ===</span>

<span class="cm"># In-memory &quot;bucket&quot; for demo</span>
fake_s3 <span class="op">=</span> {}

<span class="kw">def</span> <span class="fn">s3_put</span>(bucket, key, data):
    fake_s3[<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>bucket<span class="st">}</span><span class="st">/</span><span class="st">{</span>key<span class="st">}</span><span class="st">&quot;</span>] <span class="op">=</span> data
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Uploaded: s3://</span><span class="st">{</span>bucket<span class="st">}</span><span class="st">/</span><span class="st">{</span>key<span class="st">}</span><span class="st"> (</span><span class="st">{</span><span class="nb">len</span>(data)<span class="st">}</span><span class="st"> bytes)</span><span class="st">&quot;</span>)

<span class="kw">def</span> <span class="fn">s3_get</span>(bucket, key):
    <span class="kw">return</span> fake_s3[<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>bucket<span class="st">}</span><span class="st">/</span><span class="st">{</span>key<span class="st">}</span><span class="st">&quot;</span>]

<span class="kw">def</span> <span class="fn">s3_list</span>(bucket, prefix<span class="op">=</span><span class="st">&quot;</span><span class="st">&quot;</span>):
    <span class="kw">return</span> [k <span class="kw">for</span> k <span class="kw">in</span> fake_s3 <span class="kw">if</span> k<span class="op">.</span>startswith(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>bucket<span class="st">}</span><span class="st">/</span><span class="st">{</span>prefix<span class="st">}</span><span class="st">&quot;</span>)]

<span class="cm"># Demo: write DataFrame to &quot;S3&quot;</span>
np<span class="op">.</span>random<span class="op">.</span>seed(<span class="num">42</span>)
df <span class="op">=</span> pd<span class="op">.</span>DataFrame({<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="nb">range</span>(<span class="num">5</span>), <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: np<span class="op">.</span>random<span class="op">.</span>randn(<span class="num">5</span>)<span class="op">.</span>round(<span class="num">3</span>)})
csv_buffer <span class="op">=</span> io<span class="op">.</span>StringIO()
df<span class="op">.</span>to_csv(csv_buffer, index<span class="op">=</span><span class="kw">False</span>)
s3_put(<span class="st">&quot;</span><span class="st">my-bucket</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">data/output.csv</span><span class="st">&quot;</span>, csv_buffer<span class="op">.</span>getvalue())

<span class="cm"># Demo: read it back</span>
content <span class="op">=</span> s3_get(<span class="st">&quot;</span><span class="st">my-bucket</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">data/output.csv</span><span class="st">&quot;</span>)
df_loaded <span class="op">=</span> pd<span class="op">.</span>read_csv(io<span class="op">.</span>StringIO(content))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Loaded from </span><span class="st">&#x27;</span><span class="st">S3</span><span class="st">&#x27;</span><span class="st">:</span><span class="st">&quot;</span>)
<span class="nb">print</span>(df_loaded)

<span class="cm"># List objects</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Objects:</span><span class="st">&quot;</span>, s3_list(<span class="st">&quot;</span><span class="st">my-bucket</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">data/</span><span class="st">&quot;</span>))

<span class="cm"># --- Real boto3 code (reference) ---</span>
<span class="cm"># import boto3</span>
<span class="cm"># s3 = boto3.client(&quot;s3&quot;)</span>
<span class="cm"># s3.upload_file(&quot;local.csv&quot;, &quot;my-bucket&quot;, &quot;data/file.csv&quot;)</span>
<span class="cm"># obj = s3.get_object(Bucket=&quot;my-bucket&quot;, Key=&quot;data/file.csv&quot;)</span>
<span class="cm"># df = pd.read_csv(io.BytesIO(obj[&quot;Body&quot;].read()))</span>
</code></pre>
  </div>
</div>

<div class="section-divider" id="api-interaction-simulated" data-section="api-interaction-simulated">
  <h2>API Interaction (Simulated)</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--purple-dim);color:var(--purple)">API</span>
</div>

<div class="card wide" data-tags="api interaction (simulated)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">Ap</div>
    <h3>API Interaction (Simulated)</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="st">&quot;&quot;&quot;
Simulated HTTP requests for Jupyter demo.
Install real library: pip install requests

The patterns below work with `requests` — swap fake_api for real URLs.
&quot;&quot;&quot;</span>

<span class="kw">import</span> json
<span class="kw">import</span> time

<span class="cm"># === Simulated API ===</span>
FAKE_DB <span class="op">=</span> [{<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: i, <span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">f</span><span class="st">&quot;</span><span class="st">user_</span><span class="st">{</span>i<span class="st">}</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">score</span><span class="st">&quot;</span>: i<span class="op">*</span><span class="num">10</span>} <span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(<span class="num">1</span>, <span class="num">26</span>)]

<span class="kw">def</span> <span class="fn">fake_api_get</span>(url, params<span class="op">=</span><span class="kw">None</span>):
    <span class="st">&quot;&quot;&quot;Simulate a paginated API response.&quot;&quot;&quot;</span>
    params <span class="op">=</span> params <span class="kw">or</span> {}
    page <span class="op">=</span> params<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">page</span><span class="st">&quot;</span>, <span class="num">1</span>)
    limit <span class="op">=</span> params<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">limit</span><span class="st">&quot;</span>, <span class="num">10</span>)
    start <span class="op">=</span> (page <span class="op">-</span> <span class="num">1</span>) <span class="op">*</span> limit
    data <span class="op">=</span> FAKE_DB[start:start<span class="op">+</span>limit]
    <span class="kw">return</span> {<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: <span class="num">200</span>, <span class="st">&quot;</span><span class="st">data</span><span class="st">&quot;</span>: data, <span class="st">&quot;</span><span class="st">page</span><span class="st">&quot;</span>: page}

<span class="cm"># Paginated extraction</span>
<span class="kw">def</span> <span class="fn">extract_all</span>(base_url, page_size<span class="op">=</span><span class="num">10</span>):
    all_records <span class="op">=</span> []
    page <span class="op">=</span> <span class="num">1</span>
    <span class="kw">while</span> <span class="kw">True</span>:
        resp <span class="op">=</span> fake_api_get(base_url, params<span class="op">=</span>{<span class="st">&quot;</span><span class="st">page</span><span class="st">&quot;</span>: page, <span class="st">&quot;</span><span class="st">limit</span><span class="st">&quot;</span>: page_size})
        batch <span class="op">=</span> resp[<span class="st">&quot;</span><span class="st">data</span><span class="st">&quot;</span>]
        <span class="kw">if</span> <span class="kw">not</span> batch:
            <span class="kw">break</span>
        all_records<span class="op">.</span>extend(batch)
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Page </span><span class="st">{</span>page<span class="st">}</span><span class="st">: fetched </span><span class="st">{</span><span class="nb">len</span>(batch)<span class="st">}</span><span class="st"> records</span><span class="st">&quot;</span>)
        page <span class="op">+</span><span class="op">=</span> <span class="num">1</span>
    <span class="kw">return</span> all_records

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">=== Paginated API Extraction ===</span><span class="st">&quot;</span>)
all_data <span class="op">=</span> extract_all(<span class="st">&quot;</span><span class="st">https://api.example.com/users</span><span class="st">&quot;</span>, page_size<span class="op">=</span><span class="num">10</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Total extracted: </span><span class="st">{</span><span class="nb">len</span>(all_data)<span class="st">}</span><span class="st"> records</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">First: </span><span class="st">{</span>all_data[<span class="num">0</span>]<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">Last:  </span><span class="st">{</span>all_data[<span class="op">-</span><span class="num">1</span>]<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># --- Real requests code (reference) ---</span>
<span class="cm"># import requests</span>
<span class="cm"># from requests.adapters import HTTPAdapter</span>
<span class="cm"># from urllib3.util.retry import Retry</span>
<span class="cm">#</span>
<span class="cm"># session = requests.Session()</span>
<span class="cm"># retries = Retry(total=3, backoff_factor=1, status_forcelist=[429, 500, 502, 503])</span>
<span class="cm"># session.mount(&quot;https://&quot;, HTTPAdapter(max_retries=retries))</span>
<span class="cm"># resp = session.get(&quot;https://api.example.com/data&quot;,</span>
<span class="cm">#     params={&quot;page&quot;: 1}, headers={&quot;Authorization&quot;: &quot;Bearer TOKEN&quot;}, timeout=30)</span>
<span class="cm"># resp.raise_for_status()</span>
<span class="cm"># data = resp.json()</span>
</code></pre>
  </div>
</div>

<div class="section-divider" id="concurrency-parallelism" data-section="concurrency-parallelism">
  <h2>Concurrency &amp; Parallelism</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Concurrency</span>
</div>

<div class="card wide" data-tags="concurrency &amp; parallelism">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Co</div>
    <h3>Concurrency &amp; Parallelism</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> time
<span class="kw">from</span> concurrent.futures <span class="kw">import</span> ThreadPoolExecutor, ProcessPoolExecutor, as_completed
<span class="kw">import</span> asyncio

<span class="cm"># === ThreadPoolExecutor — I/O-bound ===</span>
<span class="kw">def</span> <span class="fn">fetch_url</span>(url):
    <span class="st">&quot;&quot;&quot;Simulate an API call with a small delay.&quot;&quot;&quot;</span>
    time<span class="op">.</span>sleep(<span class="num">0.05</span>)  <span class="cm"># simulate network latency</span>
    <span class="kw">return</span> {<span class="st">&quot;</span><span class="st">url</span><span class="st">&quot;</span>: url, <span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: <span class="num">200</span>, <span class="st">&quot;</span><span class="st">size</span><span class="st">&quot;</span>: <span class="nb">len</span>(url) <span class="op">*</span> <span class="num">100</span>}

urls <span class="op">=</span> [<span class="st">f</span><span class="st">&quot;</span><span class="st">https://api.example.com/page/</span><span class="st">{</span>i<span class="st">}</span><span class="st">&quot;</span> <span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(<span class="num">10</span>)]

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">=== Threading (I/O-bound) ===</span><span class="st">&quot;</span>)
t0 <span class="op">=</span> time<span class="op">.</span>perf_counter()
results <span class="op">=</span> []
<span class="kw">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="num">5</span>) <span class="kw">as</span> pool:
    futures <span class="op">=</span> {pool<span class="op">.</span>submit(fetch_url, url): url <span class="kw">for</span> url <span class="kw">in</span> urls}
    <span class="kw">for</span> future <span class="kw">in</span> as_completed(futures):
        results<span class="op">.</span>append(future<span class="op">.</span>result())
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Fetched </span><span class="st">{</span><span class="nb">len</span>(results)<span class="st">}</span><span class="st"> URLs in </span><span class="st">{</span>time<span class="op">.</span>perf_counter()<span class="op">-</span>t0<span class="st">:</span><span class="st">.3f</span><span class="st">}</span><span class="st">s (parallel)</span><span class="st">&quot;</span>)

t0 <span class="op">=</span> time<span class="op">.</span>perf_counter()
sequential <span class="op">=</span> [fetch_url(url) <span class="kw">for</span> url <span class="kw">in</span> urls]
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Fetched </span><span class="st">{</span><span class="nb">len</span>(sequential)<span class="st">}</span><span class="st"> URLs in </span><span class="st">{</span>time<span class="op">.</span>perf_counter()<span class="op">-</span>t0<span class="st">:</span><span class="st">.3f</span><span class="st">}</span><span class="st">s (sequential)</span><span class="st">&quot;</span>)

<span class="cm"># === ProcessPoolExecutor — CPU-bound ===</span>
<span class="kw">def</span> <span class="fn">heavy_compute</span>(n):
    <span class="st">&quot;&quot;&quot;Simulate CPU-intensive work.&quot;&quot;&quot;</span>
    <span class="kw">return</span> <span class="nb">sum</span>(i<span class="op">*</span>i <span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(n))

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Multiprocessing (CPU-bound) ===</span><span class="st">&quot;</span>)
chunks <span class="op">=</span> [<span class="num">100_000</span>] <span class="op">*</span> <span class="num">8</span>
t0 <span class="op">=</span> time<span class="op">.</span>perf_counter()
<span class="kw">with</span> ProcessPoolExecutor(max_workers<span class="op">=</span><span class="num">4</span>) <span class="kw">as</span> pool:
    results <span class="op">=</span> <span class="nb">list</span>(pool<span class="op">.</span>map(heavy_compute, chunks))
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Processed </span><span class="st">{</span><span class="nb">len</span>(results)<span class="st">}</span><span class="st"> chunks in </span><span class="st">{</span>time<span class="op">.</span>perf_counter()<span class="op">-</span>t0<span class="st">:</span><span class="st">.3f</span><span class="st">}</span><span class="st">s</span><span class="st">&quot;</span>)

<span class="cm"># === asyncio — high-concurrency I/O ===</span>
<span class="kw">async</span> <span class="kw">def</span> <span class="fn">async_fetch</span>(url, delay<span class="op">=</span><span class="num">0.05</span>):
    <span class="kw">await</span> asyncio<span class="op">.</span>sleep(delay)  <span class="cm"># simulate I/O</span>
    <span class="kw">return</span> {<span class="st">&quot;</span><span class="st">url</span><span class="st">&quot;</span>: url, <span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: <span class="num">200</span>}

<span class="kw">async</span> <span class="kw">def</span> <span class="fn">main</span>():
    tasks <span class="op">=</span> [async_fetch(<span class="st">f</span><span class="st">&quot;</span><span class="st">https://api.example.com/p/</span><span class="st">{</span>i<span class="st">}</span><span class="st">&quot;</span>) <span class="kw">for</span> i <span class="kw">in</span> <span class="nb">range</span>(<span class="num">10</span>)]
    results <span class="op">=</span> <span class="kw">await</span> asyncio<span class="op">.</span>gather(<span class="op">*</span>tasks)
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Async fetched: </span><span class="st">{</span><span class="nb">len</span>(results)<span class="st">}</span><span class="st"> results</span><span class="st">&quot;</span>)

<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== Asyncio ===</span><span class="st">&quot;</span>)
<span class="kw">await</span> main()  <span class="cm"># In Jupyter, use `await` directly. In scripts, use: asyncio.run(main())</span>
</code></pre>
  </div>
</div>

<div class="section-divider" id="data-validation-quality" data-section="data-validation-quality">
  <h2>Data Validation &amp; Quality</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--green-dim);color:var(--green)">Quality</span>
</div>

<div class="card wide" data-tags="data validation &amp; quality">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Va</div>
    <h3>Data Validation &amp; Quality</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> logging

logging<span class="op">.</span>basicConfig(level<span class="op">=</span>logging<span class="op">.</span>INFO, <span class="nb">format</span><span class="op">=</span><span class="st">&quot;</span><span class="st">%(message)s</span><span class="st">&quot;</span>)
logger <span class="op">=</span> logging<span class="op">.</span>getLogger(<span class="st">&quot;</span><span class="st">dq</span><span class="st">&quot;</span>)

<span class="cm"># === Schema validation (manual Pydantic-style) ===</span>
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

<span class="dc">@dataclass</span>
<span class="kw">class</span> <span class="fn">EventRecord</span>:
    event_id: <span class="nb">str</span>
    timestamp: <span class="nb">str</span>
    value: <span class="nb">float</span>
    source: <span class="nb">str</span>

    <span class="kw">def</span> <span class="fn">__post_init__</span>(<span class="nb">self</span>):
        <span class="kw">if</span> <span class="kw">not</span> <span class="nb">self</span><span class="op">.</span>event_id:
            <span class="kw">raise</span> <span class="nb">ValueError</span>(<span class="st">&quot;</span><span class="st">event_id cannot be empty</span><span class="st">&quot;</span>)
        <span class="kw">if</span> <span class="nb">self</span><span class="op">.</span>value <span class="op">&lt;</span> <span class="num">0</span>:
            <span class="kw">raise</span> <span class="nb">ValueError</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">value must be &gt;= 0, got </span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>value<span class="st">}</span><span class="st">&quot;</span>)
        datetime<span class="op">.</span>fromisoformat(<span class="nb">self</span><span class="op">.</span>timestamp)  <span class="cm"># validate timestamp</span>

<span class="cm"># Validate batch</span>
<span class="kw">def</span> <span class="fn">validate_batch</span>(records):
    valid, invalid <span class="op">=</span> [], []
    <span class="kw">for</span> r <span class="kw">in</span> records:
        <span class="kw">try</span>:
            evt <span class="op">=</span> EventRecord(<span class="op">*</span><span class="op">*</span>r)
            valid<span class="op">.</span>append({<span class="st">&quot;</span><span class="st">event_id</span><span class="st">&quot;</span>: evt<span class="op">.</span>event_id, <span class="st">&quot;</span><span class="st">timestamp</span><span class="st">&quot;</span>: evt<span class="op">.</span>timestamp,
                          <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: evt<span class="op">.</span>value, <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: evt<span class="op">.</span>source})
        <span class="kw">except</span> <span class="nb">Exception</span> <span class="kw">as</span> e:
            invalid<span class="op">.</span>append({<span class="st">&quot;</span><span class="st">record</span><span class="st">&quot;</span>: r, <span class="st">&quot;</span><span class="st">error</span><span class="st">&quot;</span>: <span class="nb">str</span>(e)})
    <span class="kw">return</span> valid, invalid

sample <span class="op">=</span> [
    {<span class="st">&quot;</span><span class="st">event_id</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">evt-001</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">timestamp</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">2024-06-15T10:30:00</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">42.5</span>, <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">sensor_a</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">event_id</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">timestamp</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">2024-06-15T10:31:00</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">10.0</span>, <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">sensor_b</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">event_id</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">evt-003</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">timestamp</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">2024-06-15T10:32:00</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="op">-</span><span class="num">5.0</span>, <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">sensor_c</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">event_id</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">evt-004</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">timestamp</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">bad-date</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">20.0</span>, <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">sensor_a</span><span class="st">&quot;</span>},
    {<span class="st">&quot;</span><span class="st">event_id</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">evt-005</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">timestamp</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">2024-06-15T10:34:00</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: <span class="num">99.9</span>, <span class="st">&quot;</span><span class="st">source</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">sensor_b</span><span class="st">&quot;</span>},
]

valid, invalid <span class="op">=</span> validate_batch(sample)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">=== Validation: </span><span class="st">{</span><span class="nb">len</span>(valid)<span class="st">}</span><span class="st"> valid, </span><span class="st">{</span><span class="nb">len</span>(invalid)<span class="st">}</span><span class="st"> invalid ===</span><span class="st">&quot;</span>)
<span class="kw">for</span> v <span class="kw">in</span> valid:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  ✓ </span><span class="st">{</span>v[<span class="st">&#x27;</span><span class="st">event_id</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">: </span><span class="st">{</span>v[<span class="st">&#x27;</span><span class="st">value</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">&quot;</span>)
<span class="kw">for</span> inv <span class="kw">in</span> invalid:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  ✗ </span><span class="st">{</span>inv[<span class="st">&#x27;</span><span class="st">record</span><span class="st">&#x27;</span>]<span class="op">.</span>get(<span class="st">&#x27;</span><span class="st">event_id</span><span class="st">&#x27;</span>, <span class="st">&#x27;</span><span class="st">???</span><span class="st">&#x27;</span>)<span class="st">}</span><span class="st">: </span><span class="st">{</span>inv[<span class="st">&#x27;</span><span class="st">error</span><span class="st">&#x27;</span>]<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># === Data quality checks on DataFrame ===</span>
np<span class="op">.</span>random<span class="op">.</span>seed(<span class="num">42</span>)
df <span class="op">=</span> pd<span class="op">.</span>DataFrame({
    <span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="nb">list</span>(<span class="nb">range</span>(<span class="num">1</span>, <span class="num">201</span>)),
    <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>: np<span class="op">.</span>random<span class="op">.</span>uniform(<span class="op">-</span><span class="num">5</span>, <span class="num">100</span>, <span class="num">200</span>),
    <span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>: pd<span class="op">.</span>date_range(<span class="st">&quot;</span><span class="st">2024-01-01</span><span class="st">&quot;</span>, periods<span class="op">=</span><span class="num">200</span>)<span class="op">.</span>astype(<span class="nb">str</span>),
})
df<span class="op">.</span>loc[<span class="num">5</span>, <span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="kw">None</span>  <span class="cm"># inject a null</span>
df<span class="op">.</span>loc[<span class="num">10</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="op">-</span><span class="num">999</span>  <span class="cm"># inject a bad value</span>

<span class="kw">def</span> <span class="fn">data_quality_checks</span>(df):
    checks <span class="op">=</span> {
        <span class="st">&quot;</span><span class="st">no_nulls_in_id</span><span class="st">&quot;</span>:    df[<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>]<span class="op">.</span>notnull()<span class="op">.</span>all(),
        <span class="st">&quot;</span><span class="st">positive_values</span><span class="st">&quot;</span>:   (df[<span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>] <span class="op">&gt;</span><span class="op">=</span> <span class="num">0</span>)<span class="op">.</span>all(),
        <span class="st">&quot;</span><span class="st">unique_ids</span><span class="st">&quot;</span>:        df[<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>]<span class="op">.</span>dropna()<span class="op">.</span>is_unique,
        <span class="st">&quot;</span><span class="st">row_count_min</span><span class="st">&quot;</span>:     <span class="nb">len</span>(df) <span class="op">&gt;</span><span class="op">=</span> <span class="num">100</span>,
        <span class="st">&quot;</span><span class="st">valid_dates</span><span class="st">&quot;</span>:       pd<span class="op">.</span>to_datetime(df[<span class="st">&quot;</span><span class="st">date</span><span class="st">&quot;</span>])<span class="op">.</span>between(<span class="st">&quot;</span><span class="st">2020-01-01</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">2030-01-01</span><span class="st">&quot;</span>)<span class="op">.</span>all(),
    }
    <span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">=== DQ Checks ===</span><span class="st">&quot;</span>)
    <span class="kw">for</span> name, passed <span class="kw">in</span> checks<span class="op">.</span>items():
        status <span class="op">=</span> <span class="st">&quot;</span><span class="st">✓ PASS</span><span class="st">&quot;</span> <span class="kw">if</span> passed <span class="kw">else</span> <span class="st">&quot;</span><span class="st">✗ FAIL</span><span class="st">&quot;</span>
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  </span><span class="st">{</span>status<span class="st">}</span><span class="st">: </span><span class="st">{</span>name<span class="st">}</span><span class="st">&quot;</span>)
    <span class="kw">return</span> <span class="nb">all</span>(checks<span class="op">.</span>values())

all_passed <span class="op">=</span> data_quality_checks(df)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">All checks passed: </span><span class="st">{</span>all_passed<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="environment-configuration" data-section="environment-configuration">
  <h2>Environment &amp; Configuration</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--blue-dim);color:var(--blue)">Config</span>
</div>

<div class="card wide" data-tags="environment &amp; configuration">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Cf</div>
    <h3>Environment &amp; Configuration</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> os
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass

<span class="cm"># Set demo environment variables (in production, these come from .env or the OS)</span>
os<span class="op">.</span>environ[<span class="st">&quot;</span><span class="st">DB_HOST</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">localhost</span><span class="st">&quot;</span>
os<span class="op">.</span>environ[<span class="st">&quot;</span><span class="st">DB_PORT</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">5432</span><span class="st">&quot;</span>
os<span class="op">.</span>environ[<span class="st">&quot;</span><span class="st">DB_NAME</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">mydb</span><span class="st">&quot;</span>
os<span class="op">.</span>environ[<span class="st">&quot;</span><span class="st">BATCH_SIZE</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">5000</span><span class="st">&quot;</span>
os<span class="op">.</span>environ[<span class="st">&quot;</span><span class="st">DEBUG</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">true</span><span class="st">&quot;</span>

<span class="cm"># Reading env vars</span>
DB_HOST <span class="op">=</span> os<span class="op">.</span>environ[<span class="st">&quot;</span><span class="st">DB_HOST</span><span class="st">&quot;</span>]
DB_PORT <span class="op">=</span> os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">DB_PORT</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">5432</span><span class="st">&quot;</span>)
DEBUG <span class="op">=</span> os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">DEBUG</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">false</span><span class="st">&quot;</span>)<span class="op">.</span>lower() <span class="op">==</span> <span class="st">&quot;</span><span class="st">true</span><span class="st">&quot;</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">DB_HOST=</span><span class="st">{</span>DB_HOST<span class="st">}</span><span class="st">, DB_PORT=</span><span class="st">{</span>DB_PORT<span class="st">}</span><span class="st">, DEBUG=</span><span class="st">{</span>DEBUG<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Config class pattern</span>
<span class="dc">@dataclass</span>
<span class="kw">class</span> <span class="fn">Config</span>:
    db_host: <span class="nb">str</span> <span class="op">=</span> os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">DB_HOST</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">localhost</span><span class="st">&quot;</span>)
    db_port: <span class="nb">int</span> <span class="op">=</span> <span class="nb">int</span>(os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">DB_PORT</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">5432</span><span class="st">&quot;</span>))
    db_name: <span class="nb">str</span> <span class="op">=</span> os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">DB_NAME</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">mydb</span><span class="st">&quot;</span>)
    batch_size: <span class="nb">int</span> <span class="op">=</span> <span class="nb">int</span>(os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">BATCH_SIZE</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">5000</span><span class="st">&quot;</span>))
    debug: <span class="nb">bool</span> <span class="op">=</span> os<span class="op">.</span>environ<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">DEBUG</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">false</span><span class="st">&quot;</span>)<span class="op">.</span>lower() <span class="op">==</span> <span class="st">&quot;</span><span class="st">true</span><span class="st">&quot;</span>

    <span class="dc">@property</span>
    <span class="kw">def</span> <span class="fn">db_url</span>(<span class="nb">self</span>):
        <span class="kw">return</span> <span class="st">f</span><span class="st">&quot;</span><span class="st">postgresql://</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>db_host<span class="st">}</span><span class="st">:</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>db_port<span class="st">}</span><span class="st">/</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>db_name<span class="st">}</span><span class="st">&quot;</span>

config <span class="op">=</span> Config()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">\n</span><span class="st">Config: </span><span class="st">{</span>config<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">DB URL: </span><span class="st">{</span>config<span class="op">.</span>db_url<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Cleanup</span>
<span class="kw">for</span> key <span class="kw">in</span> [<span class="st">&quot;</span><span class="st">DB_HOST</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">DB_PORT</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">DB_NAME</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">BATCH_SIZE</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">DEBUG</span><span class="st">&quot;</span>]:
    os<span class="op">.</span>environ<span class="op">.</span>pop(key, <span class="kw">None</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="pro-tips-patterns" data-section="pro-tips-patterns">
  <h2>Pro Tips &amp; Patterns</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--pink-dim);color:var(--pink)">Pro Tips</span>
</div>

<div class="card" data-tags="built-in superpowers">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">Bi</div>
    <h3>Built-in Superpowers</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># enumerate — index + value</span>
items <span class="op">=</span> [<span class="st">&quot;</span><span class="st">apple</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">banana</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">cherry</span><span class="st">&quot;</span>]
<span class="kw">for</span> i, val <span class="kw">in</span> <span class="nb">enumerate</span>(items, start<span class="op">=</span><span class="num">1</span>):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>i<span class="st">}</span><span class="st">. </span><span class="st">{</span>val<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># zip — parallel iteration &amp; dict creation</span>
names <span class="op">=</span> [<span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Bob</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">Charlie</span><span class="st">&quot;</span>]
scores <span class="op">=</span> [<span class="num">95</span>, <span class="num">87</span>, <span class="num">92</span>]
<span class="kw">for</span> name, score <span class="kw">in</span> <span class="nb">zip</span>(names, scores):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  </span><span class="st">{</span>name<span class="st">}</span><span class="st">: </span><span class="st">{</span>score<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">zip → dict:</span><span class="st">&quot;</span>, <span class="nb">dict</span>(<span class="nb">zip</span>(names, scores)))

<span class="cm"># any / all — quick checks</span>
records <span class="op">=</span> [{<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">ok</span><span class="st">&quot;</span>}, {<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">error</span><span class="st">&quot;</span>}, {<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">ok</span><span class="st">&quot;</span>}]
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">any errors: </span><span class="st">{</span><span class="nb">any</span>(r[<span class="st">&#x27;</span><span class="st">status</span><span class="st">&#x27;</span>] <span class="op">==</span> <span class="st">&#x27;</span><span class="st">error</span><span class="st">&#x27;</span> <span class="kw">for</span> r <span class="kw">in</span> records)<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">all have id: </span><span class="st">{</span><span class="nb">all</span>(r<span class="op">.</span>get(<span class="st">&#x27;</span><span class="st">id</span><span class="st">&#x27;</span>) <span class="kw">for</span> r <span class="kw">in</span> records)<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># sorted with key</span>
<span class="kw">from</span> pathlib <span class="kw">import</span> Path
files <span class="op">=</span> [Path(<span class="st">&quot;</span><span class="st">a.csv</span><span class="st">&quot;</span>), Path(<span class="st">&quot;</span><span class="st">bb.json</span><span class="st">&quot;</span>), Path(<span class="st">&quot;</span><span class="st">ccc.txt</span><span class="st">&quot;</span>)]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">sorted by name length:</span><span class="st">&quot;</span>, <span class="nb">sorted</span>(files, key<span class="op">=</span><span class="kw">lambda</span> f: <span class="nb">len</span>(f<span class="op">.</span>name), reverse<span class="op">=</span><span class="kw">True</span>))

<span class="cm"># collections</span>
<span class="kw">from</span> collections <span class="kw">import</span> Counter, deque
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">\n</span><span class="st">Counter:</span><span class="st">&quot;</span>, Counter(<span class="st">&quot;</span><span class="st">banana</span><span class="st">&quot;</span>)<span class="op">.</span>most_common(<span class="num">2</span>))

<span class="cm"># itertools</span>
<span class="kw">from</span> itertools <span class="kw">import</span> chain, islice
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">chain:</span><span class="st">&quot;</span>, <span class="nb">list</span>(chain([<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>], [<span class="num">5</span>])))

<span class="cm"># First 5 from a generator</span>
gen <span class="op">=</span> (x<span class="op">*</span><span class="op">*</span><span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="nb">range</span>(<span class="num">1000</span>))
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">islice:</span><span class="st">&quot;</span>, <span class="nb">list</span>(islice(gen, <span class="num">5</span>)))
</code></pre>
  </div>
</div>

<div class="card" data-tags="one-liners &amp; tricks">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">OL</div>
    <h3>One-Liners &amp; Tricks</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># Flatten nested list</span>
nested <span class="op">=</span> [[<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>], [<span class="num">5</span>, <span class="num">6</span>, <span class="num">7</span>]]
flat <span class="op">=</span> [x <span class="kw">for</span> sub <span class="kw">in</span> nested <span class="kw">for</span> x <span class="kw">in</span> sub]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">flatten:</span><span class="st">&quot;</span>, flat)

<span class="cm"># Remove duplicates, preserve order</span>
lst <span class="op">=</span> [<span class="num">3</span>, <span class="num">1</span>, <span class="num">4</span>, <span class="num">1</span>, <span class="num">5</span>, <span class="num">9</span>, <span class="num">2</span>, <span class="num">6</span>, <span class="num">5</span>, <span class="num">3</span>]
seen <span class="op">=</span> <span class="nb">set</span>()
uniq <span class="op">=</span> [x <span class="kw">for</span> x <span class="kw">in</span> lst <span class="kw">if</span> x <span class="kw">not</span> <span class="kw">in</span> seen <span class="kw">and</span> <span class="kw">not</span> seen<span class="op">.</span>add(x)]
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">deduplicated:</span><span class="st">&quot;</span>, uniq)

<span class="cm"># Merge dicts (3.9+)</span>
d1 <span class="op">=</span> {<span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>: <span class="num">2</span>}
d2 <span class="op">=</span> {<span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>: <span class="num">3</span>, <span class="st">&quot;</span><span class="st">c</span><span class="st">&quot;</span>: <span class="num">4</span>}
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">merged:</span><span class="st">&quot;</span>, d1 <span class="op">|</span> d2)

<span class="cm"># Safe nested dict access</span>
d <span class="op">=</span> {<span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>: {<span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>: {<span class="st">&quot;</span><span class="st">c</span><span class="st">&quot;</span>: <span class="num">42</span>}}}
val <span class="op">=</span> d<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>, {})<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>, {})<span class="op">.</span>get(<span class="st">&quot;</span><span class="st">c</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">nested access:</span><span class="st">&quot;</span>, val)

<span class="cm"># Timing code</span>
<span class="kw">from</span> time <span class="kw">import</span> perf_counter
t0 <span class="op">=</span> perf_counter()
total <span class="op">=</span> <span class="nb">sum</span>(<span class="nb">range</span>(<span class="num">1_000_000</span>))
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">sum=</span><span class="st">{</span>total<span class="st">}</span><span class="st">, time=</span><span class="st">{</span>perf_counter()<span class="op">-</span>t0<span class="st">:</span><span class="st">.4f</span><span class="st">}</span><span class="st">s</span><span class="st">&quot;</span>)

<span class="cm"># Regex — extract dates</span>
<span class="kw">import</span> re
log_text <span class="op">=</span> <span class="st">&quot;</span><span class="st">Error at 2024-01-15 and warning at 2024-06-30 12:00:00</span><span class="st">&quot;</span>
dates <span class="op">=</span> re<span class="op">.</span>findall(<span class="st">r</span><span class="st">&#x27;</span><span class="st">\</span><span class="st">d</span><span class="st">{4}</span><span class="st">-</span><span class="st">\</span><span class="st">d</span><span class="st">{2}</span><span class="st">-</span><span class="st">\</span><span class="st">d</span><span class="st">{2}</span><span class="st">&#x27;</span>, log_text)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">dates:</span><span class="st">&quot;</span>, dates)

emails_text <span class="op">=</span> <span class="st">&quot;</span><span class="st">Contact alice@example.com or bob@test.org</span><span class="st">&quot;</span>
emails <span class="op">=</span> re<span class="op">.</span>findall(<span class="st">r</span><span class="st">&#x27;</span><span class="st">\</span><span class="st">S+@</span><span class="st">\</span><span class="st">S+</span><span class="st">&#x27;</span>, emails_text)
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">emails:</span><span class="st">&quot;</span>, emails)

<span class="cm"># hashlib — checksums for data integrity</span>
<span class="kw">import</span> hashlib
data <span class="op">=</span> <span class="st">b</span><span class="st">&quot;</span><span class="st">Hello, data pipeline!</span><span class="st">&quot;</span>
checksum <span class="op">=</span> hashlib<span class="op">.</span>md5(data)<span class="op">.</span>hexdigest()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">MD5 checksum: </span><span class="st">{</span>checksum<span class="st">}</span><span class="st">&quot;</span>)
sha <span class="op">=</span> hashlib<span class="op">.</span>sha256(data)<span class="op">.</span>hexdigest()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">SHA256: </span><span class="st">{</span>sha<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="dunder-magic-methods" data-section="dunder-magic-methods">
  <h2>Dunder (Magic) Methods</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--cyan-dim);color:var(--cyan)">Dunder Methods</span>
</div>

<div class="card wide" data-tags="dunder (magic) methods">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">Du</div>
    <h3>Dunder (Magic) Methods</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># Dunders = &quot;double underscore&quot; methods that Python calls implicitly</span>
<span class="cm"># They let your classes integrate with Python&#x27;s built-in operations</span>

<span class="kw">class</span> <span class="fn">DataBatch</span>:
    <span class="st">&quot;&quot;&quot;A custom container that demonstrates key dunders.&quot;&quot;&quot;</span>

    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="nb">self</span>, name, records):
        <span class="nb">self</span><span class="op">.</span>name <span class="op">=</span> name
        <span class="nb">self</span><span class="op">.</span>records <span class="op">=</span> <span class="nb">list</span>(records)

    <span class="cm"># String representations</span>
    <span class="kw">def</span> <span class="fn">__repr__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;For developers — unambiguous. Called by repr() and in REPL.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="st">f</span><span class="st">&quot;</span><span class="st">DataBatch(name=</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>name<span class="st">!r}</span><span class="st">, size=</span><span class="st">{</span><span class="nb">len</span>(<span class="nb">self</span><span class="op">.</span>records)<span class="st">}</span><span class="st">)</span><span class="st">&quot;</span>

    <span class="kw">def</span> <span class="fn">__str__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;For users — readable. Called by str() and print().&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="st">f</span><span class="st">&quot;</span><span class="st">Batch </span><span class="st">&#x27;</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>name<span class="st">}</span><span class="st">&#x27;</span><span class="st"> (</span><span class="st">{</span><span class="nb">len</span>(<span class="nb">self</span><span class="op">.</span>records)<span class="st">}</span><span class="st"> records)</span><span class="st">&quot;</span>

    <span class="cm"># Container protocol</span>
    <span class="kw">def</span> <span class="fn">__len__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;Called by len().&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">len</span>(<span class="nb">self</span><span class="op">.</span>records)

    <span class="kw">def</span> <span class="fn">__getitem__</span>(<span class="nb">self</span>, index):
        <span class="st">&quot;&quot;&quot;Called by batch[i] — enables indexing and iteration.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">self</span><span class="op">.</span>records[index]

    <span class="kw">def</span> <span class="fn">__contains__</span>(<span class="nb">self</span>, item):
        <span class="st">&quot;&quot;&quot;Called by &#x27;in&#x27; operator.&quot;&quot;&quot;</span>
        <span class="kw">return</span> item <span class="kw">in</span> <span class="nb">self</span><span class="op">.</span>records

    <span class="kw">def</span> <span class="fn">__iter__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;Called by for loop, list(), etc.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">iter</span>(<span class="nb">self</span><span class="op">.</span>records)

    <span class="cm"># Comparison</span>
    <span class="kw">def</span> <span class="fn">__eq__</span>(<span class="nb">self</span>, other):
        <span class="st">&quot;&quot;&quot;Called by ==.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">isinstance</span>(other, DataBatch) <span class="kw">and</span> <span class="nb">self</span><span class="op">.</span>records <span class="op">==</span> other<span class="op">.</span>records

    <span class="kw">def</span> <span class="fn">__lt__</span>(<span class="nb">self</span>, other):
        <span class="st">&quot;&quot;&quot;Called by &lt;. Enables sorting.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">len</span>(<span class="nb">self</span><span class="op">.</span>records) <span class="op">&lt;</span> <span class="nb">len</span>(other<span class="op">.</span>records)

    <span class="cm"># Arithmetic — combine batches</span>
    <span class="kw">def</span> <span class="fn">__add__</span>(<span class="nb">self</span>, other):
        <span class="st">&quot;&quot;&quot;Called by +.&quot;&quot;&quot;</span>
        <span class="kw">return</span> DataBatch(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>name<span class="st">}</span><span class="st">+</span><span class="st">{</span>other<span class="op">.</span>name<span class="st">}</span><span class="st">&quot;</span>, <span class="nb">self</span><span class="op">.</span>records <span class="op">+</span> other<span class="op">.</span>records)

    <span class="cm"># Context manager protocol</span>
    <span class="kw">def</span> <span class="fn">__enter__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;Called on &#x27;with&#x27; entry.&quot;&quot;&quot;</span>
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Opening batch </span><span class="st">&#x27;</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>name<span class="st">}</span><span class="st">&#x27;</span><span class="st">&quot;</span>)
        <span class="kw">return</span> <span class="nb">self</span>

    <span class="kw">def</span> <span class="fn">__exit__</span>(<span class="nb">self</span>, exc_type, exc_val, exc_tb):
        <span class="st">&quot;&quot;&quot;Called on &#x27;with&#x27; exit.&quot;&quot;&quot;</span>
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Closing batch </span><span class="st">&#x27;</span><span class="st">{</span><span class="nb">self</span><span class="op">.</span>name<span class="st">}</span><span class="st">&#x27;</span><span class="st"> (error=</span><span class="st">{</span>exc_type <span class="kw">is</span> <span class="kw">not</span> <span class="kw">None</span><span class="st">}</span><span class="st">)</span><span class="st">&quot;</span>)
        <span class="kw">return</span> <span class="kw">False</span>  <span class="cm"># don&#x27;t suppress exceptions</span>

    <span class="cm"># Callable</span>
    <span class="kw">def</span> <span class="fn">__call__</span>(<span class="nb">self</span>, transform_fn):
        <span class="st">&quot;&quot;&quot;Called when instance is used as a function: batch(fn).&quot;&quot;&quot;</span>
        <span class="kw">return</span> DataBatch(<span class="nb">self</span><span class="op">.</span>name, [transform_fn(r) <span class="kw">for</span> r <span class="kw">in</span> <span class="nb">self</span><span class="op">.</span>records])

    <span class="cm"># Boolean</span>
    <span class="kw">def</span> <span class="fn">__bool__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;Called by bool(), if, while.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">len</span>(<span class="nb">self</span><span class="op">.</span>records) <span class="op">&gt;</span> <span class="num">0</span>

    <span class="cm"># Hash (needed if used as dict key or in sets)</span>
    <span class="kw">def</span> <span class="fn">__hash__</span>(<span class="nb">self</span>):
        <span class="kw">return</span> <span class="nb">hash</span>((<span class="nb">self</span><span class="op">.</span>name, <span class="nb">tuple</span>(<span class="nb">self</span><span class="op">.</span>records)))

<span class="cm"># Demo all dunders</span>
batch1 <span class="op">=</span> DataBatch(<span class="st">&quot;</span><span class="st">users</span><span class="st">&quot;</span>, [{<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">1</span>}, {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">2</span>}, {<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>: <span class="num">3</span>}])
batch2 <span class="op">=</span> DataBatch(<span class="st">&quot;</span><span class="st">orders</span><span class="st">&quot;</span>, [{<span class="st">&quot;</span><span class="st">oid</span><span class="st">&quot;</span>: <span class="num">10</span>}, {<span class="st">&quot;</span><span class="st">oid</span><span class="st">&quot;</span>: <span class="num">20</span>}])

<span class="nb">print</span>(<span class="nb">repr</span>(batch1))                    <span class="cm"># __repr__</span>
<span class="nb">print</span>(<span class="nb">str</span>(batch1))                     <span class="cm"># __str__</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">len: </span><span class="st">{</span><span class="nb">len</span>(batch1)<span class="st">}</span><span class="st">&quot;</span>)           <span class="cm"># __len__</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">batch1[0]: </span><span class="st">{</span>batch1[<span class="num">0</span>]<span class="st">}</span><span class="st">&quot;</span>)       <span class="cm"># __getitem__</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">contains: </span><span class="st">{{</span><span class="st">&#x27;</span><span class="st">id</span><span class="st">&#x27;</span><span class="st">: 1</span><span class="st">}</span><span class="st"> in batch1</span><span class="st">}</span><span class="st">: </span><span class="st">{{</span><span class="st">&#x27;</span><span class="st">id</span><span class="st">&#x27;</span><span class="st">: 1</span><span class="st">}</span><span class="st"> in batch1</span><span class="st">}</span><span class="st">&quot;</span>)  <span class="cm"># __contains__</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">bool(batch1): </span><span class="st">{</span><span class="nb">bool</span>(batch1)<span class="st">}</span><span class="st">&quot;</span>) <span class="cm"># __bool__</span>

<span class="cm"># Iteration (__iter__)</span>
<span class="kw">for</span> rec <span class="kw">in</span> batch1:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  iterating: </span><span class="st">{</span>rec<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Arithmetic (__add__)</span>
combined <span class="op">=</span> batch1 <span class="op">+</span> batch2
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">combined: </span><span class="st">{</span>combined<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Sorting (__lt__)</span>
batches <span class="op">=</span> [combined, batch2, batch1]
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">sorted sizes: </span><span class="st">{</span>[<span class="nb">len</span>(b) <span class="kw">for</span> b <span class="kw">in</span> <span class="nb">sorted</span>(batches)]<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Callable (__call__)</span>
upper_batch <span class="op">=</span> DataBatch(<span class="st">&quot;</span><span class="st">names</span><span class="st">&quot;</span>, [<span class="st">&quot;</span><span class="st">alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">bob</span><span class="st">&quot;</span>])
result <span class="op">=</span> upper_batch(<span class="nb">str</span><span class="op">.</span>upper)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">callable result: </span><span class="st">{</span><span class="nb">list</span>(result)<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Context manager (__enter__ / __exit__)</span>
<span class="kw">with</span> batch1 <span class="kw">as</span> b:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  working with </span><span class="st">{</span><span class="nb">len</span>(b)<span class="st">}</span><span class="st"> records</span><span class="st">&quot;</span>)
</code></pre>
    <pre><code><span class="cm"># Other important dunders — quick reference</span>

<span class="kw">class</span> <span class="fn">SmartRecord</span>:
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="nb">self</span>, data):
        <span class="nb">self</span><span class="op">.</span>_data <span class="op">=</span> data

    <span class="cm"># Attribute access</span>
    <span class="kw">def</span> <span class="fn">__getattr__</span>(<span class="nb">self</span>, name):
        <span class="st">&quot;&quot;&quot;Called when normal attribute lookup fails.&quot;&quot;&quot;</span>
        <span class="kw">return</span> <span class="nb">self</span><span class="op">.</span>_data<span class="op">.</span>get(name, <span class="st">f</span><span class="st">&quot;</span><span class="st">&lt;no </span><span class="st">{</span>name<span class="st">}</span><span class="st">&gt;</span><span class="st">&quot;</span>)

    <span class="cm"># Dict-like access</span>
    <span class="kw">def</span> <span class="fn">__setitem__</span>(<span class="nb">self</span>, key, value):
        <span class="nb">self</span><span class="op">.</span>_data[key] <span class="op">=</span> value

    <span class="kw">def</span> <span class="fn">__delitem__</span>(<span class="nb">self</span>, key):
        <span class="kw">del</span> <span class="nb">self</span><span class="op">.</span>_data[key]

    <span class="cm"># Format</span>
    <span class="kw">def</span> <span class="fn">__format__</span>(<span class="nb">self</span>, spec):
        <span class="st">&quot;&quot;&quot;Called by f-strings and format().&quot;&quot;&quot;</span>
        <span class="kw">if</span> spec <span class="op">==</span> <span class="st">&quot;</span><span class="st">short</span><span class="st">&quot;</span>:
            <span class="kw">return</span> <span class="nb">str</span>(<span class="nb">list</span>(<span class="nb">self</span><span class="op">.</span>_data<span class="op">.</span>keys()))
        <span class="kw">return</span> <span class="nb">str</span>(<span class="nb">self</span><span class="op">.</span>_data)

    <span class="kw">def</span> <span class="fn">__sizeof__</span>(<span class="nb">self</span>):
        <span class="st">&quot;&quot;&quot;Called by sys.getsizeof().&quot;&quot;&quot;</span>
        <span class="kw">import</span> sys
        <span class="kw">return</span> sys<span class="op">.</span>getsizeof(<span class="nb">self</span><span class="op">.</span>_data)

r <span class="op">=</span> SmartRecord({<span class="st">&quot;</span><span class="st">name</span><span class="st">&quot;</span>: <span class="st">&quot;</span><span class="st">Alice</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">age</span><span class="st">&quot;</span>: <span class="num">30</span>})
<span class="nb">print</span>(r<span class="op">.</span>name)              <span class="cm"># __getattr__ → &quot;Alice&quot;</span>
<span class="nb">print</span>(r<span class="op">.</span>email)             <span class="cm"># __getattr__ → &quot;&lt;no email&gt;&quot;</span>
r[<span class="st">&quot;</span><span class="st">city</span><span class="st">&quot;</span>] <span class="op">=</span> <span class="st">&quot;</span><span class="st">NYC</span><span class="st">&quot;</span>          <span class="cm"># __setitem__</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>r<span class="st">:</span><span class="st">short</span><span class="st">}</span><span class="st">&quot;</span>)        <span class="cm"># __format__</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">{</span>r<span class="st">}</span><span class="st">&quot;</span>)              <span class="cm"># __format__ (default)</span>

<span class="cm"># __slots__ — memory optimization (no __dict__)</span>
<span class="kw">class</span> <span class="fn">OptimizedRecord</span>:
    __slots__ <span class="op">=</span> [<span class="st">&quot;</span><span class="st">id</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">value</span><span class="st">&quot;</span>]  <span class="cm"># only these attributes allowed</span>
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="nb">self</span>, <span class="nb">id</span>, value):
        <span class="nb">self</span><span class="op">.</span>id <span class="op">=</span> <span class="nb">id</span>
        <span class="nb">self</span><span class="op">.</span>value <span class="op">=</span> value

rec <span class="op">=</span> OptimizedRecord(<span class="num">1</span>, <span class="num">42</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">slots: id=</span><span class="st">{</span>rec<span class="op">.</span>id<span class="st">}</span><span class="st">, value=</span><span class="st">{</span>rec<span class="op">.</span>value<span class="st">}</span><span class="st">&quot;</span>)
<span class="kw">try</span>:
    rec<span class="op">.</span>extra <span class="op">=</span> <span class="st">&quot;</span><span class="st">nope</span><span class="st">&quot;</span>
<span class="kw">except</span> <span class="nb">AttributeError</span> <span class="kw">as</span> e:
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">__slots__ prevents: </span><span class="st">{</span>e<span class="st">}</span><span class="st">&quot;</span>)
</code></pre>
  </div>
</div>

<div class="section-divider" id="common-python-interview-questions-data-engineering" data-section="common-python-interview-questions-data-engineering">
  <h2>Common Python Interview Questions (Data Engineering)</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--purple-dim);color:var(--purple)">Interview</span>
</div>

<div class="card wide" data-tags="common python interview questions (data engineering)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">Iq</div>
    <h3>Common Python Interview Questions (Data Engineering)</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <pre><code><span class="cm"># === Q1: Difference between list, tuple, and set? ===</span>
<span class="cm"># List: ordered, mutable, allows duplicates, uses []</span>
<span class="cm"># Tuple: ordered, immutable, allows duplicates, uses ()</span>
<span class="cm"># Set: unordered, mutable, NO duplicates, uses {}</span>

lst <span class="op">=</span> [<span class="num">1</span>, <span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>]      <span class="cm"># duplicates OK</span>
tup <span class="op">=</span> (<span class="num">1</span>, <span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>)      <span class="cm"># duplicates OK, immutable</span>
st  <span class="op">=</span> {<span class="num">1</span>, <span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>}      <span class="cm"># duplicates removed → {1, 2, 3}</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">list=</span><span class="st">{</span>lst<span class="st">}</span><span class="st">, tuple=</span><span class="st">{</span>tup<span class="st">}</span><span class="st">, set=</span><span class="st">{</span>st<span class="st">}</span><span class="st">&quot;</span>)


<span class="cm"># === Q2: Deep copy vs shallow copy ===</span>
<span class="kw">import</span> copy
original <span class="op">=</span> [[<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>]]
shallow <span class="op">=</span> copy<span class="op">.</span>copy(original)       <span class="cm"># new list, same inner lists</span>
deep <span class="op">=</span> copy<span class="op">.</span>deepcopy(original)      <span class="cm"># new list, new inner lists</span>

original[<span class="num">0</span>]<span class="op">.</span>append(<span class="num">99</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">original: </span><span class="st">{</span>original<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">shallow (affected): </span><span class="st">{</span>shallow<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">deep (not affected): </span><span class="st">{</span>deep<span class="st">}</span><span class="st">&quot;</span>)


<span class="cm"># === Q3: What is a generator? Why use it? ===</span>
<span class="cm"># Generators yield values lazily — one at a time — saving memory.</span>
<span class="cm"># Critical for processing large files/streams that don&#x27;t fit in memory.</span>
<span class="kw">def</span> <span class="fn">read_large_file</span>(lines):
    <span class="kw">for</span> line <span class="kw">in</span> lines:
        <span class="kw">yield</span> line<span class="op">.</span>strip()<span class="op">.</span>upper()

data <span class="op">=</span> [<span class="st">&quot;</span><span class="st">  hello  </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">  world  </span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">  python  </span><span class="st">&quot;</span>]
<span class="kw">for</span> processed <span class="kw">in</span> read_large_file(data):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  gen: </span><span class="st">{</span>processed<span class="st">}</span><span class="st">&quot;</span>)

<span class="cm"># Memory comparison</span>
<span class="kw">import</span> sys
list_comp <span class="op">=</span> [x<span class="op">*</span><span class="op">*</span><span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="nb">range</span>(<span class="num">10000</span>)]
gen_exp   <span class="op">=</span> (x<span class="op">*</span><span class="op">*</span><span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="nb">range</span>(<span class="num">10000</span>))
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">list size: </span><span class="st">{</span>sys<span class="op">.</span>getsizeof(list_comp)<span class="st">:</span><span class="st">,</span><span class="st">}</span><span class="st"> bytes</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">gen size:  </span><span class="st">{</span>sys<span class="op">.</span>getsizeof(gen_exp)<span class="st">:</span><span class="st">,</span><span class="st">}</span><span class="st"> bytes</span><span class="st">&quot;</span>)


<span class="cm"># === Q4: *args vs **kwargs ===</span>
<span class="kw">def</span> <span class="fn">example</span>(<span class="op">*</span>args, <span class="op">*</span><span class="op">*</span>kwargs):
    <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">positional: </span><span class="st">{</span>args<span class="st">}</span><span class="st">, keyword: </span><span class="st">{</span>kwargs<span class="st">}</span><span class="st">&quot;</span>)

example(<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, x<span class="op">=</span><span class="num">10</span>, y<span class="op">=</span><span class="num">20</span>)

<span class="cm"># Unpacking into function calls</span>
<span class="kw">def</span> <span class="fn">add</span>(a, b, c):
    <span class="kw">return</span> a <span class="op">+</span> b <span class="op">+</span> c

<span class="nb">print</span>(add(<span class="op">*</span>[<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>]))           <span class="cm"># unpack list</span>
<span class="nb">print</span>(add(<span class="op">*</span><span class="op">*</span>{<span class="st">&quot;</span><span class="st">a</span><span class="st">&quot;</span>: <span class="num">1</span>, <span class="st">&quot;</span><span class="st">b</span><span class="st">&quot;</span>: <span class="num">2</span>, <span class="st">&quot;</span><span class="st">c</span><span class="st">&quot;</span>: <span class="num">3</span>}))  <span class="cm"># unpack dict</span>


<span class="cm"># === Q5: GIL (Global Interpreter Lock) ===</span>
<span class="cm"># The GIL allows only one thread to execute Python bytecode at a time.</span>
<span class="cm"># Impact: threading does NOT speed up CPU-bound work.</span>
<span class="cm"># Solutions:</span>
<span class="cm">#   - CPU-bound → use multiprocessing (separate processes, separate GILs)</span>
<span class="cm">#   - I/O-bound → threading or asyncio works fine (GIL released during I/O)</span>
<span class="nb">print</span>(<span class="st">&quot;</span><span class="st">GIL: use multiprocessing for CPU, threading/asyncio for I/O</span><span class="st">&quot;</span>)


<span class="cm"># === Q6: Mutable default argument trap ===</span>
<span class="kw">def</span> <span class="fn">bad_append</span>(item, lst<span class="op">=</span>[]):     <span class="cm"># BUG: default list shared across calls!</span>
    lst<span class="op">.</span>append(item)
    <span class="kw">return</span> lst

<span class="nb">print</span>(bad_append(<span class="num">1</span>))  <span class="cm"># [1]</span>
<span class="nb">print</span>(bad_append(<span class="num">2</span>))  <span class="cm"># [1, 2] — unexpected!</span>

<span class="kw">def</span> <span class="fn">good_append</span>(item, lst<span class="op">=</span><span class="kw">None</span>):  <span class="cm"># FIX: use None as sentinel</span>
    lst <span class="op">=</span> lst <span class="kw">or</span> []
    lst<span class="op">.</span>append(item)
    <span class="kw">return</span> lst

<span class="nb">print</span>(good_append(<span class="num">1</span>))  <span class="cm"># [1]</span>
<span class="nb">print</span>(good_append(<span class="num">2</span>))  <span class="cm"># [2] — correct!</span>


<span class="cm"># === Q7: What does `if __name__ == &quot;__main__&quot;` do? ===</span>
<span class="cm"># It ensures code runs only when the file is executed directly,</span>
<span class="cm"># not when imported as a module.</span>
<span class="cm"># __name__ == &quot;__main__&quot; when running the script directly</span>
<span class="cm"># __name__ == &quot;module_name&quot; when imported</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">__name__ = </span><span class="st">{</span>__name__<span class="st">}</span><span class="st">&quot;</span>)


<span class="cm"># === Q8: How do you handle large datasets in Python? ===</span>
<span class="cm"># 1. Generators / iterators — process row by row</span>
<span class="cm"># 2. pandas chunked reading — pd.read_csv(..., chunksize=10000)</span>
<span class="cm"># 3. Use columnar formats — Parquet, ORC (read only needed columns)</span>
<span class="cm"># 4. Use Dask or PySpark for distributed processing</span>
<span class="cm"># 5. Optimize dtypes — category, int32 vs int64</span>
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np
df <span class="op">=</span> pd<span class="op">.</span>DataFrame({<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>: np<span class="op">.</span>random<span class="op">.</span>choice([<span class="st">&quot;</span><span class="st">A</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">B</span><span class="st">&quot;</span>, <span class="st">&quot;</span><span class="st">C</span><span class="st">&quot;</span>], <span class="num">10000</span>)})
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">object dtype:   </span><span class="st">{</span>df[<span class="st">&#x27;</span><span class="st">status</span><span class="st">&#x27;</span>]<span class="op">.</span>memory_usage(deep<span class="op">=</span><span class="kw">True</span>)<span class="st">:</span><span class="st">,</span><span class="st">}</span><span class="st"> bytes</span><span class="st">&quot;</span>)
df[<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;</span><span class="st">status</span><span class="st">&quot;</span>]<span class="op">.</span>astype(<span class="st">&quot;</span><span class="st">category</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">category dtype: </span><span class="st">{</span>df[<span class="st">&#x27;</span><span class="st">status</span><span class="st">&#x27;</span>]<span class="op">.</span>memory_usage(deep<span class="op">=</span><span class="kw">True</span>)<span class="st">:</span><span class="st">,</span><span class="st">}</span><span class="st"> bytes</span><span class="st">&quot;</span>)


<span class="cm"># === Q9: Difference between == and &#x27;is&#x27;? ===</span>
a <span class="op">=</span> [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>]
b <span class="op">=</span> [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>]
c <span class="op">=</span> a
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">a == b: </span><span class="st">{</span>a <span class="op">==</span> b<span class="st">}</span><span class="st">&quot;</span>)   <span class="cm"># True — same VALUE</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">a is b: </span><span class="st">{</span>a <span class="kw">is</span> b<span class="st">}</span><span class="st">&quot;</span>)   <span class="cm"># False — different OBJECTS</span>
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">a is c: </span><span class="st">{</span>a <span class="kw">is</span> c<span class="st">}</span><span class="st">&quot;</span>)   <span class="cm"># True — same object (alias)</span>
<span class="cm"># Use &#x27;is&#x27; only for None, True, False: `if x is None`</span>


<span class="cm"># === Q10: What are decorators? ===</span>
<span class="cm"># A decorator wraps a function to add behavior without modifying its code.</span>
<span class="kw">import</span> time
<span class="kw">from</span> functools <span class="kw">import</span> wraps

<span class="kw">def</span> <span class="fn">log_calls</span>(func):
    <span class="dc">@wraps</span>(func)  <span class="cm"># preserves original function&#x27;s name &amp; docstring</span>
    <span class="kw">def</span> <span class="fn">wrapper</span>(<span class="op">*</span>args, <span class="op">*</span><span class="op">*</span>kwargs):
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  Calling </span><span class="st">{</span>func<span class="op">.</span>__name__<span class="st">}</span><span class="st">&quot;</span>)
        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">*</span><span class="op">*</span>kwargs)
        <span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">  </span><span class="st">{</span>func<span class="op">.</span>__name__<span class="st">}</span><span class="st"> returned </span><span class="st">{</span>result<span class="st">}</span><span class="st">&quot;</span>)
        <span class="kw">return</span> result
    <span class="kw">return</span> wrapper

<span class="dc">@log_calls</span>
<span class="kw">def</span> <span class="fn">multiply</span>(a, b):
    <span class="st">&quot;&quot;&quot;Multiply two numbers.&quot;&quot;&quot;</span>
    <span class="kw">return</span> a <span class="op">*</span> b

<span class="nb">print</span>(multiply(<span class="num">3</span>, <span class="num">4</span>))
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">name preserved: </span><span class="st">{</span>multiply<span class="op">.</span>__name__<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">docstring preserved: </span><span class="st">{</span>multiply<span class="op">.</span>__doc__<span class="st">}</span><span class="st">&quot;</span>)


<span class="cm"># === Q11: List comprehension vs map/filter ===</span>
nums <span class="op">=</span> [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>]

<span class="cm"># Comprehension (preferred — more Pythonic &amp; readable)</span>
squares <span class="op">=</span> [x<span class="op">*</span><span class="op">*</span><span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> nums <span class="kw">if</span> x <span class="op">&gt;</span> <span class="num">2</span>]

<span class="cm"># map/filter equivalent</span>
squares2 <span class="op">=</span> <span class="nb">list</span>(<span class="nb">map</span>(<span class="kw">lambda</span> x: x<span class="op">*</span><span class="op">*</span><span class="num">2</span>, <span class="nb">filter</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="num">2</span>, nums)))

<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">comprehension: </span><span class="st">{</span>squares<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">map/filter:    </span><span class="st">{</span>squares2<span class="st">}</span><span class="st">&quot;</span>)


<span class="cm"># === Q12: Explain Python&#x27;s method resolution order (MRO) ===</span>
<span class="kw">class</span> <span class="fn">A</span>:
    <span class="kw">def</span> <span class="fn">who</span>(<span class="nb">self</span>): <span class="kw">return</span> <span class="st">&quot;</span><span class="st">A</span><span class="st">&quot;</span>

<span class="kw">class</span> <span class="fn">B</span>(A):
    <span class="kw">def</span> <span class="fn">who</span>(<span class="nb">self</span>): <span class="kw">return</span> <span class="st">&quot;</span><span class="st">B</span><span class="st">&quot;</span>

<span class="kw">class</span> <span class="fn">C</span>(A):
    <span class="kw">def</span> <span class="fn">who</span>(<span class="nb">self</span>): <span class="kw">return</span> <span class="st">&quot;</span><span class="st">C</span><span class="st">&quot;</span>

<span class="kw">class</span> <span class="fn">D</span>(B, C):
    <span class="kw">pass</span>

d <span class="op">=</span> D()
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">MRO: </span><span class="st">{</span>[<span class="nb">cls</span><span class="op">.</span>__name__ <span class="kw">for</span> <span class="nb">cls</span> <span class="kw">in</span> D<span class="op">.</span>__mro__]<span class="st">}</span><span class="st">&quot;</span>)
<span class="nb">print</span>(<span class="st">f</span><span class="st">&quot;</span><span class="st">d.who() = </span><span class="st">{</span>d<span class="op">.</span>who()<span class="st">}</span><span class="st">&quot;</span>)  <span class="cm"># &quot;B&quot; — follows MRO: D → B → C → A</span>
</code></pre>
  </div>
</div>

<div class="section-divider" id="quick-reference-table" data-section="quick-reference-table">
  <h2>Quick Reference Table</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--red-dim);color:var(--red)">Reference</span>
</div>

<div class="card wide" data-tags="quick reference table">
  <div class="card-head">
    <div class="card-icon" style="background:var(--red-dim);color:var(--red)">Rf</div>
    <h3>Quick Reference Table</h3>
    <span class="card-tag">Jupyter &#10003;</span>
  </div>
  <div class="card-body">
    <table><thead><tr><th>Operation</th><th>Syntax</th><th>Note</th></tr></thead><tbody><tr><td>Virtual env</td><td><code class="inline">python -m venv .venv && source .venv/bin/activate</code></td><td>Isolate deps</td></tr><tr><td>Install pkg</td><td><code class="inline">pip install -r requirements.txt</code></td><td>Pin versions</td></tr><tr><td>Debugger</td><td><code class="inline">breakpoint()</code></td><td>Built-in (3.7+)</td></tr><tr><td>Profile</td><td><code class="inline">python -m cProfile -s cumtime script.py</code></td><td>Find bottlenecks</td></tr><tr><td>Type check</td><td><code class="inline">mypy script.py</code></td><td>Static analysis</td></tr><tr><td>Format</td><td><code class="inline">black . && ruff check .</code></td><td>Auto-format & lint</td></tr><tr><td>Docker run</td><td><code class="inline">docker build -t etl . && docker run etl</code></td><td>Containerize</td></tr><tr><td>Env vars</td><td><code class="inline">export DB_HOST=localhost</code></td><td>Set for session</td></tr><tr><td>Parquet</td><td><code class="inline">df.to_parquet("f.parquet", compression="snappy")</code></td><td>Columnar storage</td></tr><tr><td>JSONL</td><td><code class="inline">df.to_json("f.jsonl", orient="records", lines=True)</code></td><td>Line-delimited</td></tr></tbody></table>
    <p class="card-text"><em>Python Cheatsheet — Developer & Data Engineering Edition — Jupyter-Ready ✅</em></p>
  </div>
</div>
</div>
<script>
const input=document.getElementById('search'),cards=document.querySelectorAll('.card'),dividers=document.querySelectorAll('.section-divider');
input.addEventListener('input',()=>{const q=input.value.toLowerCase().trim();cards.forEach(c=>{const t=(c.dataset.tags||'').toLowerCase(),x=c.textContent.toLowerCase();c.classList.toggle('hidden',q&&!t.includes(q)&&!x.includes(q))});dividers.forEach(d=>{let n=d.nextElementSibling,v=false;while(n&&!n.classList.contains('section-divider')){if(n.classList.contains('card')&&!n.classList.contains('hidden'))v=true;n=n.nextElementSibling}d.classList.toggle('hidden',!v)});});
const secs=document.querySelectorAll('.section-divider[id]'),navs=document.querySelectorAll('.nav a');
secs.forEach(s=>new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting){navs.forEach(a=>a.classList.remove('active'));const l=document.querySelector('.nav a[href="#'+e.target.id+'"]');if(l)l.classList.add('active')}})},{rootMargin:'-100px 0px -70% 0px'}).observe(s));
</script>
</body></html>