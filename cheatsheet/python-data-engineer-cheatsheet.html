<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Python Cheatsheet — Developer & Data Engineer</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=Newsreader:ital,wght@0,400;0,600;1,400&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--bg:#111214;--bg2:#18191d;--surface:#1e2025;--surface2:#252830;--border:#2e3039;--border2:#3a3d48;--text:#b8bcc8;--text-dim:#6c7086;--heading:#e8eaf0;--white:#f4f5f7;--amber:#f5a623;--amber-dim:rgba(245,166,35,0.12);--green:#50d890;--green-dim:rgba(80,216,144,0.10);--blue:#5b9cf5;--blue-dim:rgba(91,156,245,0.10);--pink:#e878a0;--pink-dim:rgba(232,120,160,0.10);--cyan:#56d4c8;--cyan-dim:rgba(86,212,200,0.10);--red:#f06868;--red-dim:rgba(240,104,104,0.12);--purple:#a78bfa;--purple-dim:rgba(167,139,250,0.10);--code-bg:#14151a;--radius:10px;--radius-lg:14px}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
.header{padding:48px 32px 32px;text-align:center;position:relative;border-bottom:1px solid var(--border)}.header::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 50% 70% at 50% 0%,rgba(245,166,35,0.06),transparent),radial-gradient(ellipse 30% 50% at 75% 10%,rgba(80,216,144,0.04),transparent);pointer-events:none}.header h1{font-family:'Newsreader',serif;font-size:clamp(2.2rem,4.5vw,3.6rem);color:var(--heading);letter-spacing:-0.03em;position:relative}.header h1 em{font-style:italic;color:var(--amber);font-weight:400}.header p{font-size:0.95rem;color:var(--text-dim);margin-top:6px;position:relative}.header .jupyter-badge{display:inline-block;background:var(--green-dim);color:var(--green);font-size:0.75rem;font-weight:700;padding:4px 12px;border-radius:999px;margin-top:10px;letter-spacing:0.05em}
.search-wrap{max-width:480px;margin:20px auto 0;position:relative}.search-wrap input{width:100%;padding:10px 16px 10px 40px;background:var(--surface);border:1px solid var(--border);border-radius:999px;color:var(--heading);font-family:'Outfit',sans-serif;font-size:0.88rem;outline:none;transition:border-color .2s}.search-wrap input:focus{border-color:var(--amber)}.search-wrap input::placeholder{color:var(--text-dim)}.search-wrap svg{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:var(--text-dim);width:16px;height:16px}
.nav{display:flex;justify-content:center;flex-wrap:wrap;gap:6px;padding:16px 24px;position:sticky;top:0;z-index:100;background:rgba(17,18,20,0.88);backdrop-filter:blur(14px);border-bottom:1px solid var(--border)}.nav a{font-size:0.72rem;font-weight:600;text-transform:uppercase;letter-spacing:0.07em;padding:5px 12px;border-radius:999px;text-decoration:none;color:var(--text-dim);border:1px solid transparent;transition:all .2s;white-space:nowrap}.nav a:hover,.nav a.active{color:var(--amber);border-color:rgba(245,166,35,0.3);background:var(--amber-dim)}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(420px,1fr));gap:18px;padding:28px 24px 80px;max-width:1520px;margin:0 auto}
.section-divider{grid-column:1/-1;display:flex;align-items:center;gap:14px;padding:24px 0 4px}.section-divider h2{font-family:'Newsreader',serif;font-size:1.6rem;color:var(--heading);white-space:nowrap;font-weight:600;letter-spacing:-0.02em}.section-divider .line{flex:1;height:1px;background:linear-gradient(90deg,var(--border),transparent)}.section-divider .badge{font-size:0.62rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;padding:3px 10px;border-radius:6px;white-space:nowrap}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;transition:border-color .25s,transform .2s,box-shadow .25s;animation:cardIn .45s ease both}.card:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,0.25)}@keyframes cardIn{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}.card.wide{grid-column:span 2}
.card-head{display:flex;align-items:center;gap:10px;padding:16px 18px 10px}.card-icon{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-family:'IBM Plex Mono',monospace;font-size:0.7rem;font-weight:600;flex-shrink:0}.card-head h3{font-family:'Outfit',sans-serif;font-size:0.9rem;font-weight:700;color:var(--heading);letter-spacing:-0.01em}.card-tag{margin-left:auto;font-size:0.6rem;font-weight:700;text-transform:uppercase;letter-spacing:.08em;padding:3px 8px;border-radius:5px;background:var(--green-dim);color:var(--green)}.card-body{padding:0 18px 18px}
pre{background:var(--code-bg);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px;overflow-x:auto;margin:6px 0;font-size:0.76rem;line-height:1.75}code{font-family:'IBM Plex Mono',monospace;font-size:inherit}pre code{color:var(--text)}
.kw{color:var(--purple)}.fn{color:var(--green)}.st{color:var(--amber)}.cm{color:var(--text-dim);font-style:italic}.nb{color:var(--cyan)}.op{color:var(--pink)}.num{color:var(--blue)}.dc{color:var(--pink)}
@media(max-width:880px){.grid{grid-template-columns:1fr;padding:18px 12px 60px}.card.wide{grid-column:span 1}.header{padding:32px 16px 24px}.nav{gap:4px;padding:12px 10px}}
.card.hidden{display:none}.section-divider.hidden{display:none}
</style>
</head>
<body>
<div class="header">
  <h1>Python <em>Cheatsheet</em></h1>
  <p>Essential reference for Python developers &amp; data engineers</p>
  <div class="jupyter-badge">✅ JUPYTER-READY — Every cell runs standalone</div>
  <div class="search-wrap">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
    <input type="text" id="search" placeholder="Search topics…" autocomplete="off">
  </div>
</div>
<nav class="nav" id="nav"><a href="#core-python">Core</a>
<a href="#strings">Strings</a>
<a href="#data-structures">Structures</a>
<a href="#functions">Functions</a>
<a href="#comprehensions">Comprehensions</a>
<a href="#object-oriented-programming">OOP</a>
<a href="#file-io-and-serialization">File I/O</a>
<a href="#error-handling-and-logging">Errors</a>
<a href="#sql-and-databases">SQL</a>
<a href="#pandas-for-data-engineering">Pandas</a>
<a href="#etl-patterns">ETL</a>
<a href="#cloud-and-object-storage-simulated">Cloud</a>
<a href="#api-interaction-simulated">API</a>
<a href="#concurrency-and-parallelism">Concurrency</a>
<a href="#data-validation-and-quality">Validation</a>
<a href="#environment-and-configuration">Config</a>
<a href="#tuples">Tuples</a>
<a href="#dunder-methods">Dunders</a>
<a href="#interview-questions">Interview</a>
<a href="#pro-tips-and-patterns">Tips</a></nav>
<div class="grid" id="grid">
<div class="section-divider" id="core-python" data-section="core-python">
  <h2>Core Python</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Fundamentals</span>
</div>

<div class="card " data-tags="variables & data types">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Va</div>
    <h3>Variables &amp; Data Types</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Dynamic typing</span>
x = <span <span class="kw">class</span>="num">10</span>              <span <span class="kw">class</span>="cm"># <span class="fn">int</span></span>
pi = <span <span class="kw">class</span>="num">3.14</span>           <span <span class="kw">class</span>="cm"># <span class="fn">float</span></span>
name = <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>      <span <span class="kw">class</span>="cm"># <span class="fn">str</span></span>
active = <span class="kw">True</span>       <span <span class="kw">class</span>="cm"># bool</span>
nothing = <span class="kw">None</span>      <span <span class="kw">class</span>="cm"># NoneType</span>
raw = b<span <span class="kw">class</span>="st">&quot;bytes&quot;</span>      <span <span class="kw">class</span>="cm"># bytes</span>

<span <span class="kw">class</span>="cm"># Type checking &amp; conversion</span>
<span class="fn">print</span>(<span class="fn">type</span>(x))              <span <span class="kw">class</span>="cm"># &lt;<span class="kw">class</span> <span <span class="kw">class</span>="st">&#x27;<span class="fn">int</span>&#x27;</span>&gt;</span>
<span class="fn">print</span>(<span class="fn">isinstance</span>(x, <span class="fn">int</span>))   <span <span class="kw">class</span>="cm"># <span class="kw">True</span></span>
<span class="fn">print</span>(<span class="fn">int</span>(<span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">42</span>&quot;</span>))             <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="num">42</span></span>
<span class="fn">print</span>(<span class="fn">str</span>(<span <span class="kw">class</span>="num">3.14</span>))             <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">3.14</span>&quot;</span></span>
<span class="fn">print</span>(<span class="fn">float</span>(<span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2.7</span>&quot;</span>))          <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="num">2.7</span></span>

<span <span class="kw">class</span>="cm"># Multiple assignment &amp; swap</span>
a, b, c = <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>
a, b = b, a
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;a={a}, b={b}, c={c}&quot;</span>)</code></pre>
  </div>
</div>

<div class="card wide" data-tags="control flow">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Co</div>
    <h3>Control Flow</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code>x = <span <span class="kw">class</span>="num">10</span>
d = {<span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;age&quot;</span>: <span <span class="kw">class</span>="num">30</span>, <span <span class="kw">class</span>="st">&quot;city&quot;</span>: <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>}

<span <span class="kw">class</span>="cm"># Conditionals</span>
<span class="kw">if</span> x &gt; <span <span class="kw">class</span>="num">0</span>:
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;positive&quot;</span>)
<span class="kw">elif</span> x == <span <span class="kw">class</span>="num">0</span>:
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;zero&quot;</span>)
<span class="kw">else</span>:
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;negative&quot;</span>)

<span <span class="kw">class</span>="cm"># Ternary</span>
label = <span <span class="kw">class</span>="st">&quot;even&quot;</span> <span class="kw">if</span> x % <span <span class="kw">class</span>="num">2</span> == <span <span class="kw">class</span>="num">0</span> <span class="kw">else</span> <span <span class="kw">class</span>="st">&quot;odd&quot;</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;x={x} <span class="kw">is</span> {label}&quot;</span>)

<span <span class="kw">class</span>="cm"># Loops</span>
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">5</span>):
    <span class="fn">print</span>(i, end=<span <span class="kw">class</span>="st">&quot; &quot;</span>)
<span class="fn">print</span>()

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">10</span>, <span <span class="kw">class</span>="num">2</span>):
    <span class="fn">print</span>(i, end=<span <span class="kw">class</span>="st">&quot; &quot;</span>)
<span class="fn">print</span>()

<span class="kw">for</span> k, v <span class="kw">in</span> d.items():
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;{k}: {v}&quot;</span>)

<span <span class="kw">class</span>="cm"># Match statement (<span <span class="kw">class</span>="num">3.10</span>+)</span>
status_code = <span <span class="kw">class</span>="num">200</span>
<span class="kw">match</span> status_code:
    <span class="kw">case</span> <span <span class="kw">class</span>="num">200</span>:
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;OK&quot;</span>)
    <span class="kw">case</span> <span <span class="kw">class</span>="num">404</span>:
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;Not Found&quot;</span>)
    <span class="kw">case</span> _:
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;Other&quot;</span>)</code></pre>
  </div>
</div>

<div class="section-divider" id="strings" data-section="strings">
  <h2>Strings</h2>
  <div class="line"></div>
  
</div>

<div class="card " data-tags="strings">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">St</div>
    <h3>Strings</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code>s = <span <span class="kw">class</span>="st">&quot;Hello, World!&quot;</span>

<span <span class="kw">class</span>="cm"># Slicing</span>
<span class="fn">print</span>(s[<span <span class="kw">class</span>="num">0</span>:<span <span class="kw">class</span>="num">5</span>])         <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;Hello&quot;</span></span>
<span class="fn">print</span>(s[::-<span <span class="kw">class</span>="num">1</span>])        <span <span class="kw">class</span>="cm"># reversed</span>

<span <span class="kw">class</span>="cm"># Key methods</span>
<span class="fn">print</span>(s.lower())
<span class="fn">print</span>(s.upper())
<span class="fn">print</span>(s.strip())
<span class="fn">print</span>(s.split(<span <span class="kw">class</span>="st">&quot;,&quot;</span>))           <span <span class="kw">class</span>="cm"># [<span <span class="kw">class</span>="st">&quot;Hello&quot;</span>, <span <span class="kw">class</span>="st">&quot; World!&quot;</span>]</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;-&quot;</span>.join([<span <span class="kw">class</span>="st">&quot;a&quot;</span>,<span <span class="kw">class</span>="st">&quot;b&quot;</span>]))    <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;a-b&quot;</span></span>
<span class="fn">print</span>(s.replace(<span <span class="kw">class</span>="st">&quot;World&quot;</span>, <span <span class="kw">class</span>="st">&quot;Python&quot;</span>))
<span class="fn">print</span>(s.startswith(<span <span class="kw">class</span>="st">&quot;He&quot;</span>))     <span <span class="kw">class</span>="cm"># <span class="kw">True</span></span>
<span class="fn">print</span>(s.find(<span <span class="kw">class</span>="st">&quot;World&quot;</span>))        <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="num">7</span></span>
<span class="fn">print</span>(s.count(<span <span class="kw">class</span>="st">&quot;l&quot;</span>))           <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="num">3</span></span>
<span class="fn">print</span>(s.encode(<span <span class="kw">class</span>="st">&quot;utf-<span <span class="kw">class</span>="num">8</span>&quot;</span>))      <span <span class="kw">class</span>="cm"># bytes — important <span class="kw">for</span> pipelines</span>

<span <span class="kw">class</span>="cm"># f-strings (<span <span class="kw">class</span>="num">3.6</span>+)</span>
name, age = <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="num">30</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;{name} <span class="kw">is</span> {age} years old&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;{<span <span class="kw">class</span>="num">3.14159</span>:.2f}&quot;</span>)       <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">3.14</span>&quot;</span></span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;{<span <span class="kw">class</span>="num">1000000</span>:,}&quot;</span>)         <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">1</span>,<span <span class="kw">class</span>="num">000</span>,<span <span class="kw">class</span>="num">000</span>&quot;</span></span>
x = <span <span class="kw">class</span>="num">42</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;{x = }&quot;</span>)              <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;x = <span <span class="kw">class</span>="num">42</span>&quot;</span> (<span <span class="kw">class</span>="num">3.8</span>+)</span>

<span <span class="kw">class</span>="cm"># Raw strings (regex &amp; Windows paths)</span>
path = <span <span class="kw">class</span>="st">r&quot;C:\data\files\output&quot;</span>
pattern = <span <span class="kw">class</span>="st">r&quot;\d{<span <span class="kw">class</span>="num">4</span>}-\d{<span <span class="kw">class</span>="num">2</span>}-\d{<span <span class="kw">class</span>="num">2</span>}&quot;</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;path: {path}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;pattern: {pattern}&quot;</span>)</code></pre>
  </div>
</div>

<div class="section-divider" id="data-structures" data-section="data-structures">
  <h2>Data Structures</h2>
  <div class="line"></div>
  
</div>

<div class="card " data-tags="lists">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Li</div>
    <h3>Lists</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code>lst = [<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>, <span <span class="kw">class</span>="num">5</span>]

<span <span class="kw">class</span>="cm"># CRUD</span>
lst.append(<span <span class="kw">class</span>="num">6</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;append:&quot;</span>, lst)
lst.insert(<span <span class="kw">class</span>="num">0</span>, <span <span class="kw">class</span>="num">0</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;insert:&quot;</span>, lst)
lst.extend([<span <span class="kw">class</span>="num">7</span>, <span <span class="kw">class</span>="num">8</span>])
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;extend:&quot;</span>, lst)

popped = lst.pop()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;pop: {popped}, <span class="fn">list</span>: {lst}&quot;</span>)
lst.remove(<span <span class="kw">class</span>="num">3</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;remove <span <span class="kw">class</span>="num">3</span>:&quot;</span>, lst)

<span <span class="kw">class</span>="cm"># Searching &amp; Sorting</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="num">4</span> <span class="kw">in</span> lst)
lst.sort(key=<span class="kw">lambda</span> x: -x)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;desc <span class="fn">sorted</span>:&quot;</span>, lst)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;<span class="fn">sorted</span> copy:&quot;</span>, <span class="fn">sorted</span>(lst))

<span <span class="kw">class</span>="cm"># Slicing</span>
lst = [<span <span class="kw">class</span>="num">10</span>, <span <span class="kw">class</span>="num">20</span>, <span <span class="kw">class</span>="num">30</span>, <span <span class="kw">class</span>="num">40</span>, <span <span class="kw">class</span>="num">50</span>]
<span class="fn">print</span>(lst[<span <span class="kw">class</span>="num">1</span>:<span <span class="kw">class</span>="num">4</span>])     <span <span class="kw">class</span>="cm"># [<span <span class="kw">class</span>="num">20</span>,<span <span class="kw">class</span>="num">30</span>,<span <span class="kw">class</span>="num">40</span>]</span>
<span class="fn">print</span>(lst[::<span <span class="kw">class</span>="num">2</span>])     <span <span class="kw">class</span>="cm"># every 2nd</span>
<span class="fn">print</span>(lst[::-<span <span class="kw">class</span>="num">1</span>])    <span <span class="kw">class</span>="cm"># reversed</span>

<span <span class="kw">class</span>="cm"># Unpacking</span>
first, *rest = lst
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;first={first}, rest={rest}&quot;</span>)</code></pre>
  </div>
</div>

<div class="card wide" data-tags="dictionaries, sets & tuples">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Di</div>
    <h3>Dictionaries, Sets &amp; Tuples</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Dictionary</span>
d = {<span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;age&quot;</span>: <span <span class="kw">class</span>="num">30</span>}
<span class="fn">print</span>(d[<span <span class="kw">class</span>="st">&quot;name&quot;</span>])
<span class="fn">print</span>(d.get(<span <span class="kw">class</span>="st">&quot;email&quot;</span>, <span <span class="kw">class</span>="st">&quot;N/A&quot;</span>))   <span <span class="kw">class</span>="cm"># safe access</span>

d[<span <span class="kw">class</span>="st">&quot;city&quot;</span>] = <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>
d.update({<span <span class="kw">class</span>="st">&quot;age&quot;</span>: <span <span class="kw">class</span>="num">31</span>})
merged = d | {<span <span class="kw">class</span>="st">&quot;x&quot;</span>: <span <span class="kw">class</span>="num">1</span>}          <span <span class="kw">class</span>="cm"># merge (<span <span class="kw">class</span>="num">3.9</span>+)</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;merged:&quot;</span>, merged)

d.setdefault(<span <span class="kw">class</span>="st">&quot;tags&quot;</span>, [])
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;setdefault:&quot;</span>, d)

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;keys:&quot;</span>, <span class="fn">list</span>(d.keys()))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;values:&quot;</span>, <span class="fn">list</span>(d.values()))

<span <span class="kw">class</span>="cm"># defaultdict — no KeyError</span>
<span class="kw">from</span> collections <span class="kw">import</span> defaultdict, OrderedDict
dd = defaultdict(<span class="fn">list</span>)
dd[<span <span class="kw">class</span>="st">&quot;fruits&quot;</span>].append(<span <span class="kw">class</span>="st">&quot;apple&quot;</span>)
dd[<span <span class="kw">class</span>="st">&quot;fruits&quot;</span>].append(<span <span class="kw">class</span>="st">&quot;banana&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;defaultdict:&quot;</span>, <span class="fn">dict</span>(dd))

<span <span class="kw">class</span>="cm"># Sets — deduplication &amp; lookups</span>
s1 = {<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>}
s2 = {<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>, <span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">6</span>}
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;intersection:&quot;</span>, s1 &amp; s2)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;union:&quot;</span>, s1 | s2)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;difference:&quot;</span>, s1 - s2)

<span <span class="kw">class</span>="cm"># Tuples &amp; Named tuples</span>
t = (<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;a&quot;</span>, <span <span class="kw">class</span>="num">3.14</span>)
x, y, z = t
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;unpacked: x={x}, y={y}, z={z}&quot;</span>)

<span class="kw">from</span> collections <span class="kw">import</span> namedtuple
Record = namedtuple(<span <span class="kw">class</span>="st">&quot;Record&quot;</span>, [<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>, <span <span class="kw">class</span>="st">&quot;value&quot;</span>])
r = Record(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;sensor_a&quot;</span>, <span <span class="kw">class</span>="num">42.5</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;namedtuple: {r.name} = {r.value}&quot;</span>)</code></pre>
  </div>
</div>


<div class="section-divider" id="tuples" data-section="tuples">
  <h2>Tuples</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--cyan-dim);color:var(--cyan)">Immutable</span>
</div>

<div class="card wide" data-tags="tuples immutable sequences namedtuple">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">Tu</div>
    <h3>Tuples — Immutable Sequences</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Creating tuples</span>
t = (<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>)
single = (<span class="num">42</span>,)            <span <span class="kw">class</span>="cm"># trailing comma required <span class="kw">for</span> single-element tuple</span>
empty = ()
from_list = <span class="fn">tuple</span>([<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>])

<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;tuple: {t}, single: {single}, empty: {empty}&quot;</span>)

<span <span class="kw">class</span>="cm"># Indexing &amp; slicing (same <span class="kw">as</span> lists)</span>
<span class="fn">print</span>(t[<span class="num">0</span>])       <span <span class="kw">class</span>="cm"># <span class="num">1</span></span>
<span class="fn">print</span>(t[-<span class="num">1</span>])      <span <span class="kw">class</span>="cm"># <span class="num">5</span></span>
<span class="fn">print</span>(t[<span class="num">1</span>:<span class="num">4</span>])     <span <span class="kw">class</span>="cm"># (<span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>)</span>
<span class="fn">print</span>(t[::-<span class="num">1</span>])    <span <span class="kw">class</span>="cm"># (<span class="num">5</span>, <span class="num">4</span>, <span class="num">3</span>, <span class="num">2</span>, <span class="num">1</span>)</span>

<span <span class="kw">class</span>="cm"># Unpacking</span>
a, b, *rest = t
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;a={a}, b={b}, rest={rest}&quot;</span>)

<span <span class="kw">class</span>="cm"># Swap idiom uses tuples under the hood</span>
x, y = <span class="num">10</span>, <span class="num">20</span>
x, y = y, x
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;swapped: x={x}, y={y}&quot;</span>)

<span <span class="kw">class</span>="cm"># Tuple methods (only <span class="num">2</span>!)</span>
<span class="fn">print</span>(t.count(<span class="num">3</span>))   <span <span class="kw">class</span>="cm"># <span class="num">1</span></span>
<span class="fn">print</span>(t.index(<span class="num">4</span>))   <span <span class="kw">class</span>="cm"># <span class="num">3</span></span>

<span <span class="kw">class</span>="cm"># Tuples <span class="kw">as</span> dict keys (immutable = hashable)</span>
location_cache = {(<span class="num">40.7</span>, -<span class="num">74.0</span>): <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, (<span class="num">34.1</span>, -<span class="num">118.2</span>): <span <span class="kw">class</span>="st">&quot;LA&quot;</span>}
<span class="fn">print</span>(location_cache[(<span class="num">40.7</span>, -<span class="num">74.0</span>)])

<span <span class="kw">class</span>="cm"># Tuples <span class="kw">as</span> <span class="kw">return</span> values</span>
<span class="kw">def</span> min_max(data):
    <span class="kw">return</span> <span class="fn">min</span>(data), <span class="fn">max</span>(data)

lo, hi = min_max([<span class="num">5</span>, <span class="num">2</span>, <span class="num">8</span>, <span class="num">1</span>, <span class="num">9</span>])
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;min={lo}, max={hi}&quot;</span>)

<span <span class="kw">class</span>="cm"># Immutability</span>
<span class="kw">try</span>:
    t[<span class="num">0</span>] = <span class="num">99</span>
<span class="kw">except</span> TypeError <span class="kw">as</span> e:
    <span class="fn">print</span>(f&quot;Can&<span <span class="kw">class</span>="cm">#x27;t mutate tuple: {e}<span <span class="kw">class</span>="st">&quot;)</span>

<span <span class="kw">class</span>="cm"># Nested tuples (inner mutables CAN change)</span>
nested = ([<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>])
nested[<span class="num">0</span>].append(<span class="num">99</span>)
<span class="fn">print</span>(f&quot;</span>nested <span class="kw">with</span> mutated inner list: {nested}<span <span class="kw">class</span>="st">&quot;)

<span <span class="kw">class</span>="cm"># Named tuples</span>
<span class="kw">from</span> collections <span class="kw">import</span> namedtuple
Record = namedtuple(&quot;</span>Record<span <span class="kw">class</span>="st">&quot;, [&quot;</span>id<span <span class="kw">class</span>="st">&quot;, &quot;</span>name<span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;])
r = Record(<span class="num">1</span>, &quot;</span>sensor_a<span <span class="kw">class</span>="st">&quot;, <span class="num">42.5</span>)
<span class="fn">print</span>(f&quot;</span>namedtuple: {r.name} = {r.value}<span <span class="kw">class</span>="st">&quot;)
<span class="fn">print</span>(f&quot;</span><span class="kw">as</span> dict: {r._asdict()}<span <span class="kw">class</span>="st">&quot;)

<span <span class="kw">class</span>="cm"># typing.NamedTuple (modern alternative)</span>
<span class="kw">from</span> typing <span class="kw">import</span> NamedTuple

<span class="kw">class</span> PipelineResult(NamedTuple):
    rows_processed: int
    errors: int
    duration_sec: float

result = PipelineResult(<span class="num">1500</span>, <span class="num">3</span>, <span class="num">12.5</span>)
<span class="fn">print</span>(f&quot;</span>result: {result}, rows={result.rows_processed}&quot;)</code></pre>
  </div>
</div>

<div class="section-divider" id="functions" data-section="functions">
  <h2>Functions</h2>
  <div class="line"></div>
  
</div>

<div class="card wide" data-tags="functions & lambdas">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">Fu</div>
    <h3>Functions &amp; Lambdas</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Standard function</span>
<span class="kw">def</span> transform(record, mapping=<span class="kw">None</span>):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Transform a single record.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    mapping = mapping <span class="kw">or</span> {}
    <span class="kw">return</span> {mapping.get(k, k): v <span class="kw">for</span> k, v <span class="kw">in</span> record.items()}

raw = {<span <span class="kw">class</span>="st">&quot;First Name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Last Name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Smith&quot;</span>}
mapping = {<span <span class="kw">class</span>="st">&quot;First Name&quot;</span>: <span <span class="kw">class</span>="st">&quot;first_name&quot;</span>, <span <span class="kw">class</span>="st">&quot;Last Name&quot;</span>: <span <span class="kw">class</span>="st">&quot;last_name&quot;</span>}
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;transformed:&quot;</span>, transform(raw, mapping))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;no mapping:&quot;</span>, transform(raw))

<span <span class="kw">class</span>="cm"># *args <span class="kw">and</span> **kwargs</span>
<span class="kw">def</span> flexible(*args, **kwargs):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;args:&quot;</span>, args)
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;kwargs:&quot;</span>, kwargs)

flexible(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>, x=<span <span class="kw">class</span>="num">10</span>, y=<span <span class="kw">class</span>="num">20</span>)

<span <span class="kw">class</span>="cm"># Lambda &amp; higher-order functions</span>
square = <span class="kw">lambda</span> x: x ** <span <span class="kw">class</span>="num">2</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;square(<span <span class="kw">class</span>="num">5</span>) = {square(<span <span class="kw">class</span>="num">5</span>)}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;<span class="fn">map</span>:&quot;</span>, <span class="fn">list</span>(<span class="fn">map</span>(<span class="kw">lambda</span> x: x*<span <span class="kw">class</span>="num">2</span>, [<span <span class="kw">class</span>="num">1</span>,<span <span class="kw">class</span>="num">2</span>,<span <span class="kw">class</span>="num">3</span>])))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;<span class="fn">filter</span>:&quot;</span>, <span class="fn">list</span>(<span class="fn">filter</span>(<span class="kw">lambda</span> x: x&gt;<span <span class="kw">class</span>="num">2</span>, [<span <span class="kw">class</span>="num">1</span>,<span <span class="kw">class</span>="num">2</span>,<span <span class="kw">class</span>="num">3</span>,<span <span class="kw">class</span>="num">4</span>,<span <span class="kw">class</span>="num">5</span>])))

<span class="kw">from</span> functools <span class="kw">import</span> reduce
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;reduce:&quot;</span>, reduce(<span class="kw">lambda</span> a, b: a+b, [<span <span class="kw">class</span>="num">1</span>,<span <span class="kw">class</span>="num">2</span>,<span <span class="kw">class</span>="num">3</span>,<span <span class="kw">class</span>="num">4</span>]))  <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="num">10</span></span>

<span <span class="kw">class</span>="cm"># Type hints</span>
<span class="kw">from</span> typing <span class="kw">import</span> Optional

<span class="kw">def</span> process(data: <span class="fn">list</span>[<span class="fn">dict</span>]) -&gt; <span class="fn">list</span>[<span class="fn">dict</span>]:
    <span class="kw">return</span> [{<span <span class="kw">class</span>="st">&quot;key&quot;</span>: d.get(<span <span class="kw">class</span>="st">&quot;key&quot;</span>, <span <span class="kw">class</span>="st">&quot;&quot;</span>).lower()} <span class="kw">for</span> d <span class="kw">in</span> data]

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;typed:&quot;</span>, process([{<span <span class="kw">class</span>="st">&quot;key&quot;</span>: <span <span class="kw">class</span>="st">&quot;HELLO&quot;</span>}, {<span <span class="kw">class</span>="st">&quot;key&quot;</span>: <span <span class="kw">class</span>="st">&quot;WORLD&quot;</span>}]))</code></pre>
  </div>
</div>

<div class="card wide" data-tags="decorators & generators">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">De</div>
    <h3>Decorators &amp; Generators</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> time
<span class="kw">from</span> functools <span class="kw">import</span> wraps

<span <span class="kw">class</span>="cm"># Retry decorator (common <span class="kw">in</span> pipelines)</span>
<span class="kw">def</span> retry(max_retries=<span <span class="kw">class</span>="num">3</span>, delay=<span <span class="kw">class</span>="num">0.01</span>):
    <span class="kw">def</span> decorator(func):
        <span class="dc">@wraps</span>(func)
        <span class="kw">def</span> wrapper(*args, **kwargs):
            <span class="kw">for</span> attempt <span class="kw">in</span> <span class="fn">range</span>(max_retries):
                <span class="kw">try</span>:
                    <span class="kw">return</span> func(*args, **kwargs)
                <span class="kw">except</span> Exception <span class="kw">as</span> e:
                    <span class="kw">if</span> attempt == max_retries - <span <span class="kw">class</span>="num">1</span>:
                        <span class="kw">raise</span>
                    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Retry {attempt+<span <span class="kw">class</span>="num">1</span>}/{max_retries}: {e}&quot;</span>)
                    time.sleep(delay * (<span <span class="kw">class</span>="num">2</span> ** attempt))
        <span class="kw">return</span> wrapper
    <span class="kw">return</span> decorator

call_count = <span <span class="kw">class</span>="num">0</span>

<span class="dc">@retry</span>(max_retries=<span <span class="kw">class</span>="num">3</span>, delay=<span <span class="kw">class</span>="num">0.01</span>)
<span class="kw">def</span> flaky_function():
    <span class="kw">global</span> call_count
    call_count += <span <span class="kw">class</span>="num">1</span>
    <span class="kw">if</span> call_count &lt; <span <span class="kw">class</span>="num">3</span>:
        <span class="kw">raise</span> ConnectionError(<span <span class="kw">class</span>="st">&quot;Simulated failure&quot;</span>)
    <span class="kw">return</span> <span <span class="kw">class</span>="st">&quot;Success!&quot;</span>

call_count = <span <span class="kw">class</span>="num">0</span>
<span class="fn">print</span>(flaky_function())

<span <span class="kw">class</span>="cm"># Generator — memory-efficient streaming</span>
<span class="kw">def</span> read_in_chunks(data, chunk_size=<span <span class="kw">class</span>="num">3</span>):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Simulate reading data <span class="kw">in</span> chunks.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">0</span>, <span class="fn">len</span>(data), chunk_size):
        <span class="kw">yield</span> data[i:i+chunk_size]

big_data = <span class="fn">list</span>(<span class="fn">range</span>(<span <span class="kw">class</span>="num">10</span>))
<span class="kw">for</span> chunk <span class="kw">in</span> read_in_chunks(big_data, chunk_size=<span <span class="kw">class</span>="num">3</span>):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Processing chunk: {chunk}&quot;</span>)

<span <span class="kw">class</span>="cm"># Generator pipeline (lazy, composable)</span>
raw_lines = [<span <span class="kw">class</span>="st">&quot;  Alice,<span <span class="kw">class</span>="num">30</span>,NYC  &quot;</span>, <span <span class="kw">class</span>="st">&quot;  Bob,<span <span class="kw">class</span>="num">25</span>,LA  &quot;</span>, <span <span class="kw">class</span>="st">&quot;  ,invalid,  &quot;</span>, <span <span class="kw">class</span>="st">&quot;  Charlie,<span <span class="kw">class</span>="num">35</span>,SF  &quot;</span>]
lines   = (line.strip() <span class="kw">for</span> line <span class="kw">in</span> raw_lines)
rows    = (line.split(<span <span class="kw">class</span>="st">&quot;,&quot;</span>) <span class="kw">for</span> line <span class="kw">in</span> lines)
cleaned = [row <span class="kw">for</span> row <span class="kw">in</span> rows <span class="kw">if</span> <span class="fn">len</span>(row) == <span <span class="kw">class</span>="num">3</span> <span class="kw">and</span> row[<span <span class="kw">class</span>="num">0</span>]]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;cleaned rows:&quot;</span>, cleaned)</code></pre>
  </div>
</div>

<div class="section-divider" id="comprehensions" data-section="comprehensions">
  <h2>Comprehensions</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--green-dim);color:var(--green)">Pythonic</span>
</div>

<div class="card wide" data-tags="comprehensions">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Co</div>
    <h3>Comprehensions</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># List comprehension</span>
squares = [x**<span <span class="kw">class</span>="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">10</span>)]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;squares:&quot;</span>, squares)

evens = [x <span class="kw">for</span> x <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">20</span>) <span class="kw">if</span> x % <span <span class="kw">class</span>="num">2</span> == <span <span class="kw">class</span>="num">0</span>]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;evens:&quot;</span>, evens)

<span <span class="kw">class</span>="cm"># Nested — flatten</span>
matrix = [[<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>], [<span <span class="kw">class</span>="num">4</span>, <span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">6</span>], [<span <span class="kw">class</span>="num">7</span>, <span <span class="kw">class</span>="num">8</span>, <span <span class="kw">class</span>="num">9</span>]]
flat = [x <span class="kw">for</span> row <span class="kw">in</span> matrix <span class="kw">for</span> x <span class="kw">in</span> row]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;flat:&quot;</span>, flat)

<span <span class="kw">class</span>="cm"># Dict comprehension — column renaming</span>
raw_columns = [<span <span class="kw">class</span>="st">&quot;First Name&quot;</span>, <span <span class="kw">class</span>="st">&quot;Last Name&quot;</span>, <span <span class="kw">class</span>="st">&quot;Phone Number&quot;</span>]
column_map = {col: col.lower().replace(<span <span class="kw">class</span>="st">&quot; &quot;</span>, <span <span class="kw">class</span>="st">&quot;_&quot;</span>) <span class="kw">for</span> col <span class="kw">in</span> raw_columns}
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;column_map:&quot;</span>, column_map)

<span <span class="kw">class</span>="cm"># Set comprehension</span>
data = {<span <span class="kw">class</span>="st">&quot;a&quot;</span>: <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;b&quot;</span>: <span <span class="kw">class</span>="st">&quot;hello&quot;</span>, <span <span class="kw">class</span>="st">&quot;c&quot;</span>: <span <span class="kw">class</span>="num">3.14</span>, <span <span class="kw">class</span>="st">&quot;d&quot;</span>: <span class="kw">True</span>, <span <span class="kw">class</span>="st">&quot;e&quot;</span>: [<span <span class="kw">class</span>="num">1</span>,<span <span class="kw">class</span>="num">2</span>]}
unique_types = {<span class="fn">type</span>(v).__name__ <span class="kw">for</span> v <span class="kw">in</span> data.values()}
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;unique_types:&quot;</span>, unique_types)

<span <span class="kw">class</span>="cm"># Conditional expression</span>
records = [<span <span class="kw">class</span>="num">10</span>, -<span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">20</span>, -<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">15</span>]
labels = [<span <span class="kw">class</span>="st">&quot;valid&quot;</span> <span class="kw">if</span> x &gt;= <span <span class="kw">class</span>="num">0</span> <span class="kw">else</span> <span <span class="kw">class</span>="st">&quot;invalid&quot;</span> <span class="kw">for</span> x <span class="kw">in</span> records]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;labels:&quot;</span>, labels)

<span <span class="kw">class</span>="cm"># Walrus operator (<span <span class="kw">class</span>="num">3.8</span>+)</span>
data = [<span <span class="kw">class</span>="num">1</span>, -<span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>, -<span <span class="kw">class</span>="num">4</span>, <span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">0</span>]
<span class="kw">def</span> clean(x):
    <span class="kw">return</span> x * <span <span class="kw">class</span>="num">10</span> <span class="kw">if</span> x &gt; <span <span class="kw">class</span>="num">0</span> <span class="kw">else</span> <span class="kw">None</span>

results = [cleaned <span class="kw">for</span> x <span class="kw">in</span> data <span class="kw">if</span> (cleaned := clean(x)) <span class="kw">is</span> <span class="kw">not</span> <span class="kw">None</span>]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;walrus results:&quot;</span>, results)</code></pre>
  </div>
</div>

<div class="section-divider" id="object-oriented-programming" data-section="object-oriented-programming">
  <h2>Object-Oriented Programming</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--purple-dim);color:var(--purple)">OOP</span>
</div>

<div class="card wide" data-tags="object-oriented programming">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">Ob</div>
    <h3>Object-Oriented Programming</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass, field, asdict
<span class="kw">from</span> datetime <span class="kw">import</span> datetime
<span class="kw">from</span> abc <span class="kw">import</span> ABC, abstractmethod

<span <span class="kw">class</span>="cm"># Dataclass (<span <span class="kw">class</span>="num">3.7</span>+) — great <span class="kw">for</span> data models</span>
<span class="dc">@dataclass</span>
<span class="kw">class</span> PipelineConfig:
    source: <span class="fn">str</span>
    destination: <span class="fn">str</span>
    batch_size: <span class="fn">int</span> = <span <span class="kw">class</span>="num">1000</span>
    created_at: datetime = field(default_factory=datetime.now)
    tags: <span class="fn">list</span> = field(default_factory=<span class="fn">list</span>)

config = PipelineConfig(<span <span class="kw">class</span>="st">&quot;s3://<span class="fn">input</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;postgres://db&quot;</span>, tags=[<span <span class="kw">class</span>="st">&quot;etl&quot;</span>, <span <span class="kw">class</span>="st">&quot;daily&quot;</span>])
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;config:&quot;</span>, config)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;<span class="kw">as</span> <span class="fn">dict</span>:&quot;</span>, asdict(config))

<span <span class="kw">class</span>="cm"># Abstract base <span class="kw">class</span> — enforce interface</span>
<span class="kw">class</span> BaseExtractor(ABC):
    <span class="dc">@abstractmethod</span>
    <span class="kw">def</span> extract(self) -&gt; <span class="fn">list</span>[<span class="fn">dict</span>]:
        <span class="kw">pass</span>

<span class="kw">class</span> CSVExtractor(BaseExtractor):
    <span class="kw">def</span> __init__(self, data):
        self.data = data

    <span class="kw">def</span> extract(self) -&gt; <span class="fn">list</span>[<span class="fn">dict</span>]:
        <span class="kw">return</span> self.data

extractor = CSVExtractor([{<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;val&quot;</span>: <span <span class="kw">class</span>="num">10</span>}, {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="st">&quot;val&quot;</span>: <span <span class="kw">class</span>="num">20</span>}])
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;extracted:&quot;</span>, extractor.extract())

<span <span class="kw">class</span>="cm"># Verify abstract enforcement</span>
<span class="kw">try</span>:
    bad = BaseExtractor()
<span class="kw">except</span> TypeError <span class="kw">as</span> e:
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;Cannot instantiate ABC: {e}&quot;</span>)</code></pre>
  </div>
</div>

<div class="section-divider" id="file-i/o-and-serialization" data-section="file-i/o-and-serialization">
  <h2>File I/O & Serialization</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">I/O</span>
</div>

<div class="card wide" data-tags="file i/o & serialization">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Fi</div>
    <h3>File I/O &amp; Serialization</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> json
<span class="kw">import</span> csv
<span class="kw">import</span> os
<span class="kw">from</span> pathlib <span class="kw">import</span> Path

<span <span class="kw">class</span>="cm"># Write &amp; Read text</span>
<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.txt&quot;</span>, <span <span class="kw">class</span>="st">&quot;w&quot;</span>) <span class="kw">as</span> f:
    f.write(<span <span class="kw">class</span>="st">&quot;Line <span <span class="kw">class</span>="num">1</span>\nLine <span <span class="kw">class</span>="num">2</span>\nLine <span <span class="kw">class</span>="num">3</span>\n&quot;</span>)
<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.txt&quot;</span>) <span class="kw">as</span> f:
    content = f.read()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;text:&quot;</span>, <span class="fn">repr</span>(content))

<span <span class="kw">class</span>="cm"># Large file — line-by-line (memory safe)</span>
<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.txt&quot;</span>) <span class="kw">as</span> f:
    <span class="kw">for</span> line <span class="kw">in</span> f:
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  line: {line.strip()}&quot;</span>)

<span <span class="kw">class</span>="cm"># JSON</span>
data = {<span <span class="kw">class</span>="st">&quot;pipeline&quot;</span>: <span <span class="kw">class</span>="st">&quot;etl&quot;</span>, <span <span class="kw">class</span>="st">&quot;records&quot;</span>: <span <span class="kw">class</span>="num">1500</span>, <span <span class="kw">class</span>="st">&quot;success&quot;</span>: <span class="kw">True</span>}
json_str = json.dumps(data, indent=<span <span class="kw">class</span>="num">2</span>, default=<span class="fn">str</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\nJSON:&quot;</span>, json_str)
parsed = json.loads(json_str)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;parsed:&quot;</span>, parsed)

<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.json&quot;</span>, <span <span class="kw">class</span>="st">&quot;w&quot;</span>) <span class="kw">as</span> f:
    json.dump(data, f, indent=<span <span class="kw">class</span>="num">2</span>)
<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.json&quot;</span>) <span class="kw">as</span> f:
    loaded = json.load(f)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;loaded:&quot;</span>, loaded)

<span <span class="kw">class</span>="cm"># CSV</span>
rows = [{<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;score&quot;</span>: <span <span class="kw">class</span>="num">95</span>},
        {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;score&quot;</span>: <span <span class="kw">class</span>="num">87</span>}]
<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.csv&quot;</span>, <span <span class="kw">class</span>="st">&quot;w&quot;</span>, newline=<span <span class="kw">class</span>="st">&quot;&quot;</span>) <span class="kw">as</span> f:
    writer = csv.DictWriter(f, fieldnames=[<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>, <span <span class="kw">class</span>="st">&quot;score&quot;</span>])
    writer.writeheader()
    writer.writerows(rows)
<span class="kw">with</span> <span class="fn">open</span>(<span <span class="kw">class</span>="st">&quot;demo.csv&quot;</span>) <span class="kw">as</span> f:
    <span class="kw">for</span> row <span class="kw">in</span> csv.DictReader(f):
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  csv: {row}&quot;</span>)

<span <span class="kw">class</span>="cm"># pathlib — modern paths</span>
p = Path(<span <span class="kw">class</span>="st">&quot;demo.csv&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nexists: {p.exists()}, stem: {p.stem}, suffix: {p.suffix}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;glob:&quot;</span>, <span class="fn">list</span>(Path(<span <span class="kw">class</span>="st">&quot;.&quot;</span>).glob(<span <span class="kw">class</span>="st">&quot;demo*&quot;</span>)))

<span <span class="kw">class</span>="cm"># Cleanup</span>
<span class="kw">for</span> f <span class="kw">in</span> [<span <span class="kw">class</span>="st">&quot;demo.txt&quot;</span>, <span <span class="kw">class</span>="st">&quot;demo.json&quot;</span>, <span <span class="kw">class</span>="st">&quot;demo.csv&quot;</span>]:
    Path(f).unlink(missing_ok=<span class="kw">True</span>)</code></pre>
  </div>
</div>

<div class="section-divider" id="error-handling-and-logging" data-section="error-handling-and-logging">
  <h2>Error Handling & Logging</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--red-dim);color:var(--red)">Essential</span>
</div>

<div class="card wide" data-tags="error handling & logging">
  <div class="card-head">
    <div class="card-icon" style="background:var(--red-dim);color:var(--red)">Er</div>
    <h3>Error Handling &amp; Logging</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> json
<span class="kw">import</span> logging

<span <span class="kw">class</span>="cm"># === Exception Handling ===</span>
x = <span <span class="kw">class</span>="num">2</span>
raw = &<span <span class="kw">class</span>="cm">#x27;{<span <span class="kw">class</span>="st">&quot;key&quot;</span>: <span <span class="kw">class</span>="st">&quot;value&quot;</span>}&#x27;</span>

<span class="kw">try</span>:
    result = <span <span class="kw">class</span>="num">10</span> / x
    data = json.loads(raw)
<span class="kw">except</span> ZeroDivisionError:
    <span class="fn">print</span>(&quot;Can&<span <span class="kw">class</span>="cm">#x27;t divide by zero<span <span class="kw">class</span>="st">&quot;)</span>
<span class="kw">except</span> (ValueError, KeyError) <span class="kw">as</span> e:
    <span class="fn">print</span>(f&quot;</span>Error: {e}<span <span class="kw">class</span>="st">&quot;)
<span class="kw">except</span> Exception <span class="kw">as</span> e:
    <span class="fn">print</span>(f&quot;</span>Unexpected: {e}<span <span class="kw">class</span>="st">&quot;)
    <span class="kw">raise</span>
<span class="kw">else</span>:
    <span class="fn">print</span>(f&quot;</span>Success! result={result}, data={data}<span <span class="kw">class</span>="st">&quot;)
<span class="kw">finally</span>:
    <span class="fn">print</span>(&quot;</span>Finally always runs\n<span <span class="kw">class</span>="st">&quot;)

<span <span class="kw">class</span>="cm"># Custom pipeline exceptions</span>
<span class="kw">class</span> PipelineError(Exception):
    <span class="kw">def</span> __init__(self, stage, message):
        <span class="fn">super</span>().__init__(f&quot;</span>[{stage}] {message}<span <span class="kw">class</span>="st">&quot;)
        self.stage = stage

<span class="kw">class</span> ExtractionError(PipelineError): <span class="kw">pass</span>
<span class="kw">class</span> TransformError(PipelineError): <span class="kw">pass</span>

<span class="kw">try</span>:
    <span class="kw">raise</span> ExtractionError(&quot;</span>extract<span <span class="kw">class</span>="st">&quot;, &quot;</span>Connection refused<span <span class="kw">class</span>="st">&quot;)
<span class="kw">except</span> PipelineError <span class="kw">as</span> e:
    <span class="fn">print</span>(f&quot;</span>Caught: {e}, stage={e.stage}\n<span <span class="kw">class</span>="st">&quot;)

<span <span class="kw">class</span>="cm"># Context manager</span>
<span class="kw">from</span> contextlib <span class="kw">import</span> contextmanager

<span class="dc">@contextmanager</span>
<span class="kw">def</span> db_transaction(name):
    <span class="fn">print</span>(f&quot;</span>  BEGIN {name}<span <span class="kw">class</span>="st">&quot;)
    <span class="kw">try</span>:
        <span class="kw">yield</span> name
        <span class="fn">print</span>(f&quot;</span>  COMMIT {name}<span <span class="kw">class</span>="st">&quot;)
    <span class="kw">except</span> Exception:
        <span class="fn">print</span>(f&quot;</span>  ROLLBACK {name}<span <span class="kw">class</span>="st">&quot;)
        <span class="kw">raise</span>

<span class="kw">with</span> db_transaction(&quot;</span>insert_users<span <span class="kw">class</span>="st">&quot;) <span class="kw">as</span> tx:
    <span class="fn">print</span>(f&quot;</span>  Executing <span class="kw">in</span> {tx}<span <span class="kw">class</span>="st">&quot;)

<span <span class="kw">class</span>="cm"># === Logging ===</span>
logging.basicConfig(
    level=logging.INFO,
    <span class="fn">format</span>=&quot;</span>%(asctime)s | %(levelname)-8s | %(name)s | %(message)s<span <span class="kw">class</span>="st">&quot;,
    datefmt=&quot;</span>%H:%M:%S<span <span class="kw">class</span>="st">&quot;,
)
logger = logging.getLogger(&quot;</span>etl.demo<span <span class="kw">class</span>="st">&quot;)
logger.info(&quot;</span>Pipeline started, source=%s<span <span class="kw">class</span>="st">&quot;, &quot;</span>s3://bucket<span <span class="kw">class</span>="st">&quot;)
logger.warning(&quot;</span>Skipped %d malformed records<span <span class="kw">class</span>="st">&quot;, <span <span class="kw">class</span>="num">42</span>)
logger.info(&quot;</span>Pipeline complete&quot;)</code></pre>
  </div>
</div>

<div class="section-divider" id="sql-and-databases" data-section="sql-and-databases">
  <h2>SQL & Databases</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--green-dim);color:var(--green)">Data Eng</span>
</div>

<div class="card wide" data-tags="sqlite (built-in)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">SQ</div>
    <h3>SQLite (Built-in)</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> sqlite3

<span <span class="kw">class</span>="cm"># Create <span class="kw">in</span>-memory database</span>
conn = sqlite3.connect(<span <span class="kw">class</span>="st">&quot;:memory:&quot;</span>)
conn.row_factory = sqlite3.Row
cur = conn.cursor()

<span <span class="kw">class</span>="cm"># Create table</span>
cur.execute(<span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;
    CREATE TABLE events (
        <span class="fn">id</span> INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        value REAL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )
&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>)

<span <span class="kw">class</span>="cm"># Parameterized inserts (NEVER use f-strings <span class="kw">for</span> SQL!)</span>
cur.execute(<span <span class="kw">class</span>="st">&quot;INSERT INTO events (name, value) VALUES (?, ?)&quot;</span>, (<span <span class="kw">class</span>="st">&quot;temperature&quot;</span>, <span <span class="kw">class</span>="num">23.5</span>))
cur.execute(<span <span class="kw">class</span>="st">&quot;INSERT INTO events (name, value) VALUES (?, ?)&quot;</span>, (<span <span class="kw">class</span>="st">&quot;humidity&quot;</span>, <span <span class="kw">class</span>="num">65.2</span>))

<span <span class="kw">class</span>="cm"># Bulk insert</span>
batch = [(<span <span class="kw">class</span>="st">&quot;pressure&quot;</span>, <span <span class="kw">class</span>="num">1013.25</span>), (<span <span class="kw">class</span>="st">&quot;wind_speed&quot;</span>, <span <span class="kw">class</span>="num">12.3</span>), (<span <span class="kw">class</span>="st">&quot;temperature&quot;</span>, <span <span class="kw">class</span>="num">24.1</span>)]
cur.executemany(<span <span class="kw">class</span>="st">&quot;INSERT INTO events (name, value) VALUES (?, ?)&quot;</span>, batch)
conn.commit()

<span <span class="kw">class</span>="cm"># Query</span>
rows = cur.execute(&quot;SELECT * FROM events WHERE value &gt; ?<span <span class="kw">class</span>="st">&quot;, (<span <span class="kw">class</span>="num">20</span>,)).fetchall()
<span class="kw">for</span> row <span class="kw">in</span> rows:
    <span class="fn">print</span>(f&quot;</span>  <span class="fn">id</span>={row[&<span <span class="kw">class</span>="cm">#x27;<span class="fn">id</span><span <span class="kw">class</span>="st">&#x27;]}, name={row[&#x27;</span>name<span <span class="kw">class</span>="st">&#x27;]}, value={row[&#x27;</span>value&#x27;]}<span <span class="kw">class</span>="st">&quot;)</span>

<span class="fn">print</span>(f&quot;</span>\nTotal rows: {cur.execute(&<span <span class="kw">class</span>="cm">#x27;SELECT COUNT(*) FROM events&#x27;).fetchone()[<span <span class="kw">class</span>="num">0</span>]}<span <span class="kw">class</span>="st">&quot;)</span>

<span <span class="kw">class</span>="cm"># Aggregation</span>
<span class="kw">for</span> row <span class="kw">in</span> cur.execute(&quot;</span>SELECT name, AVG(value) <span class="kw">as</span> avg_val FROM events GROUP BY name<span <span class="kw">class</span>="st">&quot;):
    <span class="fn">print</span>(f&quot;</span>  {row[&<span <span class="kw">class</span>="cm">#x27;name<span <span class="kw">class</span>="st">&#x27;]}: avg={row[&#x27;</span>avg_val&#x27;]:.2f}&quot;)</span>

conn.close()</code></pre>
  </div>
</div>

<div class="card wide" data-tags="sqlite + pandas">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">SQ</div>
    <h3>SQLite + Pandas</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> sqlite3
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span <span class="kw">class</span>="cm"># Create demo database</span>
conn = sqlite3.connect(<span <span class="kw">class</span>="st">&quot;:memory:&quot;</span>)
np.random.seed(<span <span class="kw">class</span>="num">42</span>)

<span <span class="kw">class</span>="cm"># Create <span class="kw">and</span> populate tables</span>
df_users = pd.DataFrame({
    <span <span class="kw">class</span>="st">&quot;user_id&quot;</span>: <span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">6</span>),
    <span <span class="kw">class</span>="st">&quot;name&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>, <span <span class="kw">class</span>="st">&quot;Diana&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eve&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;city&quot;</span>: [<span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;Chicago&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>],
})
df_orders = pd.DataFrame({
    <span <span class="kw">class</span>="st">&quot;order_id&quot;</span>: <span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">11</span>),
    <span <span class="kw">class</span>="st">&quot;user_id&quot;</span>: np.random.choice(<span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">6</span>), <span <span class="kw">class</span>="num">10</span>),
    <span <span class="kw">class</span>="st">&quot;amount&quot;</span>: np.random.uniform(<span <span class="kw">class</span>="num">10</span>, <span <span class="kw">class</span>="num">500</span>, <span <span class="kw">class</span>="num">10</span>).<span class="fn">round</span>(<span <span class="kw">class</span>="num">2</span>),
    <span <span class="kw">class</span>="st">&quot;date&quot;</span>: pd.date_range(<span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">01</span>-<span <span class="kw">class</span>="num">01</span>&quot;</span>, periods=<span <span class="kw">class</span>="num">10</span>).astype(<span class="fn">str</span>),
})

df_users.to_sql(<span <span class="kw">class</span>="st">&quot;users&quot;</span>, conn, index=<span class="kw">False</span>)
df_orders.to_sql(<span <span class="kw">class</span>="st">&quot;orders&quot;</span>, conn, index=<span class="kw">False</span>)

<span <span class="kw">class</span>="cm"># Read <span class="kw">with</span> Pandas</span>
result = pd.read_sql(<span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;
    SELECT u.name, u.city, COUNT(o.order_id) <span class="kw">as</span> order_count, SUM(o.amount) <span class="kw">as</span> total
    FROM users u
    LEFT JOIN orders o ON u.user_id = o.user_id
    GROUP BY u.name, u.city
    ORDER BY total DESC
&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>, conn)
<span class="fn">print</span>(result)

<span <span class="kw">class</span>="cm"># Write processed data back to SQL</span>
result.to_sql(<span <span class="kw">class</span>="st">&quot;user_summary&quot;</span>, conn, index=<span class="kw">False</span>, if_exists=<span <span class="kw">class</span>="st">&quot;replace&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\nSaved summary back to DB:&quot;</span>)
<span class="fn">print</span>(pd.read_sql(<span <span class="kw">class</span>="st">&quot;SELECT * FROM user_summary&quot;</span>, conn))

conn.close()</code></pre>
  </div>
</div>

<div class="section-divider" id="pandas-for-data-engineering" data-section="pandas-for-data-engineering">
  <h2>Pandas for Data Engineering</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--blue-dim);color:var(--blue)">Data Eng</span>
</div>

<div class="card " data-tags="dataframes — create & inspect">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Da</div>
    <h3>DataFrames — Create &amp; Inspect</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span <span class="kw">class</span>="num">42</span>)
df = pd.DataFrame({
    <span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">8</span>),
    <span <span class="kw">class</span>="st">&quot;name&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>, <span <span class="kw">class</span>="st">&quot;Diana&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eve&quot;</span>, <span <span class="kw">class</span>="st">&quot;Frank&quot;</span>, <span <span class="kw">class</span>="st">&quot;Grace&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;age&quot;</span>: [<span <span class="kw">class</span>="num">30</span>, <span <span class="kw">class</span>="num">25</span>, <span <span class="kw">class</span>="num">35</span>, <span <span class="kw">class</span>="num">28</span>, <span <span class="kw">class</span>="num">32</span>, <span <span class="kw">class</span>="num">22</span>, <span <span class="kw">class</span>="num">45</span>],
    <span <span class="kw">class</span>="st">&quot;city&quot;</span>: [<span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;Chicago&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;Chicago&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;revenue&quot;</span>: np.random.uniform(<span <span class="kw">class</span>="num">500</span>, <span <span class="kw">class</span>="num">3000</span>, <span <span class="kw">class</span>="num">7</span>).<span class="fn">round</span>(<span <span class="kw">class</span>="num">2</span>),
    <span <span class="kw">class</span>="st">&quot;status&quot;</span>: [<span <span class="kw">class</span>="st">&quot;active&quot;</span>, <span <span class="kw">class</span>="st">&quot;active&quot;</span>, <span <span class="kw">class</span>="st">&quot;inactive&quot;</span>, <span <span class="kw">class</span>="st">&quot;active&quot;</span>, <span <span class="kw">class</span>="st">&quot;pending&quot;</span>, <span <span class="kw">class</span>="st">&quot;active&quot;</span>, <span <span class="kw">class</span>="st">&quot;active&quot;</span>],
})

<span class="fn">print</span>(df)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nShape: {df.shape}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nDtypes:\n{df.dtypes}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nInfo:&quot;</span>)
df.info()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nDescribe:\n{df.describe()}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nMemory usage:\n{df.memory_usage(deep=<span class="kw">True</span>)}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nNull counts:\n{df.isnull().<span class="fn">sum</span>()}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nUnique counts:\n{df.nunique()}&quot;</span>)</code></pre>
  </div>
</div>

<div class="card wide" data-tags="select, filter & transform">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Se</div>
    <h3>Select, Filter &amp; Transform</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span <span class="kw">class</span>="num">42</span>)
df = pd.DataFrame({
    <span <span class="kw">class</span>="st">&quot;name&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>, <span <span class="kw">class</span>="st">&quot;Diana&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eve&quot;</span>, <span <span class="kw">class</span>="st">&quot;Frank&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;age&quot;</span>: [<span <span class="kw">class</span>="num">30</span>, <span <span class="kw">class</span>="num">25</span>, <span <span class="kw">class</span>="num">35</span>, <span <span class="kw">class</span>="num">28</span>, <span <span class="kw">class</span>="num">32</span>, <span <span class="kw">class</span>="num">22</span>],
    <span <span class="kw">class</span>="st">&quot;city&quot;</span>: [<span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;Chicago&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;score&quot;</span>: [<span <span class="kw">class</span>="num">85.5</span>, <span <span class="kw">class</span>="num">92.3</span>, <span <span class="kw">class</span>="num">78.1</span>, <span <span class="kw">class</span>="num">95.0</span>, <span <span class="kw">class</span>="num">88.7</span>, <span <span class="kw">class</span>="num">70.2</span>],
    <span <span class="kw">class</span>="st">&quot;date_str&quot;</span>: [<span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">01</span>-<span <span class="kw">class</span>="num">15</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">02</span>-<span <span class="kw">class</span>="num">20</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">03</span>-<span <span class="kw">class</span>="num">10</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">04</span>-<span <span class="kw">class</span>="num">05</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">05</span>-<span <span class="kw">class</span>="num">12</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">06</span>-<span <span class="kw">class</span>="num">01</span>&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;raw_cat&quot;</span>: [<span <span class="kw">class</span>="st">&quot;A&quot;</span>, <span <span class="kw">class</span>="st">&quot;B&quot;</span>, <span <span class="kw">class</span>="st">&quot;A&quot;</span>, <span <span class="kw">class</span>="st">&quot;C&quot;</span>, <span <span class="kw">class</span>="st">&quot;B&quot;</span>, <span <span class="kw">class</span>="st">&quot;A&quot;</span>],
})

<span <span class="kw">class</span>="cm"># Selecting</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;Single column:\n&quot;</span>, df[<span <span class="kw">class</span>="st">&quot;name&quot;</span>].head(<span <span class="kw">class</span>="num">3</span>).to_list())
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;Multi column:\n&quot;</span>, df[[<span <span class="kw">class</span>="st">&quot;name&quot;</span>, <span <span class="kw">class</span>="st">&quot;age&quot;</span>]].head(<span <span class="kw">class</span>="num">3</span>))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;loc:\n&quot;</span>, df.loc[<span <span class="kw">class</span>="num">0</span>:<span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>])
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;iloc:\n&quot;</span>, df.iloc[<span <span class="kw">class</span>="num">0</span>:<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">0</span>:<span <span class="kw">class</span>="num">2</span>])

<span <span class="kw">class</span>="cm"># Filtering</span>
<span class="fn">print</span>(&quot;\nage &gt; <span <span class="kw">class</span>="num">28</span>:\n<span <span class="kw">class</span>="st">&quot;, df[df[&quot;</span>age&quot;] &gt; <span <span class="kw">class</span>="num">28</span>][<span <span class="kw">class</span>="st">&quot;name&quot;</span>].to_list())
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;isin:\n&quot;</span>, df[df[<span <span class="kw">class</span>="st">&quot;status&quot;</span> <span class="kw">if</span> <span <span class="kw">class</span>="st">&quot;status&quot;</span> <span class="kw">in</span> df.columns <span class="kw">else</span> <span <span class="kw">class</span>="st">&quot;city&quot;</span>].isin([<span <span class="kw">class</span>="st">&quot;NYC&quot;</span>])][<span <span class="kw">class</span>="st">&quot;name&quot;</span>].to_list())
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;query:\n&quot;</span>, df.query(&quot;age &gt; <span <span class="kw">class</span>="num">25</span> <span class="kw">and</span> city == &<span <span class="kw">class</span>="cm">#x27;NYC&#x27;<span <span class="kw">class</span>="st">&quot;)[[&quot;</span>name<span <span class="kw">class</span>="st">&quot;, &quot;</span>age<span <span class="kw">class</span>="st">&quot;]])</span>

<span <span class="kw">class</span>="cm"># Sorting</span>
<span class="fn">print</span>(&quot;</span>\nsorted by score desc:<span <span class="kw">class</span>="st">&quot;)
<span class="fn">print</span>(df.sort_values(&quot;</span>score<span <span class="kw">class</span>="st">&quot;, ascending=<span class="kw">False</span>)[[&quot;</span>name<span <span class="kw">class</span>="st">&quot;, &quot;</span>score<span <span class="kw">class</span>="st">&quot;]])
<span class="fn">print</span>(&quot;</span>\ntop <span <span class="kw">class</span>="num">3</span> scores:<span <span class="kw">class</span>="st">&quot;)
<span class="fn">print</span>(df.nlargest(<span <span class="kw">class</span>="num">3</span>, &quot;</span>score<span <span class="kw">class</span>="st">&quot;)[[&quot;</span>name<span <span class="kw">class</span>="st">&quot;, &quot;</span>score&quot;]])

<span <span class="kw">class</span>="cm"># New columns &amp; transforms</span>
df[<span <span class="kw">class</span>="st">&quot;name_lower&quot;</span>] = df[<span <span class="kw">class</span>="st">&quot;name&quot;</span>].<span class="fn">str</span>.lower().<span class="fn">str</span>.strip()
df[<span <span class="kw">class</span>="st">&quot;flag&quot;</span>] = np.where(df[<span <span class="kw">class</span>="st">&quot;score&quot;</span>] &gt; <span <span class="kw">class</span>="num">85</span>, <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">0</span>)
df[<span <span class="kw">class</span>="st">&quot;date&quot;</span>] = pd.to_datetime(df[<span <span class="kw">class</span>="st">&quot;date_str&quot;</span>])
df[<span <span class="kw">class</span>="st">&quot;year&quot;</span>] = df[<span <span class="kw">class</span>="st">&quot;date&quot;</span>].dt.year
df[<span <span class="kw">class</span>="st">&quot;month&quot;</span>] = df[<span <span class="kw">class</span>="st">&quot;date&quot;</span>].dt.month
df[<span <span class="kw">class</span>="st">&quot;category&quot;</span>] = df[<span <span class="kw">class</span>="st">&quot;raw_cat&quot;</span>].<span class="fn">map</span>({<span <span class="kw">class</span>="st">&quot;A&quot;</span>: <span <span class="kw">class</span>="st">&quot;alpha&quot;</span>, <span <span class="kw">class</span>="st">&quot;B&quot;</span>: <span <span class="kw">class</span>="st">&quot;beta&quot;</span>, <span <span class="kw">class</span>="st">&quot;C&quot;</span>: <span <span class="kw">class</span>="st">&quot;gamma&quot;</span>})

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\nTransformed:&quot;</span>)
<span class="fn">print</span>(df[[<span <span class="kw">class</span>="st">&quot;name_lower&quot;</span>, <span <span class="kw">class</span>="st">&quot;flag&quot;</span>, <span <span class="kw">class</span>="st">&quot;date&quot;</span>, <span <span class="kw">class</span>="st">&quot;year&quot;</span>, <span <span class="kw">class</span>="st">&quot;category&quot;</span>]])</code></pre>
  </div>
</div>

<div class="card wide" data-tags="groupby, merge, clean & export">
  <div class="card-head">
    <div class="card-icon" style="background:var(--blue-dim);color:var(--blue)">Gr</div>
    <h3>GroupBy, Merge, Clean &amp; Export</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span <span class="kw">class</span>="num">42</span>)
df = pd.DataFrame({
    <span <span class="kw">class</span>="st">&quot;name&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>, <span <span class="kw">class</span>="st">&quot;Diana&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eve&quot;</span>, <span <span class="kw">class</span>="st">&quot;Frank&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;city&quot;</span>: [<span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>, <span <span class="kw">class</span>="st">&quot;Chicago&quot;</span>, <span <span class="kw">class</span>="st">&quot;LA&quot;</span>, <span <span class="kw">class</span>="st">&quot;NYC&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;dept&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Eng&quot;</span>, <span <span class="kw">class</span>="st">&quot;Mkt&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eng&quot;</span>, <span <span class="kw">class</span>="st">&quot;Sales&quot;</span>, <span <span class="kw">class</span>="st">&quot;Mkt&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eng&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;revenue&quot;</span>: [<span <span class="kw">class</span>="num">1200</span>, <span <span class="kw">class</span>="num">1800</span>, <span <span class="kw">class</span>="num">950</span>, <span <span class="kw">class</span>="num">2100</span>, <span <span class="kw">class</span>="num">1600</span>, <span <span class="kw">class</span>="num">1100</span>],
    <span <span class="kw">class</span>="st">&quot;salary&quot;</span>: [<span <span class="kw">class</span>="num">90000</span>, <span <span class="kw">class</span>="num">75000</span>, <span <span class="kw">class</span>="num">95000</span>, <span <span class="kw">class</span>="num">80000</span>, <span <span class="kw">class</span>="num">72000</span>, <span <span class="kw">class</span>="num">88000</span>],
    <span <span class="kw">class</span>="st">&quot;region&quot;</span>: [<span <span class="kw">class</span>="st">&quot;East&quot;</span>, <span <span class="kw">class</span>="st">&quot;West&quot;</span>, <span <span class="kw">class</span>="st">&quot;East&quot;</span>, <span <span class="kw">class</span>="st">&quot;Central&quot;</span>, <span <span class="kw">class</span>="st">&quot;West&quot;</span>, <span <span class="kw">class</span>="st">&quot;East&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;quarter&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Q1&quot;</span>, <span <span class="kw">class</span>="st">&quot;Q1&quot;</span>, <span <span class="kw">class</span>="st">&quot;Q2&quot;</span>, <span <span class="kw">class</span>="st">&quot;Q2&quot;</span>, <span <span class="kw">class</span>="st">&quot;Q1&quot;</span>, <span <span class="kw">class</span>="st">&quot;Q2&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;sales&quot;</span>: [<span <span class="kw">class</span>="num">100</span>, <span <span class="kw">class</span>="num">150</span>, <span <span class="kw">class</span>="num">120</span>, <span <span class="kw">class</span>="num">200</span>, <span <span class="kw">class</span>="num">130</span>, <span <span class="kw">class</span>="num">110</span>],
})

<span <span class="kw">class</span>="cm"># GroupBy</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;=== GroupBy ===&quot;</span>)
<span class="fn">print</span>(df.groupby(<span <span class="kw">class</span>="st">&quot;city&quot;</span>)[<span <span class="kw">class</span>="st">&quot;revenue&quot;</span>].agg([<span <span class="kw">class</span>="st">&quot;<span class="fn">sum</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;mean&quot;</span>, <span <span class="kw">class</span>="st">&quot;count&quot;</span>]))

<span <span class="kw">class</span>="cm"># Transform (broadcast back)</span>
df[<span <span class="kw">class</span>="st">&quot;dept_avg_salary&quot;</span>] = df.groupby(<span <span class="kw">class</span>="st">&quot;dept&quot;</span>)[<span <span class="kw">class</span>="st">&quot;salary&quot;</span>].transform(<span <span class="kw">class</span>="st">&quot;mean&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\nTransform:\n&quot;</span>, df[[<span <span class="kw">class</span>="st">&quot;name&quot;</span>, <span <span class="kw">class</span>="st">&quot;dept&quot;</span>, <span <span class="kw">class</span>="st">&quot;salary&quot;</span>, <span <span class="kw">class</span>="st">&quot;dept_avg_salary&quot;</span>]])

<span <span class="kw">class</span>="cm"># Pivot table</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Pivot Table ===&quot;</span>)
<span class="fn">print</span>(pd.pivot_table(df, values=<span <span class="kw">class</span>="st">&quot;sales&quot;</span>, index=<span <span class="kw">class</span>="st">&quot;region&quot;</span>, columns=<span <span class="kw">class</span>="st">&quot;quarter&quot;</span>, aggfunc=<span <span class="kw">class</span>="st">&quot;<span class="fn">sum</span>&quot;</span>))

<span <span class="kw">class</span>="cm"># Merge / Join</span>
df1 = pd.DataFrame({<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: [<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>], <span <span class="kw">class</span>="st">&quot;name&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>]})
df2 = pd.DataFrame({<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: [<span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>], <span <span class="kw">class</span>="st">&quot;score&quot;</span>: [<span <span class="kw">class</span>="num">85</span>, <span <span class="kw">class</span>="num">92</span>, <span <span class="kw">class</span>="num">78</span>]})
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Merge (left) ===&quot;</span>)
<span class="fn">print</span>(pd.merge(df1, df2, on=<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>, how=<span <span class="kw">class</span>="st">&quot;left&quot;</span>))

<span <span class="kw">class</span>="cm"># Concat</span>
df_a = pd.DataFrame({<span <span class="kw">class</span>="st">&quot;x&quot;</span>: [<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>], <span <span class="kw">class</span>="st">&quot;y&quot;</span>: [<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>]})
df_b = pd.DataFrame({<span <span class="kw">class</span>="st">&quot;x&quot;</span>: [<span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">6</span>], <span <span class="kw">class</span>="st">&quot;y&quot;</span>: [<span <span class="kw">class</span>="num">7</span>, <span <span class="kw">class</span>="num">8</span>]})
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Concat ===&quot;</span>)
<span class="fn">print</span>(pd.concat([df_a, df_b], ignore_index=<span class="kw">True</span>))

<span <span class="kw">class</span>="cm"># Cleaning</span>
dirty = pd.DataFrame({
    <span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: [<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">4</span>],
    <span <span class="kw">class</span>="st">&quot;name&quot;</span>: [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span class="kw">None</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>, <span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Eve&quot;</span>],
    <span <span class="kw">class</span>="st">&quot;score&quot;</span>: [<span <span class="kw">class</span>="num">85</span>, <span <span class="kw">class</span>="num">92</span>, <span class="kw">None</span>, <span <span class="kw">class</span>="num">85</span>, <span <span class="kw">class</span>="num">78</span>],
})
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Cleaning ===&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;dropna:&quot;</span>, dirty.dropna(subset=[<span <span class="kw">class</span>="st">&quot;name&quot;</span>]).shape)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;fillna:\n&quot;</span>, dirty.fillna({<span <span class="kw">class</span>="st">&quot;score&quot;</span>: <span <span class="kw">class</span>="num">0</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;unknown&quot;</span>}))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;dedup:\n&quot;</span>, dirty.drop_duplicates(subset=[<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>], keep=<span <span class="kw">class</span>="st">&quot;last&quot;</span>))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;rename:\n&quot;</span>, dirty.rename(columns={<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="st">&quot;user_id&quot;</span>}).columns.tolist())

<span <span class="kw">class</span>="cm"># Chunked reading demo</span>
df.to_csv(<span <span class="kw">class</span>="st">&quot;demo_big.csv&quot;</span>, index=<span class="kw">False</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Chunked Reading ===&quot;</span>)
<span class="kw">for</span> i, chunk <span class="kw">in</span> <span class="fn">enumerate</span>(pd.read_csv(<span <span class="kw">class</span>="st">&quot;demo_big.csv&quot;</span>, chunksize=<span <span class="kw">class</span>="num">3</span>)):
    <span class="fn">print</span>(f&quot;  Chunk {i}: {<span class="fn">len</span>(chunk)} rows — {chunk[&<span <span class="kw">class</span>="cm">#x27;name&#x27;].tolist()}<span <span class="kw">class</span>="st">&quot;)</span>

<span <span class="kw">class</span>="cm"># Export formats</span>
df.to_csv(&quot;</span>demo_out.csv<span <span class="kw">class</span>="st">&quot;, index=<span class="kw">False</span>)
df.to_json(&quot;</span>demo_out.jsonl<span <span class="kw">class</span>="st">&quot;, orient=&quot;</span>records<span <span class="kw">class</span>="st">&quot;, lines=<span class="kw">True</span>)
<span class="fn">print</span>(&quot;</span>\nExported CSV <span class="kw">and</span> JSONL<span <span class="kw">class</span>="st">&quot;)

<span class="kw">import</span> os
<span class="kw">for</span> f <span class="kw">in</span> [&quot;</span>demo_big.csv<span <span class="kw">class</span>="st">&quot;, &quot;</span>demo_out.csv<span <span class="kw">class</span>="st">&quot;, &quot;</span>demo_out.jsonl&quot;]:
    os.remove(f)</code></pre>
  </div>
</div>

<div class="section-divider" id="etl-patterns" data-section="etl-patterns">
  <h2>ETL Patterns</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Pipeline</span>
</div>

<div class="card wide" data-tags="etl pipeline class">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">ET</div>
    <h3>ETL Pipeline Class</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> logging
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

logging.basicConfig(level=logging.INFO, <span class="fn">format</span>=<span <span class="kw">class</span>="st">&quot;%(asctime)s | %(message)s&quot;</span>, datefmt=<span <span class="kw">class</span>="st">&quot;%H:%M:%S&quot;</span>)
logger = logging.getLogger(<span <span class="kw">class</span>="st">&quot;etl&quot;</span>)

<span <span class="kw">class</span>="cm"># Sample source data</span>
SOURCE_DATA = [
    {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;  Alice &quot;</span>, <span <span class="kw">class</span>="st">&quot;value&quot;</span>: <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">100</span>&quot;</span>},
    {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;value&quot;</span>: <span <span class="kw">class</span>="st">&quot;invalid&quot;</span>},
    {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot; Charlie&quot;</span>, <span <span class="kw">class</span>="st">&quot;value&quot;</span>: <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">200</span>&quot;</span>},
    {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">4</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;&quot;</span>, <span <span class="kw">class</span>="st">&quot;value&quot;</span>: <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">150</span>&quot;</span>},
    {<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">&quot;Eve&quot;</span>, <span <span class="kw">class</span>="st">&quot;value&quot;</span>: <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">300</span>&quot;</span>},
]

LOADED_DATA = []  <span <span class="kw">class</span>="cm"># simulated destination</span>

<span class="kw">class</span> ETLPipeline:
    <span class="kw">def</span> __init__(self, config: <span class="fn">dict</span>):
        self.config = config
        self.stats = {<span <span class="kw">class</span>="st">&quot;extracted&quot;</span>: <span <span class="kw">class</span>="num">0</span>, <span <span class="kw">class</span>="st">&quot;transformed&quot;</span>: <span <span class="kw">class</span>="num">0</span>, <span <span class="kw">class</span>="st">&quot;loaded&quot;</span>: <span <span class="kw">class</span>="num">0</span>, <span <span class="kw">class</span>="st">&quot;errors&quot;</span>: <span <span class="kw">class</span>="num">0</span>}

    <span class="kw">def</span> extract(self) -&gt; <span class="fn">list</span>[<span class="fn">dict</span>]:
        logger.info(<span <span class="kw">class</span>="st">&quot;Extracting <span class="kw">from</span> %s&quot;</span>, self.config[<span <span class="kw">class</span>="st">&quot;source&quot;</span>])
        raw = self.config.get(<span <span class="kw">class</span>="st">&quot;_data&quot;</span>, [])  <span <span class="kw">class</span>="cm"># use injected data <span class="kw">for</span> demo</span>
        self.stats[<span <span class="kw">class</span>="st">&quot;extracted&quot;</span>] = <span class="fn">len</span>(raw)
        <span class="kw">return</span> raw

    <span class="kw">def</span> transform(self, raw: <span class="fn">list</span>[<span class="fn">dict</span>]) -&gt; <span class="fn">list</span>[<span class="fn">dict</span>]:
        cleaned = []
        <span class="kw">for</span> record <span class="kw">in</span> raw:
            <span class="kw">try</span>:
                name = record.get(<span <span class="kw">class</span>="st">&quot;name&quot;</span>, <span <span class="kw">class</span>="st">&quot;&quot;</span>).strip()
                <span class="kw">if</span> <span class="kw">not</span> name:
                    <span class="kw">raise</span> ValueError(<span <span class="kw">class</span>="st">&quot;Empty name&quot;</span>)
                cleaned.append({
                    <span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: record[<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>],
                    <span <span class="kw">class</span>="st">&quot;name&quot;</span>: name.lower(),
                    <span <span class="kw">class</span>="st">&quot;value&quot;</span>: <span class="fn">float</span>(record.get(<span <span class="kw">class</span>="st">&quot;value&quot;</span>, <span <span class="kw">class</span>="num">0</span>)),
                    <span <span class="kw">class</span>="st">&quot;processed_at&quot;</span>: datetime.utcnow().isoformat(),
                })
            <span class="kw">except</span> (KeyError, ValueError) <span class="kw">as</span> e:
                self.stats[<span <span class="kw">class</span>="st">&quot;errors&quot;</span>] += <span <span class="kw">class</span>="num">1</span>
                logger.warning(<span <span class="kw">class</span>="st">&quot;Bad record <span class="fn">id</span>=%s: %s&quot;</span>, record.get(<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>), e)
        self.stats[<span <span class="kw">class</span>="st">&quot;transformed&quot;</span>] = <span class="fn">len</span>(cleaned)
        <span class="kw">return</span> cleaned

    <span class="kw">def</span> load(self, data: <span class="fn">list</span>[<span class="fn">dict</span>]):
        logger.info(<span <span class="kw">class</span>="st">&quot;Loading %d records to %s&quot;</span>, <span class="fn">len</span>(data), self.config[<span <span class="kw">class</span>="st">&quot;destination&quot;</span>])
        LOADED_DATA.extend(data)  <span <span class="kw">class</span>="cm"># simulated bulk insert</span>
        self.stats[<span <span class="kw">class</span>="st">&quot;loaded&quot;</span>] = <span class="fn">len</span>(data)

    <span class="kw">def</span> run(self):
        raw = self.extract()
        clean = self.transform(raw)
        self.load(clean)
        logger.info(<span <span class="kw">class</span>="st">&quot;Pipeline complete: %s&quot;</span>, self.stats)
        <span class="kw">return</span> self.stats

<span <span class="kw">class</span>="cm"># Run it!</span>
config = {
    <span <span class="kw">class</span>="st">&quot;source&quot;</span>: <span <span class="kw">class</span>="st">&quot;api://demo&quot;</span>,
    <span <span class="kw">class</span>="st">&quot;destination&quot;</span>: <span <span class="kw">class</span>="st">&quot;postgres://warehouse&quot;</span>,
    <span <span class="kw">class</span>="st">&quot;_data&quot;</span>: SOURCE_DATA,
}
pipeline = ETLPipeline(config)
stats = pipeline.run()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nResults: {stats}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;Loaded records: {LOADED_DATA}&quot;</span>)</code></pre>
  </div>
</div>

<div class="card wide" data-tags="batching & dead letter queue">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Ba</div>
    <h3>Batching &amp; Dead Letter Queue</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> json
<span class="kw">from</span> itertools <span class="kw">import</span> islice
<span class="kw">from</span> pathlib <span class="kw">import</span> Path

<span class="kw">def</span> batched(iterable, n):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Yield successive batches <span class="kw">from</span> iterable.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    it = <span class="fn">iter</span>(iterable)
    <span class="kw">while</span> <span class="kw">True</span>:
        batch = <span class="fn">list</span>(islice(it, n))
        <span class="kw">if</span> <span class="kw">not</span> batch:
            <span class="kw">break</span>
        <span class="kw">yield</span> batch

<span <span class="kw">class</span>="cm"># Demo: process records <span class="kw">in</span> batches</span>
records = <span class="fn">list</span>(<span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">14</span>))
<span class="kw">for</span> i, batch <span class="kw">in</span> <span class="fn">enumerate</span>(batched(records, batch_size := <span <span class="kw">class</span>="num">5</span>)):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Batch {i}: {batch}&quot;</span>)

<span <span class="kw">class</span>="cm"># Dead Letter Queue pattern</span>
<span class="kw">def</span> process_with_dlq(records, processor, dlq_path=<span <span class="kw">class</span>="st">&quot;dlq_demo.jsonl&quot;</span>):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Process records; write failures to dead letter queue.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    success, failed = <span <span class="kw">class</span>="num">0</span>, <span <span class="kw">class</span>="num">0</span>
    <span class="kw">with</span> <span class="fn">open</span>(dlq_path, <span <span class="kw">class</span>="st">&quot;w&quot;</span>) <span class="kw">as</span> dlq:
        <span class="kw">for</span> record <span class="kw">in</span> records:
            <span class="kw">try</span>:
                processor(record)
                success += <span <span class="kw">class</span>="num">1</span>
            <span class="kw">except</span> Exception <span class="kw">as</span> e:
                failed += <span <span class="kw">class</span>="num">1</span>
                dlq.write(json.dumps({
                    <span <span class="kw">class</span>="st">&quot;record&quot;</span>: record,
                    <span <span class="kw">class</span>="st">&quot;error&quot;</span>: <span class="fn">str</span>(e),
                }) + <span <span class="kw">class</span>="st">&quot;\n&quot;</span>)
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Processed: {success} success, {failed} failed&quot;</span>)
    <span class="kw">return</span> success, failed

<span <span class="kw">class</span>="cm"># Simulated processor that fails on negative values</span>
<span class="kw">def</span> transform_record(record):
    <span class="kw">if</span> record[<span <span class="kw">class</span>="st">&quot;value&quot;</span>] &lt; <span <span class="kw">class</span>="num">0</span>:
        <span class="kw">raise</span> ValueError(f&quot;Negative value: {record[&<span <span class="kw">class</span>="cm">#x27;value&#x27;]}<span <span class="kw">class</span>="st">&quot;)</span>
    <span class="kw">return</span> record

sample_records = [
    {&quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">1</span>, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">100</span>},
    {&quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">2</span>, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: -<span <span class="kw">class</span>="num">50</span>},
    {&quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">3</span>, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">200</span>},
    {&quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">4</span>, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: -<span <span class="kw">class</span>="num">10</span>},
    {&quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">5</span>, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">300</span>},
]

<span class="fn">print</span>(&quot;</span>=== Dead Letter Queue ===<span <span class="kw">class</span>="st">&quot;)
process_with_dlq(sample_records, transform_record)

<span <span class="kw">class</span>="cm"># Show DLQ contents</span>
<span class="fn">print</span>(&quot;</span>\nDLQ contents:<span <span class="kw">class</span>="st">&quot;)
<span class="kw">with</span> <span class="fn">open</span>(&quot;</span>dlq_demo.jsonl<span <span class="kw">class</span>="st">&quot;) <span class="kw">as</span> f:
    <span class="kw">for</span> line <span class="kw">in</span> f:
        <span class="fn">print</span>(f&quot;</span>  {json.loads(line)}<span <span class="kw">class</span>="st">&quot;)

Path(&quot;</span>dlq_demo.jsonl&quot;).unlink()</code></pre>
  </div>
</div>

<div class="section-divider" id="cloud-and-object-storage-simulated" data-section="cloud-and-object-storage-simulated">
  <h2>Cloud & Object Storage (Simulated)</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Cloud</span>
</div>

<div class="card wide" data-tags="cloud & object storage (simulated)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Cl</div>
    <h3>Cloud &amp; Object Storage (Simulated)</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;
Simulated AWS S3 / GCS operations.
Install real libraries <span class="kw">with</span>: pip install boto3 / google-cloud-storage

Below <span class="kw">is</span> the real code pattern — runs <span class="kw">as</span> documentation/reference.
Uncomment <span class="kw">and</span> configure to use <span class="kw">with</span> real credentials.
&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>

<span class="kw">import</span> io
<span class="kw">import</span> json
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span <span class="kw">class</span>="cm"># === Simulated S3-like operations ===</span>

<span <span class="kw">class</span>="cm"># In-memory <span <span class="kw">class</span>="st">&quot;bucket&quot;</span> <span class="kw">for</span> demo</span>
fake_s3 = {}

<span class="kw">def</span> s3_put(bucket, key, data):
    fake_s3[<span <span class="kw">class</span>="st">f&quot;{bucket}/{key}&quot;</span>] = data
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Uploaded: s3://{bucket}/{key} ({<span class="fn">len</span>(data)} bytes)&quot;</span>)

<span class="kw">def</span> s3_get(bucket, key):
    <span class="kw">return</span> fake_s3[<span <span class="kw">class</span>="st">f&quot;{bucket}/{key}&quot;</span>]

<span class="kw">def</span> s3_list(bucket, prefix=<span <span class="kw">class</span>="st">&quot;&quot;</span>):
    <span class="kw">return</span> [k <span class="kw">for</span> k <span class="kw">in</span> fake_s3 <span class="kw">if</span> k.startswith(<span <span class="kw">class</span>="st">f&quot;{bucket}/{prefix}&quot;</span>)]

<span <span class="kw">class</span>="cm"># Demo: write DataFrame to <span <span class="kw">class</span>="st">&quot;S3&quot;</span></span>
np.random.seed(<span <span class="kw">class</span>="num">42</span>)
df = pd.DataFrame({<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: <span class="fn">range</span>(<span <span class="kw">class</span>="num">5</span>), <span <span class="kw">class</span>="st">&quot;value&quot;</span>: np.random.randn(<span <span class="kw">class</span>="num">5</span>).<span class="fn">round</span>(<span <span class="kw">class</span>="num">3</span>)})
csv_buffer = io.StringIO()
df.to_csv(csv_buffer, index=<span class="kw">False</span>)
s3_put(<span <span class="kw">class</span>="st">&quot;my-bucket&quot;</span>, <span <span class="kw">class</span>="st">&quot;data/output.csv&quot;</span>, csv_buffer.getvalue())

<span <span class="kw">class</span>="cm"># Demo: read it back</span>
content = s3_get(<span <span class="kw">class</span>="st">&quot;my-bucket&quot;</span>, <span <span class="kw">class</span>="st">&quot;data/output.csv&quot;</span>)
df_loaded = pd.read_csv(io.StringIO(content))
<span class="fn">print</span>(&quot;\nLoaded <span class="kw">from</span> &<span <span class="kw">class</span>="cm">#x27;S3&#x27;:<span <span class="kw">class</span>="st">&quot;)</span>
<span class="fn">print</span>(df_loaded)

<span <span class="kw">class</span>="cm"># List objects</span>
<span class="fn">print</span>(&quot;</span>\nObjects:<span <span class="kw">class</span>="st">&quot;, s3_list(&quot;</span>my-bucket<span <span class="kw">class</span>="st">&quot;, &quot;</span>data/<span <span class="kw">class</span>="st">&quot;))

<span <span class="kw">class</span>="cm"># --- Real boto3 code (reference) ---</span>
<span <span class="kw">class</span>="cm"># <span class="kw">import</span> boto3</span>
<span <span class="kw">class</span>="cm"># s3 = boto3.client(&quot;</span>s3<span <span class="kw">class</span>="st">&quot;)</span>
<span <span class="kw">class</span>="cm"># s3.upload_file(&quot;</span>local.csv<span <span class="kw">class</span>="st">&quot;, &quot;</span>my-bucket<span <span class="kw">class</span>="st">&quot;, &quot;</span>data/file.csv<span <span class="kw">class</span>="st">&quot;)</span>
<span <span class="kw">class</span>="cm"># obj = s3.get_object(Bucket=&quot;</span>my-bucket<span <span class="kw">class</span>="st">&quot;, Key=&quot;</span>data/file.csv<span <span class="kw">class</span>="st">&quot;)</span>
<span <span class="kw">class</span>="cm"># df = pd.read_csv(io.BytesIO(obj[&quot;</span>Body&quot;].read()))</span></code></pre>
  </div>
</div>

<div class="section-divider" id="api-interaction-simulated" data-section="api-interaction-simulated">
  <h2>API Interaction (Simulated)</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--purple-dim);color:var(--purple)">API</span>
</div>

<div class="card wide" data-tags="api interaction (simulated)">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">AP</div>
    <h3>API Interaction (Simulated)</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;
Simulated HTTP requests <span class="kw">for</span> Jupyter demo.
Install real library: pip install requests

The patterns below work <span class="kw">with</span> `requests` — swap fake_api <span class="kw">for</span> real URLs.
&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>

<span class="kw">import</span> json
<span class="kw">import</span> time

<span <span class="kw">class</span>="cm"># === Simulated API ===</span>
FAKE_DB = [{<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>: i, <span <span class="kw">class</span>="st">&quot;name&quot;</span>: <span <span class="kw">class</span>="st">f&quot;user_{i}&quot;</span>, <span <span class="kw">class</span>="st">&quot;score&quot;</span>: i*<span <span class="kw">class</span>="num">10</span>} <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">26</span>)]

<span class="kw">def</span> fake_api_get(url, params=<span class="kw">None</span>):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Simulate a paginated API response.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    params = params <span class="kw">or</span> {}
    page = params.get(<span <span class="kw">class</span>="st">&quot;page&quot;</span>, <span <span class="kw">class</span>="num">1</span>)
    limit = params.get(<span <span class="kw">class</span>="st">&quot;limit&quot;</span>, <span <span class="kw">class</span>="num">10</span>)
    start = (page - <span <span class="kw">class</span>="num">1</span>) * limit
    data = FAKE_DB[start:start+limit]
    <span class="kw">return</span> {<span <span class="kw">class</span>="st">&quot;status&quot;</span>: <span <span class="kw">class</span>="num">200</span>, <span <span class="kw">class</span>="st">&quot;data&quot;</span>: data, <span <span class="kw">class</span>="st">&quot;page&quot;</span>: page}

<span <span class="kw">class</span>="cm"># Paginated extraction</span>
<span class="kw">def</span> extract_all(base_url, page_size=<span <span class="kw">class</span>="num">10</span>):
    all_records = []
    page = <span <span class="kw">class</span>="num">1</span>
    <span class="kw">while</span> <span class="kw">True</span>:
        resp = fake_api_get(base_url, params={<span <span class="kw">class</span>="st">&quot;page&quot;</span>: page, <span <span class="kw">class</span>="st">&quot;limit&quot;</span>: page_size})
        batch = resp[<span <span class="kw">class</span>="st">&quot;data&quot;</span>]
        <span class="kw">if</span> <span class="kw">not</span> batch:
            <span class="kw">break</span>
        all_records.extend(batch)
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Page {page}: fetched {<span class="fn">len</span>(batch)} records&quot;</span>)
        page += <span <span class="kw">class</span>="num">1</span>
    <span class="kw">return</span> all_records

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;=== Paginated API Extraction ===&quot;</span>)
all_data = extract_all(<span <span class="kw">class</span>="st">&quot;https://api.example.com/users&quot;</span>, page_size=<span <span class="kw">class</span>="num">10</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;Total extracted: {<span class="fn">len</span>(all_data)} records&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;First: {all_data[<span <span class="kw">class</span>="num">0</span>]}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;Last:  {all_data[-<span <span class="kw">class</span>="num">1</span>]}&quot;</span>)

<span <span class="kw">class</span>="cm"># --- Real requests code (reference) ---</span>
<span <span class="kw">class</span>="cm"># <span class="kw">import</span> requests</span>
<span <span class="kw">class</span>="cm"># <span class="kw">from</span> requests.adapters <span class="kw">import</span> HTTPAdapter</span>
<span <span class="kw">class</span>="cm"># <span class="kw">from</span> urllib3.util.retry <span class="kw">import</span> Retry</span>
<span <span class="kw">class</span>="cm">#</span>
<span <span class="kw">class</span>="cm"># session = requests.Session()</span>
<span <span class="kw">class</span>="cm"># retries = Retry(total=<span <span class="kw">class</span>="num">3</span>, backoff_factor=<span <span class="kw">class</span>="num">1</span>, status_forcelist=[<span <span class="kw">class</span>="num">429</span>, <span <span class="kw">class</span>="num">500</span>, <span <span class="kw">class</span>="num">502</span>, <span <span class="kw">class</span>="num">503</span>])</span>
<span <span class="kw">class</span>="cm"># session.mount(<span <span class="kw">class</span>="st">&quot;https://&quot;</span>, HTTPAdapter(max_retries=retries))</span>
<span <span class="kw">class</span>="cm"># resp = session.get(<span <span class="kw">class</span>="st">&quot;https://api.example.com/data&quot;</span>,</span>
<span <span class="kw">class</span>="cm">#     params={<span <span class="kw">class</span>="st">&quot;page&quot;</span>: <span <span class="kw">class</span>="num">1</span>}, headers={<span <span class="kw">class</span>="st">&quot;Authorization&quot;</span>: <span <span class="kw">class</span>="st">&quot;Bearer TOKEN&quot;</span>}, timeout=<span <span class="kw">class</span>="num">30</span>)</span>
<span <span class="kw">class</span>="cm"># resp.raise_for_status()</span>
<span <span class="kw">class</span>="cm"># data = resp.json()</span></code></pre>
  </div>
</div>

<div class="section-divider" id="concurrency-and-parallelism" data-section="concurrency-and-parallelism">
  <h2>Concurrency & Parallelism</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--green-dim);color:var(--green)">Performance</span>
</div>

<div class="card wide" data-tags="concurrency & parallelism">
  <div class="card-head">
    <div class="card-icon" style="background:var(--green-dim);color:var(--green)">Co</div>
    <h3>Concurrency &amp; Parallelism</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> time
<span class="kw">from</span> concurrent.futures <span class="kw">import</span> ThreadPoolExecutor, ProcessPoolExecutor, as_completed
<span class="kw">import</span> asyncio

<span <span class="kw">class</span>="cm"># === ThreadPoolExecutor — I/O-bound ===</span>
<span class="kw">def</span> fetch_url(url):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Simulate an API call <span class="kw">with</span> a small delay.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    time.sleep(<span <span class="kw">class</span>="num">0.05</span>)  <span <span class="kw">class</span>="cm"># simulate network latency</span>
    <span class="kw">return</span> {<span <span class="kw">class</span>="st">&quot;url&quot;</span>: url, <span <span class="kw">class</span>="st">&quot;status&quot;</span>: <span <span class="kw">class</span>="num">200</span>, <span <span class="kw">class</span>="st">&quot;size&quot;</span>: <span class="fn">len</span>(url) * <span <span class="kw">class</span>="num">100</span>}

urls = [<span <span class="kw">class</span>="st">f&quot;https://api.example.com/page/{i}&quot;</span> <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">10</span>)]

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;=== Threading (I/O-bound) ===&quot;</span>)
t0 = time.perf_counter()
results = []
<span class="kw">with</span> ThreadPoolExecutor(max_workers=<span <span class="kw">class</span>="num">5</span>) <span class="kw">as</span> pool:
    futures = {pool.submit(fetch_url, url): url <span class="kw">for</span> url <span class="kw">in</span> urls}
    <span class="kw">for</span> future <span class="kw">in</span> as_completed(futures):
        results.append(future.result())
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Fetched {<span class="fn">len</span>(results)} URLs <span class="kw">in</span> {time.perf_counter()-t0:.3f}s (parallel)&quot;</span>)

t0 = time.perf_counter()
sequential = [fetch_url(url) <span class="kw">for</span> url <span class="kw">in</span> urls]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Fetched {<span class="fn">len</span>(sequential)} URLs <span class="kw">in</span> {time.perf_counter()-t0:.3f}s (sequential)&quot;</span>)

<span <span class="kw">class</span>="cm"># === ProcessPoolExecutor — CPU-bound ===</span>
<span class="kw">def</span> heavy_compute(n):
    <span <span class="kw">class</span>="st"><span <span class="kw">class</span>="st">&quot;&quot;</span><span <span class="kw">class</span>="st">&quot;Simulate CPU-intensive work.&quot;</span><span <span class="kw">class</span>="st">&quot;&quot;</span></span>
    <span class="kw">return</span> <span class="fn">sum</span>(i*i <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n))

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Multiprocessing (CPU-bound) ===&quot;</span>)
chunks = [<span <span class="kw">class</span>="num">100_000</span>] * <span <span class="kw">class</span>="num">8</span>
t0 = time.perf_counter()
<span class="kw">with</span> ProcessPoolExecutor(max_workers=<span <span class="kw">class</span>="num">4</span>) <span class="kw">as</span> pool:
    results = <span class="fn">list</span>(pool.<span class="fn">map</span>(heavy_compute, chunks))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Processed {<span class="fn">len</span>(results)} chunks <span class="kw">in</span> {time.perf_counter()-t0:.3f}s&quot;</span>)

<span <span class="kw">class</span>="cm"># === asyncio — high-concurrency I/O ===</span>
<span class="kw">async</span> <span class="kw">def</span> async_fetch(url, delay=<span <span class="kw">class</span>="num">0.05</span>):
    <span class="kw">await</span> asyncio.sleep(delay)  <span <span class="kw">class</span>="cm"># simulate I/O</span>
    <span class="kw">return</span> {<span <span class="kw">class</span>="st">&quot;url&quot;</span>: url, <span <span class="kw">class</span>="st">&quot;status&quot;</span>: <span <span class="kw">class</span>="num">200</span>}

<span class="kw">async</span> <span class="kw">def</span> main():
    tasks = [async_fetch(<span <span class="kw">class</span>="st">f&quot;https://api.example.com/p/{i}&quot;</span>) <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">10</span>)]
    results = <span class="kw">await</span> asyncio.gather(*tasks)
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Async fetched: {<span class="fn">len</span>(results)} results&quot;</span>)

<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== Asyncio ===&quot;</span>)
<span class="kw">await</span> main()  <span <span class="kw">class</span>="cm"># In Jupyter, use `<span class="kw">await</span>` directly. In scripts, use: asyncio.run(main())</span></code></pre>
  </div>
</div>

<div class="section-divider" id="data-validation-and-quality" data-section="data-validation-and-quality">
  <h2>Data Validation & Quality</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--pink-dim);color:var(--pink)">Quality</span>
</div>

<div class="card wide" data-tags="data validation & quality">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">Da</div>
    <h3>Data Validation &amp; Quality</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> logging

logging.basicConfig(level=logging.INFO, <span class="fn">format</span>=<span <span class="kw">class</span>="st">&quot;%(message)s&quot;</span>)
logger = logging.getLogger(<span <span class="kw">class</span>="st">&quot;dq&quot;</span>)

<span <span class="kw">class</span>="cm"># === Schema validation (manual Pydantic-style) ===</span>
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

<span class="dc">@dataclass</span>
<span class="kw">class</span> EventRecord:
    event_id: <span class="fn">str</span>
    timestamp: <span class="fn">str</span>
    value: <span class="fn">float</span>
    source: <span class="fn">str</span>

    <span class="kw">def</span> __post_init__(self):
        <span class="kw">if</span> <span class="kw">not</span> self.event_id:
            <span class="kw">raise</span> ValueError(<span <span class="kw">class</span>="st">&quot;event_id cannot be empty&quot;</span>)
        <span class="kw">if</span> self.value &lt; <span <span class="kw">class</span>="num">0</span>:
            <span class="kw">raise</span> ValueError(f&quot;value must be &gt;= <span <span class="kw">class</span>="num">0</span>, got {self.value}<span <span class="kw">class</span>="st">&quot;)
        datetime.fromisoformat(self.timestamp)  <span <span class="kw">class</span>="cm"># validate timestamp</span>

<span <span class="kw">class</span>="cm"># Validate batch</span>
<span class="kw">def</span> validate_batch(records):
    valid, invalid = [], []
    <span class="kw">for</span> r <span class="kw">in</span> records:
        <span class="kw">try</span>:
            evt = EventRecord(**r)
            valid.append({&quot;</span>event_id<span <span class="kw">class</span>="st">&quot;: evt.event_id, &quot;</span>timestamp<span <span class="kw">class</span>="st">&quot;: evt.timestamp,
                          &quot;</span>value<span <span class="kw">class</span>="st">&quot;: evt.value, &quot;</span>source<span <span class="kw">class</span>="st">&quot;: evt.source})
        <span class="kw">except</span> Exception <span class="kw">as</span> e:
            invalid.append({&quot;</span>record<span <span class="kw">class</span>="st">&quot;: r, &quot;</span>erro<span <span class="kw">class</span>="st">r&quot;: <span class="fn">str</span>(e)})
    <span class="kw">return</span> valid, invalid

sample = [
    {&quot;</span>event_id<span <span class="kw">class</span>="st">&quot;: &quot;</span>evt-<span <span class="kw">class</span>="num">001</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>timestamp<span <span class="kw">class</span>="st">&quot;: &quot;</span><span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">06</span>-15T10:<span <span class="kw">class</span>="num">30</span>:<span <span class="kw">class</span>="num">00</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">42.5</span>, &quot;</span>source<span <span class="kw">class</span>="st">&quot;: &quot;</span>sensor_a<span <span class="kw">class</span>="st">&quot;},
    {&quot;</span>event_id<span <span class="kw">class</span>="st">&quot;: &quot;</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>timestamp<span <span class="kw">class</span>="st">&quot;: &quot;</span><span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">06</span>-15T10:<span <span class="kw">class</span>="num">31</span>:<span <span class="kw">class</span>="num">00</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">10.0</span>, &quot;</span>source<span <span class="kw">class</span>="st">&quot;: &quot;</span>sensor_b<span <span class="kw">class</span>="st">&quot;},
    {&quot;</span>event_id<span <span class="kw">class</span>="st">&quot;: &quot;</span>evt-<span <span class="kw">class</span>="num">003</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>timestamp<span <span class="kw">class</span>="st">&quot;: &quot;</span><span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">06</span>-15T10:<span <span class="kw">class</span>="num">32</span>:<span <span class="kw">class</span>="num">00</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: -<span <span class="kw">class</span>="num">5.0</span>, &quot;</span>source<span <span class="kw">class</span>="st">&quot;: &quot;</span>sensor_c<span <span class="kw">class</span>="st">&quot;},
    {&quot;</span>event_id<span <span class="kw">class</span>="st">&quot;: &quot;</span>evt-<span <span class="kw">class</span>="num">004</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>timestamp<span <span class="kw">class</span>="st">&quot;: &quot;</span>bad-date<span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">20.0</span>, &quot;</span>source<span <span class="kw">class</span>="st">&quot;: &quot;</span>sensor_a<span <span class="kw">class</span>="st">&quot;},
    {&quot;</span>event_id<span <span class="kw">class</span>="st">&quot;: &quot;</span>evt-<span <span class="kw">class</span>="num">005</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>timestamp<span <span class="kw">class</span>="st">&quot;: &quot;</span><span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">06</span>-15T10:<span <span class="kw">class</span>="num">34</span>:<span <span class="kw">class</span>="num">00</span><span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;: <span <span class="kw">class</span>="num">99.9</span>, &quot;</span>source<span <span class="kw">class</span>="st">&quot;: &quot;</span>sensor_b<span <span class="kw">class</span>="st">&quot;},
]

valid, invalid = validate_batch(sample)
<span class="fn">print</span>(f&quot;</span>=== Validation: {<span class="fn">len</span>(valid)} valid, {<span class="fn">len</span>(invalid)} invalid ===<span <span class="kw">class</span>="st">&quot;)
<span class="kw">for</span> v <span class="kw">in</span> valid:
    <span class="fn">print</span>(f&quot;</span>  ✓ {v[&<span <span class="kw">class</span>="cm">#x27;event_id<span <span class="kw">class</span>="st">&#x27;]}: {v[&#x27;</span>value&#x27;]}<span <span class="kw">class</span>="st">&quot;)</span>
<span class="kw">for</span> inv <span class="kw">in</span> invalid:
    <span class="fn">print</span>(f&quot;</span>  ✗ {inv[&<span <span class="kw">class</span>="cm">#x27;record<span <span class="kw">class</span>="st">&#x27;].get(&#x27;</span>event_id<span <span class="kw">class</span>="st">&#x27;, &#x27;</span>???<span <span class="kw">class</span>="st">&#x27;)}: {inv[&#x27;</span>error&#x27;]}<span <span class="kw">class</span>="st">&quot;)</span>

<span <span class="kw">class</span>="cm"># === Data quality checks on DataFrame ===</span>
np.random.seed(<span <span class="kw">class</span>="num">42</span>)
df = pd.DataFrame({
    &quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;: <span class="fn">list</span>(<span class="fn">range</span>(<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">201</span>)),
    &quot;</span>value<span <span class="kw">class</span>="st">&quot;: np.random.uniform(-<span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">100</span>, <span <span class="kw">class</span>="num">200</span>),
    &quot;</span>date<span <span class="kw">class</span>="st">&quot;: pd.date_range(&quot;</span><span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">01</span>-<span <span class="kw">class</span>="num">01</span><span <span class="kw">class</span>="st">&quot;, periods=<span <span class="kw">class</span>="num">200</span>).astype(<span class="fn">str</span>),
})
df.loc[<span <span class="kw">class</span>="num">5</span>, &quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;] = <span class="kw">None</span>  <span <span class="kw">class</span>="cm"># inject a null</span>
df.loc[<span <span class="kw">class</span>="num">10</span>, &quot;</span>value<span <span class="kw">class</span>="st">&quot;] = -<span <span class="kw">class</span>="num">999</span>  <span <span class="kw">class</span>="cm"># inject a bad value</span>

<span class="kw">def</span> data_quality_checks(df):
    checks = {
        &quot;</span>no_nulls_in_id<span <span class="kw">class</span>="st">&quot;:    df[&quot;</span><span class="fn">id</span><span <span class="kw">class</span>="st">&quot;].notnull().<span class="fn">all</span>(),
        &quot;</span>positive_values<span <span class="kw">class</span>="st">&quot;:   (df[&quot;</span>value&quot;] &gt;= <span <span class="kw">class</span>="num">0</span>).<span class="fn">all</span>(),
        <span <span class="kw">class</span>="st">&quot;unique_ids&quot;</span>:        df[<span <span class="kw">class</span>="st">&quot;<span class="fn">id</span>&quot;</span>].dropna().is_unique,
        <span <span class="kw">class</span>="st">&quot;row_count_min&quot;</span>:     <span class="fn">len</span>(df) &gt;= <span <span class="kw">class</span>="num">100</span>,
        <span <span class="kw">class</span>="st">&quot;valid_dates&quot;</span>:       pd.to_datetime(df[<span <span class="kw">class</span>="st">&quot;date&quot;</span>]).between(<span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2020</span>-<span <span class="kw">class</span>="num">01</span>-<span <span class="kw">class</span>="num">01</span>&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">2030</span>-<span <span class="kw">class</span>="num">01</span>-<span <span class="kw">class</span>="num">01</span>&quot;</span>).<span class="fn">all</span>(),
    }
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;\n=== DQ Checks ===&quot;</span>)
    <span class="kw">for</span> name, passed <span class="kw">in</span> checks.items():
        status = <span <span class="kw">class</span>="st">&quot;✓ PASS&quot;</span> <span class="kw">if</span> passed <span class="kw">else</span> <span <span class="kw">class</span>="st">&quot;✗ FAIL&quot;</span>
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  {status}: {name}&quot;</span>)
    <span class="kw">return</span> <span class="fn">all</span>(checks.values())

all_passed = data_quality_checks(df)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nAll checks passed: {all_passed}&quot;</span>)</code></pre>
  </div>
</div>

<div class="section-divider" id="environment-and-configuration" data-section="environment-and-configuration">
  <h2>Environment & Configuration</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--cyan-dim);color:var(--cyan)">Config</span>
</div>

<div class="card wide" data-tags="environment & configuration">
  <div class="card-head">
    <div class="card-icon" style="background:var(--cyan-dim);color:var(--cyan)">En</div>
    <h3>Environment &amp; Configuration</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span class="kw">import</span> os
<span class="kw">from</span> dataclasses <span class="kw">import</span> dataclass

<span <span class="kw">class</span>="cm"># Set demo environment variables (<span class="kw">in</span> production, these come <span class="kw">from</span> .env <span class="kw">or</span> the OS)</span>
os.environ[<span <span class="kw">class</span>="st">&quot;DB_HOST&quot;</span>] = <span <span class="kw">class</span>="st">&quot;localhost&quot;</span>
os.environ[<span <span class="kw">class</span>="st">&quot;DB_PORT&quot;</span>] = <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">5432</span>&quot;</span>
os.environ[<span <span class="kw">class</span>="st">&quot;DB_NAME&quot;</span>] = <span <span class="kw">class</span>="st">&quot;mydb&quot;</span>
os.environ[<span <span class="kw">class</span>="st">&quot;BATCH_SIZE&quot;</span>] = <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">5000</span>&quot;</span>
os.environ[<span <span class="kw">class</span>="st">&quot;DEBUG&quot;</span>] = <span <span class="kw">class</span>="st">&quot;true&quot;</span>

<span <span class="kw">class</span>="cm"># Reading env vars</span>
DB_HOST = os.environ[<span <span class="kw">class</span>="st">&quot;DB_HOST&quot;</span>]
DB_PORT = os.environ.get(<span <span class="kw">class</span>="st">&quot;DB_PORT&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">5432</span>&quot;</span>)
DEBUG = os.environ.get(<span <span class="kw">class</span>="st">&quot;DEBUG&quot;</span>, <span <span class="kw">class</span>="st">&quot;false&quot;</span>).lower() == <span <span class="kw">class</span>="st">&quot;true&quot;</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;DB_HOST={DB_HOST}, DB_PORT={DB_PORT}, DEBUG={DEBUG}&quot;</span>)

<span <span class="kw">class</span>="cm"># Config <span class="kw">class</span> pattern</span>
<span class="dc">@dataclass</span>
<span class="kw">class</span> Config:
    db_host: <span class="fn">str</span> = os.environ.get(<span <span class="kw">class</span>="st">&quot;DB_HOST&quot;</span>, <span <span class="kw">class</span>="st">&quot;localhost&quot;</span>)
    db_port: <span class="fn">int</span> = <span class="fn">int</span>(os.environ.get(<span <span class="kw">class</span>="st">&quot;DB_PORT&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">5432</span>&quot;</span>))
    db_name: <span class="fn">str</span> = os.environ.get(<span <span class="kw">class</span>="st">&quot;DB_NAME&quot;</span>, <span <span class="kw">class</span>="st">&quot;mydb&quot;</span>)
    batch_size: <span class="fn">int</span> = <span class="fn">int</span>(os.environ.get(<span <span class="kw">class</span>="st">&quot;BATCH_SIZE&quot;</span>, <span <span class="kw">class</span>="st">&quot;<span <span class="kw">class</span>="num">5000</span>&quot;</span>))
    debug: bool = os.environ.get(<span <span class="kw">class</span>="st">&quot;DEBUG&quot;</span>, <span <span class="kw">class</span>="st">&quot;false&quot;</span>).lower() == <span <span class="kw">class</span>="st">&quot;true&quot;</span>

    <span class="dc">@property</span>
    <span class="kw">def</span> db_url(self):
        <span class="kw">return</span> <span <span class="kw">class</span>="st">f&quot;postgresql://{self.db_host}:{self.db_port}/{self.db_name}&quot;</span>

config = Config()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;\nConfig: {config}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;DB URL: {config.db_url}&quot;</span>)

<span <span class="kw">class</span>="cm"># Cleanup</span>
<span class="kw">for</span> key <span class="kw">in</span> [<span <span class="kw">class</span>="st">&quot;DB_HOST&quot;</span>, <span <span class="kw">class</span>="st">&quot;DB_PORT&quot;</span>, <span <span class="kw">class</span>="st">&quot;DB_NAME&quot;</span>, <span <span class="kw">class</span>="st">&quot;BATCH_SIZE&quot;</span>, <span <span class="kw">class</span>="st">&quot;DEBUG&quot;</span>]:
    os.environ.pop(key, <span class="kw">None</span>)</code></pre>
  </div>
</div>

<div class="section-divider" id="pro-tips-and-patterns" data-section="pro-tips-and-patterns">
  <h2>Pro Tips & Patterns</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--amber-dim);color:var(--amber)">Essential</span>
</div>

<div class="card wide" data-tags="built-in superpowers">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">Bu</div>
    <h3>Built-in Superpowers</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># <span class="fn">enumerate</span> — index + value</span>
items = [<span <span class="kw">class</span>="st">&quot;apple&quot;</span>, <span <span class="kw">class</span>="st">&quot;banana&quot;</span>, <span <span class="kw">class</span>="st">&quot;cherry&quot;</span>]
<span class="kw">for</span> i, val <span class="kw">in</span> <span class="fn">enumerate</span>(items, start=<span <span class="kw">class</span>="num">1</span>):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;{i}. {val}&quot;</span>)

<span <span class="kw">class</span>="cm"># <span class="fn">zip</span> — parallel iteration &amp; <span class="fn">dict</span> creation</span>
names = [<span <span class="kw">class</span>="st">&quot;Alice&quot;</span>, <span <span class="kw">class</span>="st">&quot;Bob&quot;</span>, <span <span class="kw">class</span>="st">&quot;Charlie&quot;</span>]
scores = [<span <span class="kw">class</span>="num">95</span>, <span <span class="kw">class</span>="num">87</span>, <span <span class="kw">class</span>="num">92</span>]
<span class="kw">for</span> name, score <span class="kw">in</span> <span class="fn">zip</span>(names, scores):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  {name}: {score}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;<span class="fn">zip</span> → <span class="fn">dict</span>:&quot;</span>, <span class="fn">dict</span>(<span class="fn">zip</span>(names, scores)))

<span <span class="kw">class</span>="cm"># <span class="fn">any</span> / <span class="fn">all</span> — quick checks</span>
records = [{<span <span class="kw">class</span>="st">&quot;status&quot;</span>: <span <span class="kw">class</span>="st">&quot;ok&quot;</span>}, {<span <span class="kw">class</span>="st">&quot;status&quot;</span>: <span <span class="kw">class</span>="st">&quot;error&quot;</span>}, {<span <span class="kw">class</span>="st">&quot;status&quot;</span>: <span <span class="kw">class</span>="st">&quot;ok&quot;</span>}]
<span class="fn">print</span>(f&quot;<span class="fn">any</span> errors: {<span class="fn">any</span>(r[&<span <span class="kw">class</span>="cm">#x27;status<span <span class="kw">class</span>="st">&#x27;] == &#x27;</span>error&#x27; <span class="kw">for</span> r <span class="kw">in</span> records)}<span <span class="kw">class</span>="st">&quot;)</span>
<span class="fn">print</span>(f&quot;</span><span class="fn">all</span> have <span class="fn">id</span>: {<span class="fn">all</span>(r.get(&<span <span class="kw">class</span>="cm">#x27;<span class="fn">id</span>&#x27;) <span class="kw">for</span> r <span class="kw">in</span> records)}<span <span class="kw">class</span>="st">&quot;)</span>

<span <span class="kw">class</span>="cm"># <span class="fn">sorted</span> <span class="kw">with</span> key</span>
<span class="kw">from</span> pathlib <span class="kw">import</span> Path
files = [Path(&quot;</span>a.csv<span <span class="kw">class</span>="st">&quot;), Path(&quot;</span>bb.json<span <span class="kw">class</span>="st">&quot;), Path(&quot;</span>ccc.txt<span <span class="kw">class</span>="st">&quot;)]
<span class="fn">print</span>(&quot;</span><span class="fn">sorted</span> by name length:<span <span class="kw">class</span>="st">&quot;, <span class="fn">sorted</span>(files, key=<span class="kw">lambda</span> f: <span class="fn">len</span>(f.name), reverse=<span class="kw">True</span>))

<span <span class="kw">class</span>="cm"># collections</span>
<span class="kw">from</span> collections <span class="kw">import</span> Counter, deque
<span class="fn">print</span>(&quot;</span>\nCounter:<span <span class="kw">class</span>="st">&quot;, Counter(&quot;</span>banana<span <span class="kw">class</span>="st">&quot;).most_common(<span <span class="kw">class</span>="num">2</span>))

<span <span class="kw">class</span>="cm"># itertools</span>
<span class="kw">from</span> itertools <span class="kw">import</span> chain, islice
<span class="fn">print</span>(&quot;</span>chain:<span <span class="kw">class</span>="st">&quot;, <span class="fn">list</span>(chain([<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>], [<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>], [<span <span class="kw">class</span>="num">5</span>])))

<span <span class="kw">class</span>="cm"># First <span <span class="kw">class</span>="num">5</span> <span class="kw">from</span> a generator</span>
gen = (x**<span <span class="kw">class</span>="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="fn">range</span>(<span <span class="kw">class</span>="num">1000</span>))
<span class="fn">print</span>(&quot;</span>islice:&quot;, <span class="fn">list</span>(islice(gen, <span <span class="kw">class</span>="num">5</span>)))</code></pre>
  </div>
</div>

<div class="card wide" data-tags="one-liners & tricks">
  <div class="card-head">
    <div class="card-icon" style="background:var(--amber-dim);color:var(--amber)">On</div>
    <h3>One-Liners &amp; Tricks</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Flatten nested <span class="fn">list</span></span>
nested = [[<span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">2</span>], [<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">4</span>], [<span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">6</span>, <span <span class="kw">class</span>="num">7</span>]]
flat = [x <span class="kw">for</span> sub <span class="kw">in</span> nested <span class="kw">for</span> x <span class="kw">in</span> sub]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;flatten:&quot;</span>, flat)

<span <span class="kw">class</span>="cm"># Remove duplicates, preserve order</span>
lst = [<span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">4</span>, <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">9</span>, <span <span class="kw">class</span>="num">2</span>, <span <span class="kw">class</span>="num">6</span>, <span <span class="kw">class</span>="num">5</span>, <span <span class="kw">class</span>="num">3</span>]
seen = <span class="fn">set</span>()
uniq = [x <span class="kw">for</span> x <span class="kw">in</span> lst <span class="kw">if</span> x <span class="kw">not</span> <span class="kw">in</span> seen <span class="kw">and</span> <span class="kw">not</span> seen.add(x)]
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;deduplicated:&quot;</span>, uniq)

<span <span class="kw">class</span>="cm"># Merge dicts (<span <span class="kw">class</span>="num">3.9</span>+)</span>
d1 = {<span <span class="kw">class</span>="st">&quot;a&quot;</span>: <span <span class="kw">class</span>="num">1</span>, <span <span class="kw">class</span>="st">&quot;b&quot;</span>: <span <span class="kw">class</span>="num">2</span>}
d2 = {<span <span class="kw">class</span>="st">&quot;b&quot;</span>: <span <span class="kw">class</span>="num">3</span>, <span <span class="kw">class</span>="st">&quot;c&quot;</span>: <span <span class="kw">class</span>="num">4</span>}
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;merged:&quot;</span>, d1 | d2)

<span <span class="kw">class</span>="cm"># Safe nested <span class="fn">dict</span> access</span>
d = {<span <span class="kw">class</span>="st">&quot;a&quot;</span>: {<span <span class="kw">class</span>="st">&quot;b&quot;</span>: {<span <span class="kw">class</span>="st">&quot;c&quot;</span>: <span <span class="kw">class</span>="num">42</span>}}}
val = d.get(<span <span class="kw">class</span>="st">&quot;a&quot;</span>, {}).get(<span <span class="kw">class</span>="st">&quot;b&quot;</span>, {}).get(<span <span class="kw">class</span>="st">&quot;c&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;nested access:&quot;</span>, val)

<span <span class="kw">class</span>="cm"># Timing code</span>
<span class="kw">from</span> time <span class="kw">import</span> perf_counter
t0 = perf_counter()
total = <span class="fn">sum</span>(<span class="fn">range</span>(<span <span class="kw">class</span>="num">1_000_000</span>))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;<span class="fn">sum</span>={total}, time={perf_counter()-t0:.4f}s&quot;</span>)

<span <span class="kw">class</span>="cm"># Regex — extract dates</span>
<span class="kw">import</span> re
log_text = <span <span class="kw">class</span>="st">&quot;Error at <span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">01</span>-<span <span class="kw">class</span>="num">15</span> <span class="kw">and</span> warning at <span <span class="kw">class</span>="num">2024</span>-<span <span class="kw">class</span>="num">06</span>-<span <span class="kw">class</span>="num">30</span> <span <span class="kw">class</span>="num">12</span>:<span <span class="kw">class</span>="num">00</span>:<span <span class="kw">class</span>="num">00</span>&quot;</span>
dates = re.findall(r&<span <span class="kw">class</span>="cm">#x27;\d{<span <span class="kw">class</span>="num">4</span>}-\d{<span <span class="kw">class</span>="num">2</span>}-\d{<span <span class="kw">class</span>="num">2</span>}&#x27;, log_text)</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;dates:&quot;</span>, dates)

emails_text = <span <span class="kw">class</span>="st">&quot;Contact alice<span class="dc">@example</span>.com <span class="kw">or</span> bob<span class="dc">@test</span>.org&quot;</span>
emails = re.findall(r&<span <span class="kw">class</span>="cm">#x27;\S+@\S+&#x27;, emails_text)</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">&quot;emails:&quot;</span>, emails)

<span <span class="kw">class</span>="cm"># hashlib — checksums <span class="kw">for</span> data integrity</span>
<span class="kw">import</span> hashlib
data = b<span <span class="kw">class</span>="st">&quot;Hello, data pipeline!&quot;</span>
checksum = hashlib.md5(data).hexdigest()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;MD5 checksum: {checksum}&quot;</span>)
sha = hashlib.sha256(data).hexdigest()
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;SHA256: {sha}&quot;</span>)</code></pre>
  </div>
</div>


<div class="section-divider" id="dunder-methods" data-section="dunder-methods">
  <h2>Dunder (Magic) Methods</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--purple-dim);color:var(--purple)">OOP</span>
</div>

<div class="card wide" data-tags="dunder magic methods __init__ __repr__ __len__">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">Du</div>
    <h3>Dunder Methods — Core Protocol</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Dunders = <span <span class="kw">class</span>="st">&quot;double underscore&quot;</span> methods Python calls implicitly</span>
<span <span class="kw">class</span>="cm"># They let your classes integrate <span class="kw">with</span> built-<span class="kw">in</span> operations</span>

<span class="kw">class</span> DataBatch:
    <span class="kw">def</span> __init__(self, name, records):
        self.name = name
        self.records = <span class="fn">list</span>(records)

    <span class="kw">def</span> __repr__(self):       <span <span class="kw">class</span>="cm"># <span class="fn">repr</span>() <span class="kw">and</span> REPL</span>
        <span class="kw">return</span> <span <span class="kw">class</span>="st">f&quot;DataBatch(name={self.name!r}, size={<span class="fn">len</span>(self.records)})&quot;</span>

    <span class="kw">def</span> __str__(self):        <span <span class="kw">class</span>="cm"># <span class="fn">str</span>() <span class="kw">and</span> <span class="fn">print</span>()</span>
        <span class="kw">return</span> f&quot;Batch &<span <span class="kw">class</span>="cm">#x27;{self.name}&#x27; ({<span class="fn">len</span>(self.records)} records)&quot;</span>

    <span class="kw">def</span> __len__(self):        <span <span class="kw">class</span>="cm"># <span class="fn">len</span>()</span>
        <span class="kw">return</span> <span class="fn">len</span>(self.records)

    <span class="kw">def</span> __getitem__(self, index):  <span <span class="kw">class</span>="cm"># batch[i], enables iteration</span>
        <span class="kw">return</span> self.records[index]

    <span class="kw">def</span> __contains__(self, item):  <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&#x27;<span class="kw">in</span>&#x27;</span> operator</span>
        <span class="kw">return</span> item <span class="kw">in</span> self.records

    <span class="kw">def</span> __iter__(self):       <span <span class="kw">class</span>="cm"># <span class="kw">for</span> loop, <span class="fn">list</span>()</span>
        <span class="kw">return</span> <span class="fn">iter</span>(self.records)

    <span class="kw">def</span> __eq__(self, other):  <span <span class="kw">class</span>="cm"># ==</span>
        <span class="kw">return</span> <span class="fn">isinstance</span>(other, DataBatch) <span class="kw">and</span> self.records == other.records

    <span class="kw">def</span> __lt__(self, other):  <span <span class="kw">class</span>="cm"># &lt; enables sorting</span>
        <span class="kw">return</span> <span class="fn">len</span>(self.records) &lt; <span class="fn">len</span>(other.records)

    <span class="kw">def</span> __add__(self, other): <span <span class="kw">class</span>="cm"># + combine batches</span>
        <span class="kw">return</span> DataBatch(<span <span class="kw">class</span>="st">f&quot;{self.name}+{other.name}&quot;</span>, self.records + other.records)

    <span class="kw">def</span> __enter__(self):      <span <span class="kw">class</span>="cm"># <span class="kw">with</span> statement entry</span>
        <span class="fn">print</span>(f&quot;  Opening batch &<span <span class="kw">class</span>="cm">#x27;{self.name}&#x27;<span <span class="kw">class</span>="st">&quot;)</span>
        <span class="kw">return</span> self

    <span class="kw">def</span> __exit__(self, exc_type, exc_val, exc_tb):  <span <span class="kw">class</span>="cm"># <span class="kw">with</span> exit</span>
        <span class="fn">print</span>(f&quot;</span>  Closing batch &<span <span class="kw">class</span>="cm">#x27;{self.name}&#x27;&quot;)</span>
        <span class="kw">return</span> <span class="kw">False</span>

    <span class="kw">def</span> __call__(self, fn):   <span <span class="kw">class</span>="cm"># batch(fn) — callable</span>
        <span class="kw">return</span> DataBatch(self.name, [fn(r) <span class="kw">for</span> r <span class="kw">in</span> self.records])

    <span class="kw">def</span> __bool__(self):       <span <span class="kw">class</span>="cm"># <span class="fn">bool</span>(), <span class="kw">if</span>, <span class="kw">while</span></span>
        <span class="kw">return</span> <span class="fn">len</span>(self.records) &gt; <span class="num">0</span>

<span <span class="kw">class</span>="cm"># Demo</span>
batch1 = DataBatch(<span <span class="kw">class</span>="st">&quot;users&quot;</span>, [{<span <span class="kw">class</span>="st">&quot;id&quot;</span>: <span class="num">1</span>}, {<span <span class="kw">class</span>="st">&quot;id&quot;</span>: <span class="num">2</span>}, {<span <span class="kw">class</span>="st">&quot;id&quot;</span>: <span class="num">3</span>}])
batch2 = DataBatch(<span <span class="kw">class</span>="st">&quot;orders&quot;</span>, [{<span <span class="kw">class</span>="st">&quot;oid&quot;</span>: <span class="num">10</span>}, {<span <span class="kw">class</span>="st">&quot;oid&quot;</span>: <span class="num">20</span>}])

<span class="fn">print</span>(<span class="fn">repr</span>(batch1))                    <span <span class="kw">class</span>="cm"># __repr__</span>
<span class="fn">print</span>(<span class="fn">str</span>(batch1))                     <span <span class="kw">class</span>="cm"># __str__</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;len: {<span class="fn">len</span>(batch1)}&quot;</span>)           <span <span class="kw">class</span>="cm"># __len__</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;batch1[<span class="num">0</span>]: {batch1[<span class="num">0</span>]}&quot;</span>)       <span <span class="kw">class</span>="cm"># __getitem__</span>

combined = batch1 + batch2             <span <span class="kw">class</span>="cm"># __add__</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;combined: {combined}&quot;</span>)

<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;sorted sizes: {[<span class="fn">len</span>(b) <span class="kw">for</span> b <span class="kw">in</span> <span class="fn">sorted</span>([combined, batch2, batch1])]}&quot;</span>)

<span class="kw">with</span> batch1 <span class="kw">as</span> b:                      <span <span class="kw">class</span>="cm"># __enter__ / __exit__</span>
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  working <span class="kw">with</span> {<span class="fn">len</span>(b)} records&quot;</span>)</code></pre>
  </div>
</div>

<div class="card" data-tags="dunder __slots__ __getattr__ __format__">
  <div class="card-head">
    <div class="card-icon" style="background:var(--purple-dim);color:var(--purple)">Du</div>
    <h3>Dunder Methods — Advanced</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># More dunders: attribute access, __slots__, __format__</span>

<span class="kw">class</span> SmartRecord:
    <span class="kw">def</span> __init__(self, data):
        self._data = data

    <span class="kw">def</span> __getattr__(self, name):     <span <span class="kw">class</span>="cm"># fallback attribute access</span>
        <span class="kw">return</span> self._data.get(name, f&quot;&lt;no {name}&gt;<span <span class="kw">class</span>="st">&quot;)

    <span class="kw">def</span> __setitem__(self, key, value):  <span <span class="kw">class</span>="cm"># r[&quot;</span>key<span <span class="kw">class</span>="st">&quot;] = val</span>
        self._data[key] = value

    <span class="kw">def</span> __delitem__(self, key):
        <span class="kw">del</span> self._data[key]

    <span class="kw">def</span> __format__(self, spec):       <span <span class="kw">class</span>="cm"># f-strings, format()</span>
        <span class="kw">if</span> spec == &quot;</span>short<span <span class="kw">class</span>="st">&quot;:
            <span class="kw">return</span> <span class="fn">str</span>(<span class="fn">list</span>(self._data.keys()))
        <span class="kw">return</span> <span class="fn">str</span>(self._data)

r = SmartRecord({&quot;</span>name<span <span class="kw">class</span>="st">&quot;: &quot;</span>Alice<span <span class="kw">class</span>="st">&quot;, &quot;</span>age<span <span class="kw">class</span>="st">&quot;: <span class="num">30</span>})
<span class="fn">print</span>(r.name)              <span <span class="kw">class</span>="cm"># __getattr__</span>
<span class="fn">print</span>(r.email)             <span <span class="kw">class</span>="cm"># __getattr__ fallback</span>
r[&quot;</span>city<span <span class="kw">class</span>="st">&quot;] = &quot;</span>NYC<span <span class="kw">class</span>="st">&quot;          <span <span class="kw">class</span>="cm"># __setitem__</span>
<span class="fn">print</span>(f&quot;</span>{r:short}<span <span class="kw">class</span>="st">&quot;)        <span <span class="kw">class</span>="cm"># __format__</span>

<span <span class="kw">class</span>="cm"># __slots__ — memory optimization (no __dict__)</span>
<span class="kw">class</span> OptimizedRecord:
    __slots__ = [&quot;</span>id<span <span class="kw">class</span>="st">&quot;, &quot;</span>value<span <span class="kw">class</span>="st">&quot;]
    <span class="kw">def</span> __init__(self, id, value):
        self.id = id
        self.value = value

rec = OptimizedRecord(<span class="num">1</span>, <span class="num">42</span>)
<span class="fn">print</span>(f&quot;</span>slots: id={rec.id}, value={rec.value}<span <span class="kw">class</span>="st">&quot;)
<span class="kw">try</span>:
    rec.extra = &quot;</span>nope<span <span class="kw">class</span>="st">&quot;
<span class="kw">except</span> AttributeError <span class="kw">as</span> e:
    <span class="fn">print</span>(f&quot;</span>__slots__ prevents: {e}&quot;)</code></pre>
  </div>
</div>


<div class="section-divider" id="interview-questions" data-section="interview-questions">
  <h2>Common Interview Questions</h2>
  <div class="line"></div>
  <span class="badge" style="background:var(--pink-dim);color:var(--pink)">Career</span>
</div>

<div class="card wide" data-tags="interview questions python">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">IQ</div>
    <h3>Interview Q1-Q6</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Q1: list vs tuple vs set</span>
<span <span class="kw">class</span>="cm"># List: ordered, mutable, duplicates OK</span>
<span <span class="kw">class</span>="cm"># Tuple: ordered, immutable, duplicates OK</span>
<span <span class="kw">class</span>="cm"># Set: unordered, mutable, NO duplicates</span>
lst = [<span class="num">1</span>, <span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>]
tup = (<span class="num">1</span>, <span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>)
st  = {<span class="num">1</span>, <span class="num">2</span>, <span class="num">2</span>, <span class="num">3</span>}  <span <span class="kw">class</span>="cm"># -&gt; {<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>}</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;list={lst}, tuple={tup}, set={st}&quot;</span>)

<span <span class="kw">class</span>="cm"># Q2: Deep copy vs shallow copy</span>
<span class="kw">import</span> copy
original = [[<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>]]
shallow = copy.copy(original)
deep = copy.deepcopy(original)
original[<span class="num">0</span>].append(<span class="num">99</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;original: {original}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;shallow (affected): {shallow}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;deep (<span class="kw">not</span> affected): {deep}&quot;</span>)

<span <span class="kw">class</span>="cm"># Q3: Generators — lazy, memory-efficient</span>
<span class="kw">def</span> read_chunks(data, size=<span class="num">3</span>):
    <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="num">0</span>, <span class="fn">len</span>(data), size):
        <span class="kw">yield</span> data[i:i+size]

<span class="kw">for</span> chunk <span class="kw">in</span> read_chunks(<span class="fn">list</span>(<span class="fn">range</span>(<span class="num">10</span>))):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  chunk: {chunk}&quot;</span>)

<span class="kw">import</span> sys
list_comp = [x**<span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="fn">range</span>(<span class="num">10000</span>)]
gen_exp   = (x**<span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> <span class="fn">range</span>(<span class="num">10000</span>))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;list: {sys.getsizeof(list_comp):,} bytes&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;gen:  {sys.getsizeof(gen_exp):,} bytes&quot;</span>)

<span <span class="kw">class</span>="cm"># Q4: *args vs **kwargs</span>
<span class="kw">def</span> example(*args, **kwargs):
    <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;positional: {args}, keyword: {kwargs}&quot;</span>)
example(<span class="num">1</span>, <span class="num">2</span>, x=<span class="num">10</span>)

<span <span class="kw">class</span>="cm"># Q5: GIL — only one thread runs Python bytecode at a time</span>
<span <span class="kw">class</span>="cm"># CPU-bound -&gt; multiprocessing | I/O-bound -&gt; threading/asyncio</span>

<span <span class="kw">class</span>="cm"># Q6: Mutable default argument trap</span>
<span class="kw">def</span> bad(item, lst=[]):
    lst.append(item)
    <span class="kw">return</span> lst
<span class="fn">print</span>(bad(<span class="num">1</span>))  <span <span class="kw">class</span>="cm"># [<span class="num">1</span>]</span>
<span class="fn">print</span>(bad(<span class="num">2</span>))  <span <span class="kw">class</span>="cm"># [<span class="num">1</span>, <span class="num">2</span>] — BUG!</span>

<span class="kw">def</span> good(item, lst=<span class="kw">None</span>):
    lst = lst <span class="kw">or</span> []
    lst.append(item)
    <span class="kw">return</span> lst
<span class="fn">print</span>(good(<span class="num">1</span>))  <span <span class="kw">class</span>="cm"># [<span class="num">1</span>]</span>
<span class="fn">print</span>(good(<span class="num">2</span>))  <span <span class="kw">class</span>="cm"># [<span class="num">2</span>] — correct</span></code></pre>
  </div>
</div>

<div class="card wide" data-tags="interview questions decorators mro">
  <div class="card-head">
    <div class="card-icon" style="background:var(--pink-dim);color:var(--pink)">IQ</div>
    <h3>Interview Q7-Q12</h3>
    <span class="card-tag">Jupyter ✅</span>
  </div>
  <div class="card-body">
    <pre><code><span <span class="kw">class</span>="cm"># Q7: <span class="kw">if</span> __name__ == <span <span class="kw">class</span>="st">&quot;__main__&quot;</span></span>
<span <span class="kw">class</span>="cm"># Runs code only when file executed directly, <span class="kw">not</span> imported</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;__name__ = {__name__}&quot;</span>)

<span <span class="kw">class</span>="cm"># Q8: Handling large datasets</span>
<span <span class="kw">class</span>="cm"># <span class="num">1</span>. Generators — process row by row</span>
<span <span class="kw">class</span>="cm"># <span class="num">2</span>. pd.read_csv(..., chunksize=<span class="num">10000</span>)</span>
<span <span class="kw">class</span>="cm"># <span class="num">3</span>. Columnar formats: Parquet, ORC</span>
<span <span class="kw">class</span>="cm"># <span class="num">4</span>. Dask / PySpark <span class="kw">for</span> distributed</span>
<span <span class="kw">class</span>="cm"># <span class="num">5</span>. Optimize dtypes: category, int32 vs int64</span>
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np
df = pd.DataFrame({<span <span class="kw">class</span>="st">&quot;status&quot;</span>: np.random.choice([<span <span class="kw">class</span>="st">&quot;A&quot;</span>,<span <span class="kw">class</span>="st">&quot;B&quot;</span>,<span <span class="kw">class</span>="st">&quot;C&quot;</span>], <span class="num">10000</span>)})
<span class="fn">print</span>(f&quot;object: {df[&<span <span class="kw">class</span>="cm">#x27;status&#x27;].memory_usage(deep=<span class="kw">True</span>):,} bytes<span <span class="kw">class</span>="st">&quot;)</span>
df[&quot;</span>status<span <span class="kw">class</span>="st">&quot;] = df[&quot;</span>status<span <span class="kw">class</span>="st">&quot;].astype(&quot;</span>category<span <span class="kw">class</span>="st">&quot;)
<span class="fn">print</span>(f&quot;</span>category: {df[&<span <span class="kw">class</span>="cm">#x27;status&#x27;].memory_usage(deep=<span class="kw">True</span>):,} bytes&quot;)</span>

<span <span class="kw">class</span>="cm"># Q9: == vs <span <span class="kw">class</span>="st">&#x27;<span class="kw">is</span>&#x27;</span></span>
a = [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>]
b = [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>]
c = a
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;a == b: {a == b}&quot;</span>)  <span <span class="kw">class</span>="cm"># <span class="kw">True</span> (same value)</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;a <span class="kw">is</span> b: {a <span class="kw">is</span> b}&quot;</span>)  <span <span class="kw">class</span>="cm"># <span class="kw">False</span> (different objects)</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;a <span class="kw">is</span> c: {a <span class="kw">is</span> c}&quot;</span>)  <span <span class="kw">class</span>="cm"># <span class="kw">True</span> (same object)</span>
<span <span class="kw">class</span>="cm"># Use <span <span class="kw">class</span>="st">&#x27;<span class="kw">is</span>&#x27;</span> only <span class="kw">for</span> <span class="kw">None</span>, <span class="kw">True</span>, <span class="kw">False</span></span>

<span <span class="kw">class</span>="cm"># Q10: Decorators wrap functions to add behavior</span>
<span class="kw">from</span> functools <span class="kw">import</span> wraps
<span class="kw">def</span> log_calls(func):
    @wraps(func)
    <span class="kw">def</span> wrapper(*args, **kwargs):
        <span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;  Calling {func.__name__}&quot;</span>)
        <span class="kw">return</span> func(*args, **kwargs)
    <span class="kw">return</span> wrapper

@log_calls
<span class="kw">def</span> multiply(a, b):
    <span class="kw">return</span> a * b
<span class="fn">print</span>(multiply(<span class="num">3</span>, <span class="num">4</span>))

<span <span class="kw">class</span>="cm"># Q11: List comprehension vs map/filter</span>
nums = [<span class="num">1</span>, <span class="num">2</span>, <span class="num">3</span>, <span class="num">4</span>, <span class="num">5</span>]
comp = [x**<span class="num">2</span> <span class="kw">for</span> x <span class="kw">in</span> nums <span class="kw">if</span> x &gt; <span class="num">2</span>]         <span <span class="kw">class</span>="cm"># Pythonic</span>
mapped = <span class="fn">list</span>(<span class="fn">map</span>(<span class="kw">lambda</span> x: x**<span class="num">2</span>, <span class="fn">filter</span>(<span class="kw">lambda</span> x: x &gt; <span class="num">2</span>, nums)))
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;comp: {comp}, map: {mapped}&quot;</span>)

<span <span class="kw">class</span>="cm"># Q12: Method Resolution Order (MRO)</span>
<span class="kw">class</span> A:
    <span class="kw">def</span> who(self): <span class="kw">return</span> <span <span class="kw">class</span>="st">&quot;A&quot;</span>
<span class="kw">class</span> B(A):
    <span class="kw">def</span> who(self): <span class="kw">return</span> <span <span class="kw">class</span>="st">&quot;B&quot;</span>
<span class="kw">class</span> C(A):
    <span class="kw">def</span> who(self): <span class="kw">return</span> <span <span class="kw">class</span>="st">&quot;C&quot;</span>
<span class="kw">class</span> D(B, C):
    <span class="kw">pass</span>
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;MRO: {[c.__name__ <span class="kw">for</span> c <span class="kw">in</span> D.__mro__]}&quot;</span>)
<span class="fn">print</span>(<span <span class="kw">class</span>="st">f&quot;D().who() = {D().who()}&quot;</span>)  <span <span class="kw">class</span>="cm"># <span <span class="kw">class</span>="st">&quot;B&quot;</span> via D-&gt;B-&gt;C-&gt;A</span></code></pre>
  </div>
</div>

<div class="section-divider" id="quick-reference-table" data-section="quick-reference-table">
  <h2>Quick Reference Table</h2>
  <div class="line"></div>
  
</div>
</div>
<script>
const input=document.getElementById('search'),cards=document.querySelectorAll('.card'),dividers=document.querySelectorAll('.section-divider');
input.addEventListener('input',()=>{const q=input.value.toLowerCase().trim();cards.forEach(c=>{const t=(c.dataset.tags||'').toLowerCase(),x=c.textContent.toLowerCase();c.classList.toggle('hidden',q&&!t.includes(q)&&!x.includes(q))});dividers.forEach(d=>{let n=d.nextElementSibling,v=false;while(n&&!n.classList.contains('section-divider')){if(n.classList.contains('card')&&!n.classList.contains('hidden'))v=true;n=n.nextElementSibling}d.classList.toggle('hidden',!v)});});
const secs=document.querySelectorAll('.section-divider[id]'),navs=document.querySelectorAll('.nav a');
secs.forEach(s=>new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting){navs.forEach(a=>a.classList.remove('active'));const l=document.querySelector('.nav a[href="#'+e.target.id+'"]');if(l)l.classList.add('active')}})},{rootMargin:'-100px 0px -70% 0px'}).observe(s));
</script>
</body></html>